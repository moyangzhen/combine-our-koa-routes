{"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/index.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nvar _koa = _interopRequireDefault(require(\"koa\"));\nvar _koaJwt = _interopRequireDefault(require(\"koa-jwt\"));\nvar _path = _interopRequireDefault(require(\"path\"));\nvar _koaBody = _interopRequireDefault(require(\"koa-body\"));\nvar _koaJson = _interopRequireDefault(require(\"koa-json\"));\nvar _koaCompose = _interopRequireDefault(require(\"koa-compose\"));\nvar _koa2Cors = _interopRequireDefault(require(\"koa2-cors\"));\nvar _routes = _interopRequireDefault(require(\"./routes/routes\"));\nvar _koaHelmet = _interopRequireDefault(require(\"koa-helmet\"));\nvar _koaStatic = _interopRequireDefault(require(\"koa-static\"));\nvar _koaCompress = _interopRequireDefault(require(\"koa-compress\"));\nvar _index = _interopRequireDefault(require(\"./config/index\"));\nvar _ErrorHandle = _interopRequireDefault(require(\"./common/ErrorHandle\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst app = new _koa.default();\nconst isDevMode = process.env.NODE_ENV == \"production\" ? false : true;\n// 定义公共路径，不需要jwt鉴权\nconst jwt = (0, _koaJwt.default)({\n  secret: _index.default.JWT_SECRET\n}).unless({\n  path: [/^\\/public/, /\\/login/]\n});\nconst middleware = (0, _koaCompose.default)([(0, _koaBody.default)({\n  multipart: true\n}), (0, _koaStatic.default)(_path.default.join(__dirname, \"../public\")), (0, _koa2Cors.default)(), (0, _koaJson.default)({\n  pretty: false,\n  param: \"pretty\"\n}), (0, _koaHelmet.default)(), _ErrorHandle.default, jwt]);\nif (!isDevMode) {\n  app.use((0, _koaCompress.default)());\n}\napp.use(middleware);\napp.use((0, _routes.default)());\napp.listen(3000);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJhcHAiLCJrb2EiLCJpc0Rldk1vZGUiLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJqd3QiLCJKV1QiLCJzZWNyZXQiLCJjb25maWciLCJKV1RfU0VDUkVUIiwidW5sZXNzIiwicGF0aCIsIm1pZGRsZXdhcmUiLCJjb21wb3NlIiwia29hQm9keSIsIm11bHRpcGFydCIsInN0YXRpY3MiLCJqb2luIiwiX19kaXJuYW1lIiwiY29ycyIsImpzb251dGlsIiwicHJldHR5IiwicGFyYW0iLCJoZWxtZXQiLCJlcnJvckhhbmRsZSIsInVzZSIsImNvbXByZXNzIiwicm91dGVyIiwibGlzdGVuIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvbHVja3kvRGVza3RvcC9mcm9udC9kYXFpYW5kdWFuL2FwaS9zcmMvIiwic291cmNlcyI6WyJpbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQga29hIGZyb20gXCJrb2FcIjtcbmltcG9ydCBKV1QgZnJvbSBcImtvYS1qd3RcIjtcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5pbXBvcnQga29hQm9keSBmcm9tIFwia29hLWJvZHlcIjtcbmltcG9ydCBqc29udXRpbCBmcm9tIFwia29hLWpzb25cIjtcbmltcG9ydCBjb21wb3NlIGZyb20gXCJrb2EtY29tcG9zZVwiO1xuaW1wb3J0IGNvcnMgZnJvbSBcImtvYTItY29yc1wiO1xuaW1wb3J0IHJvdXRlciBmcm9tIFwiLi9yb3V0ZXMvcm91dGVzXCI7XG5pbXBvcnQgaGVsbWV0IGZyb20gXCJrb2EtaGVsbWV0XCI7XG5pbXBvcnQgc3RhdGljcyBmcm9tIFwia29hLXN0YXRpY1wiO1xuaW1wb3J0IGNvbXByZXNzIGZyb20gXCJrb2EtY29tcHJlc3NcIjtcbmltcG9ydCBjb25maWcgZnJvbSBcIi4vY29uZmlnL2luZGV4XCI7XG5pbXBvcnQgZXJyb3JIYW5kbGUgZnJvbSBcIi4vY29tbW9uL0Vycm9ySGFuZGxlXCI7XG5jb25zdCBhcHAgPSBuZXcga29hKCk7XG5jb25zdCBpc0Rldk1vZGUgPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PSBcInByb2R1Y3Rpb25cIiA/IGZhbHNlIDogdHJ1ZTtcbi8vIOWumuS5ieWFrOWFsei3r+W+hO+8jOS4jemcgOimgWp3dOmJtOadg1xuY29uc3Qgand0ID0gSldUKHsgc2VjcmV0OiBjb25maWcuSldUX1NFQ1JFVCB9KS51bmxlc3Moe1xuICBwYXRoOiBbL15cXC9wdWJsaWMvLCAvXFwvbG9naW4vXSxcbn0pO1xuY29uc3QgbWlkZGxld2FyZSA9IGNvbXBvc2UoW1xuICBrb2FCb2R5KHtcbiAgICBtdWx0aXBhcnQ6IHRydWUsXG4gIH0pLFxuICBzdGF0aWNzKHBhdGguam9pbihfX2Rpcm5hbWUsIFwiLi4vcHVibGljXCIpKSxcbiAgY29ycygpLFxuICBqc29udXRpbCh7IHByZXR0eTogZmFsc2UsIHBhcmFtOiBcInByZXR0eVwiIH0pLFxuICBoZWxtZXQoKSxcbiAgZXJyb3JIYW5kbGUsXG4gIGp3dCxcbl0pO1xuaWYgKCFpc0Rldk1vZGUpIHtcbiAgYXBwLnVzZShjb21wcmVzcygpKTtcbn1cbmFwcC51c2UobWlkZGxld2FyZSk7XG5hcHAudXNlKHJvdXRlcigpKTtcbmFwcC5saXN0ZW4oMzAwMCk7XG4iXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBK0M7QUFDL0MsTUFBTUEsR0FBRyxHQUFHLElBQUlDLFlBQUcsRUFBRTtBQUNyQixNQUFNQyxTQUFTLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxRQUFRLElBQUksWUFBWSxHQUFHLEtBQUssR0FBRyxJQUFJO0FBQ3JFO0FBQ0EsTUFBTUMsR0FBRyxHQUFHLElBQUFDLGVBQUcsRUFBQztFQUFFQyxNQUFNLEVBQUVDLGNBQU0sQ0FBQ0M7QUFBVyxDQUFDLENBQUMsQ0FBQ0MsTUFBTSxDQUFDO0VBQ3BEQyxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUUsU0FBUztBQUMvQixDQUFDLENBQUM7QUFDRixNQUFNQyxVQUFVLEdBQUcsSUFBQUMsbUJBQU8sRUFBQyxDQUN6QixJQUFBQyxnQkFBTyxFQUFDO0VBQ05DLFNBQVMsRUFBRTtBQUNiLENBQUMsQ0FBQyxFQUNGLElBQUFDLGtCQUFPLEVBQUNMLGFBQUksQ0FBQ00sSUFBSSxDQUFDQyxTQUFTLEVBQUUsV0FBVyxDQUFDLENBQUMsRUFDMUMsSUFBQUMsaUJBQUksR0FBRSxFQUNOLElBQUFDLGdCQUFRLEVBQUM7RUFBRUMsTUFBTSxFQUFFLEtBQUs7RUFBRUMsS0FBSyxFQUFFO0FBQVMsQ0FBQyxDQUFDLEVBQzVDLElBQUFDLGtCQUFNLEdBQUUsRUFDUkMsb0JBQVcsRUFDWG5CLEdBQUcsQ0FDSixDQUFDO0FBQ0YsSUFBSSxDQUFDSixTQUFTLEVBQUU7RUFDZEYsR0FBRyxDQUFDMEIsR0FBRyxDQUFDLElBQUFDLG9CQUFRLEdBQUUsQ0FBQztBQUNyQjtBQUNBM0IsR0FBRyxDQUFDMEIsR0FBRyxDQUFDYixVQUFVLENBQUM7QUFDbkJiLEdBQUcsQ0FBQzBCLEdBQUcsQ0FBQyxJQUFBRSxlQUFNLEdBQUUsQ0FBQztBQUNqQjVCLEdBQUcsQ0FBQzZCLE1BQU0sQ0FBQyxJQUFJLENBQUMifQ==","map":{"version":3,"names":["app","koa","isDevMode","process","env","NODE_ENV","jwt","JWT","secret","config","JWT_SECRET","unless","path","middleware","compose","koaBody","multipart","statics","join","__dirname","cors","jsonutil","pretty","param","helmet","errorHandle","use","compress","router","listen"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/","sources":["index.js"],"sourcesContent":["import koa from \"koa\";\nimport JWT from \"koa-jwt\";\nimport path from \"path\";\nimport koaBody from \"koa-body\";\nimport jsonutil from \"koa-json\";\nimport compose from \"koa-compose\";\nimport cors from \"koa2-cors\";\nimport router from \"./routes/routes\";\nimport helmet from \"koa-helmet\";\nimport statics from \"koa-static\";\nimport compress from \"koa-compress\";\nimport config from \"./config/index\";\nimport errorHandle from \"./common/ErrorHandle\";\nconst app = new koa();\nconst isDevMode = process.env.NODE_ENV == \"production\" ? false : true;\n// 定义公共路径，不需要jwt鉴权\nconst jwt = JWT({ secret: config.JWT_SECRET }).unless({\n  path: [/^\\/public/, /\\/login/],\n});\nconst middleware = compose([\n  koaBody({\n    multipart: true,\n  }),\n  statics(path.join(__dirname, \"../public\")),\n  cors(),\n  jsonutil({ pretty: false, param: \"pretty\" }),\n  helmet(),\n  errorHandle,\n  jwt,\n]);\nif (!isDevMode) {\n  app.use(compress());\n}\napp.use(middleware);\napp.use(router());\napp.listen(3000);\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAA+C;AAC/C,MAAMA,GAAG,GAAG,IAAIC,YAAG,EAAE;AACrB,MAAMC,SAAS,GAAGC,OAAO,CAACC,GAAG,CAACC,QAAQ,IAAI,YAAY,GAAG,KAAK,GAAG,IAAI;AACrE;AACA,MAAMC,GAAG,GAAG,IAAAC,eAAG,EAAC;EAAEC,MAAM,EAAEC,cAAM,CAACC;AAAW,CAAC,CAAC,CAACC,MAAM,CAAC;EACpDC,IAAI,EAAE,CAAC,WAAW,EAAE,SAAS;AAC/B,CAAC,CAAC;AACF,MAAMC,UAAU,GAAG,IAAAC,mBAAO,EAAC,CACzB,IAAAC,gBAAO,EAAC;EACNC,SAAS,EAAE;AACb,CAAC,CAAC,EACF,IAAAC,kBAAO,EAACL,aAAI,CAACM,IAAI,CAACC,SAAS,EAAE,WAAW,CAAC,CAAC,EAC1C,IAAAC,iBAAI,GAAE,EACN,IAAAC,gBAAQ,EAAC;EAAEC,MAAM,EAAE,KAAK;EAAEC,KAAK,EAAE;AAAS,CAAC,CAAC,EAC5C,IAAAC,kBAAM,GAAE,EACRC,oBAAW,EACXnB,GAAG,CACJ,CAAC;AACF,IAAI,CAACJ,SAAS,EAAE;EACdF,GAAG,CAAC0B,GAAG,CAAC,IAAAC,oBAAQ,GAAE,CAAC;AACrB;AACA3B,GAAG,CAAC0B,GAAG,CAACb,UAAU,CAAC;AACnBb,GAAG,CAAC0B,GAAG,CAAC,IAAAE,eAAM,GAAE,CAAC;AACjB5B,GAAG,CAAC6B,MAAM,CAAC,IAAI,CAAC"}},"mtime":1669981969068},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/routes/routes.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _koaCombineRouters = _interopRequireDefault(require(\"koa-combine-routers\"));\nvar _publicRouter = _interopRequireDefault(require(\"./publicRouter\"));\nvar _LoginRouter = _interopRequireDefault(require(\"./LoginRouter\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nvar _default = (0, _koaCombineRouters.default)(_publicRouter.default, _LoginRouter.default);\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb21iaW5lUm91dGVzIiwicHVibGljUm91dGVyIiwibG9naW5Sb3V0ZXIiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9sdWNreS9EZXNrdG9wL2Zyb250L2RhcWlhbmR1YW4vYXBpL3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJyb3V0ZXMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNvbWJpbmVSb3V0ZXMgZnJvbSBcImtvYS1jb21iaW5lLXJvdXRlcnNcIjtcbmltcG9ydCBwdWJsaWNSb3V0ZXIgZnJvbSBcIi4vcHVibGljUm91dGVyXCI7XG5pbXBvcnQgbG9naW5Sb3V0ZXIgZnJvbSBcIi4vTG9naW5Sb3V0ZXJcIjtcbmV4cG9ydCBkZWZhdWx0IGNvbWJpbmVSb3V0ZXMocHVibGljUm91dGVyLCBsb2dpblJvdXRlcik7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUF3QztBQUFBLGVBQ3pCLElBQUFBLDBCQUFhLEVBQUNDLHFCQUFZLEVBQUVDLG9CQUFXLENBQUM7QUFBQSJ9","map":{"version":3,"names":["combineRoutes","publicRouter","loginRouter"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/routes/","sources":["routes.js"],"sourcesContent":["import combineRoutes from \"koa-combine-routers\";\nimport publicRouter from \"./publicRouter\";\nimport loginRouter from \"./LoginRouter\";\nexport default combineRoutes(publicRouter, loginRouter);\n"],"mappings":";;;;;;AAAA;AACA;AACA;AAAwC;AAAA,eACzB,IAAAA,0BAAa,EAACC,qBAAY,EAAEC,oBAAW,CAAC;AAAA"}},"mtime":1668423460524},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/routes/publicRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _koaRouter = _interopRequireDefault(require(\"koa-router\"));\nvar _PublicController = _interopRequireDefault(require(\"../api/PublicController\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst router = new _koaRouter.default();\nrouter.prefix(\"/public\");\nrouter.get(\"/getCaptcha\", _PublicController.default.getCaptcha);\nvar _default = router;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyb3V0ZXIiLCJSb3V0ZXIiLCJwcmVmaXgiLCJnZXQiLCJwdWJsaWNDb250cm9sbGVyIiwiZ2V0Q2FwdGNoYSJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2x1Y2t5L0Rlc2t0b3AvZnJvbnQvZGFxaWFuZHVhbi9hcGkvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbInB1YmxpY1JvdXRlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUm91dGVyIGZyb20gXCJrb2Etcm91dGVyXCI7XG5pbXBvcnQgcHVibGljQ29udHJvbGxlciBmcm9tIFwiLi4vYXBpL1B1YmxpY0NvbnRyb2xsZXJcIjtcbmNvbnN0IHJvdXRlciA9IG5ldyBSb3V0ZXIoKTtcbnJvdXRlci5wcmVmaXgoXCIvcHVibGljXCIpO1xucm91dGVyLmdldChcIi9nZXRDYXB0Y2hhXCIsIHB1YmxpY0NvbnRyb2xsZXIuZ2V0Q2FwdGNoYSk7XG5leHBvcnQgZGVmYXVsdCByb3V0ZXI7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFBdUQ7QUFDdkQsTUFBTUEsTUFBTSxHQUFHLElBQUlDLGtCQUFNLEVBQUU7QUFDM0JELE1BQU0sQ0FBQ0UsTUFBTSxDQUFDLFNBQVMsQ0FBQztBQUN4QkYsTUFBTSxDQUFDRyxHQUFHLENBQUMsYUFBYSxFQUFFQyx5QkFBZ0IsQ0FBQ0MsVUFBVSxDQUFDO0FBQUMsZUFDeENMLE1BQU07QUFBQSJ9","map":{"version":3,"names":["router","Router","prefix","get","publicController","getCaptcha"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/routes/","sources":["publicRouter.js"],"sourcesContent":["import Router from \"koa-router\";\nimport publicController from \"../api/PublicController\";\nconst router = new Router();\nrouter.prefix(\"/public\");\nrouter.get(\"/getCaptcha\", publicController.getCaptcha);\nexport default router;\n"],"mappings":";;;;;;AAAA;AACA;AAAuD;AACvD,MAAMA,MAAM,GAAG,IAAIC,kBAAM,EAAE;AAC3BD,MAAM,CAACE,MAAM,CAAC,SAAS,CAAC;AACxBF,MAAM,CAACG,GAAG,CAAC,aAAa,EAAEC,yBAAgB,CAACC,UAAU,CAAC;AAAC,eACxCL,MAAM;AAAA"}},"mtime":1669787125390},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/api/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/api/PublicController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _svgCaptcha = _interopRequireDefault(require(\"svg-captcha\"));\nvar _RedisConfig = require(\"../config/RedisConfig\");\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nclass PublicController {\n  constructor() {}\n  async getCaptcha(ctx) {\n    const body = ctx.request.query;\n    const newCaptcha = _svgCaptcha.default.create({\n      size: 4,\n      ignoreChars: \"0o1i\",\n      color: true,\n      noise: Math.floor(Math.random() * 5),\n      height: 38,\n      width: 150\n    });\n    // 保存图片验证码数据，设置超时时间单位是秒\n    //设置图片验证码超时十分钟\n    (0, _RedisConfig.setValue)(body.sid, newCaptcha.text, 10 * 60);\n    ctx.body = {\n      code: 200,\n      data: newCaptcha.data\n    };\n  }\n}\nvar _default = new PublicController();\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQdWJsaWNDb250cm9sbGVyIiwiY29uc3RydWN0b3IiLCJnZXRDYXB0Y2hhIiwiY3R4IiwiYm9keSIsInJlcXVlc3QiLCJxdWVyeSIsIm5ld0NhcHRjaGEiLCJzdmdDYXB0Y2hhIiwiY3JlYXRlIiwic2l6ZSIsImlnbm9yZUNoYXJzIiwiY29sb3IiLCJub2lzZSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImhlaWdodCIsIndpZHRoIiwic2V0VmFsdWUiLCJzaWQiLCJ0ZXh0IiwiY29kZSIsImRhdGEiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9sdWNreS9EZXNrdG9wL2Zyb250L2RhcWlhbmR1YW4vYXBpL3NyYy9hcGkvIiwic291cmNlcyI6WyJQdWJsaWNDb250cm9sbGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBzdmdDYXB0Y2hhIGZyb20gXCJzdmctY2FwdGNoYVwiO1xuaW1wb3J0IHsgZ2V0VmFsdWUsIHNldFZhbHVlIH0gZnJvbSBcIi4uL2NvbmZpZy9SZWRpc0NvbmZpZ1wiO1xuY2xhc3MgUHVibGljQ29udHJvbGxlciB7XG4gIGNvbnN0cnVjdG9yKCkge31cbiAgYXN5bmMgZ2V0Q2FwdGNoYShjdHgpIHtcbiAgICBjb25zdCBib2R5ID0gY3R4LnJlcXVlc3QucXVlcnk7XG4gICAgY29uc3QgbmV3Q2FwdGNoYSA9IHN2Z0NhcHRjaGEuY3JlYXRlKHtcbiAgICAgIHNpemU6IDQsXG4gICAgICBpZ25vcmVDaGFyczogXCIwbzFpXCIsXG4gICAgICBjb2xvcjogdHJ1ZSxcbiAgICAgIG5vaXNlOiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA1KSxcbiAgICAgIGhlaWdodDogMzgsXG4gICAgICB3aWR0aDogMTUwLFxuICAgIH0pO1xuICAgIC8vIOS/neWtmOWbvueJh+mqjOivgeeggeaVsOaNru+8jOiuvue9rui2heaXtuaXtumXtOWNleS9jeaYr+enklxuICAgIC8v6K6+572u5Zu+54mH6aqM6K+B56CB6LaF5pe25Y2B5YiG6ZKfXG4gICAgc2V0VmFsdWUoYm9keS5zaWQsIG5ld0NhcHRjaGEudGV4dCwgMTAgKiA2MCk7XG5cbiAgICBjdHguYm9keSA9IHtcbiAgICAgIGNvZGU6IDIwMCxcbiAgICAgIGRhdGE6IG5ld0NhcHRjaGEuZGF0YSxcbiAgICB9O1xuICB9XG59XG5leHBvcnQgZGVmYXVsdCBuZXcgUHVibGljQ29udHJvbGxlcigpO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBO0FBQTJEO0FBQzNELE1BQU1BLGdCQUFnQixDQUFDO0VBQ3JCQyxXQUFXLEdBQUcsQ0FBQztFQUNmLE1BQU1DLFVBQVUsQ0FBQ0MsR0FBRyxFQUFFO0lBQ3BCLE1BQU1DLElBQUksR0FBR0QsR0FBRyxDQUFDRSxPQUFPLENBQUNDLEtBQUs7SUFDOUIsTUFBTUMsVUFBVSxHQUFHQyxtQkFBVSxDQUFDQyxNQUFNLENBQUM7TUFDbkNDLElBQUksRUFBRSxDQUFDO01BQ1BDLFdBQVcsRUFBRSxNQUFNO01BQ25CQyxLQUFLLEVBQUUsSUFBSTtNQUNYQyxLQUFLLEVBQUVDLElBQUksQ0FBQ0MsS0FBSyxDQUFDRCxJQUFJLENBQUNFLE1BQU0sRUFBRSxHQUFHLENBQUMsQ0FBQztNQUNwQ0MsTUFBTSxFQUFFLEVBQUU7TUFDVkMsS0FBSyxFQUFFO0lBQ1QsQ0FBQyxDQUFDO0lBQ0Y7SUFDQTtJQUNBLElBQUFDLHFCQUFRLEVBQUNmLElBQUksQ0FBQ2dCLEdBQUcsRUFBRWIsVUFBVSxDQUFDYyxJQUFJLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQztJQUU1Q2xCLEdBQUcsQ0FBQ0MsSUFBSSxHQUFHO01BQ1RrQixJQUFJLEVBQUUsR0FBRztNQUNUQyxJQUFJLEVBQUVoQixVQUFVLENBQUNnQjtJQUNuQixDQUFDO0VBQ0g7QUFDRjtBQUFDLGVBQ2MsSUFBSXZCLGdCQUFnQixFQUFFO0FBQUEifQ==","map":{"version":3,"names":["PublicController","constructor","getCaptcha","ctx","body","request","query","newCaptcha","svgCaptcha","create","size","ignoreChars","color","noise","Math","floor","random","height","width","setValue","sid","text","code","data"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/api/","sources":["PublicController.js"],"sourcesContent":["import svgCaptcha from \"svg-captcha\";\nimport { getValue, setValue } from \"../config/RedisConfig\";\nclass PublicController {\n  constructor() {}\n  async getCaptcha(ctx) {\n    const body = ctx.request.query;\n    const newCaptcha = svgCaptcha.create({\n      size: 4,\n      ignoreChars: \"0o1i\",\n      color: true,\n      noise: Math.floor(Math.random() * 5),\n      height: 38,\n      width: 150,\n    });\n    // 保存图片验证码数据，设置超时时间单位是秒\n    //设置图片验证码超时十分钟\n    setValue(body.sid, newCaptcha.text, 10 * 60);\n\n    ctx.body = {\n      code: 200,\n      data: newCaptcha.data,\n    };\n  }\n}\nexport default new PublicController();\n"],"mappings":";;;;;;AAAA;AACA;AAA2D;AAC3D,MAAMA,gBAAgB,CAAC;EACrBC,WAAW,GAAG,CAAC;EACf,MAAMC,UAAU,CAACC,GAAG,EAAE;IACpB,MAAMC,IAAI,GAAGD,GAAG,CAACE,OAAO,CAACC,KAAK;IAC9B,MAAMC,UAAU,GAAGC,mBAAU,CAACC,MAAM,CAAC;MACnCC,IAAI,EAAE,CAAC;MACPC,WAAW,EAAE,MAAM;MACnBC,KAAK,EAAE,IAAI;MACXC,KAAK,EAAEC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,EAAE,GAAG,CAAC,CAAC;MACpCC,MAAM,EAAE,EAAE;MACVC,KAAK,EAAE;IACT,CAAC,CAAC;IACF;IACA;IACA,IAAAC,qBAAQ,EAACf,IAAI,CAACgB,GAAG,EAAEb,UAAU,CAACc,IAAI,EAAE,EAAE,GAAG,EAAE,CAAC;IAE5ClB,GAAG,CAACC,IAAI,GAAG;MACTkB,IAAI,EAAE,GAAG;MACTC,IAAI,EAAEhB,UAAU,CAACgB;IACnB,CAAC;EACH;AACF;AAAC,eACc,IAAIvB,gBAAgB,EAAE;AAAA"}},"mtime":1669954879568},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/config/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/config/RedisConfig.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.setValue = exports.getValue = exports.getHValue = exports.delValue = exports.client = void 0;\nvar _redis = _interopRequireDefault(require(\"redis\"));\nvar _bluebird = require(\"bluebird\");\nvar _index = _interopRequireDefault(require(\"./index\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst options = {\n  host: _index.default.REDIS.host,\n  port: _index.default.REDIS.port,\n  password: _index.default.REDIS.password,\n  detect_buffers: true,\n  retry_strategy: function (options) {\n    if (options.error.code === \"ECONNREFUSED\") {\n      // End reconnecting on a specific error and flush all commands with a individual error\n      return new Error(\"The server refused the connection\");\n    }\n    if (options.total_retry_time > 1000 * 60 * 60) {\n      // End reconnecting after a specific timeout and flush all commands with a individual error\n      return new Error(\"Retry time exhausted\");\n    }\n    if (options.times_connected > 10) {\n      // End reconnecting with built in error\n      return undefined;\n    }\n    // reconnect after\n    return Math.max(options.attempt * 100, 3000);\n  }\n};\n\n// const client = redis.createClient(options);\nconst client = (0, _bluebird.promisifyAll)(_redis.default.createClient(options));\nexports.client = client;\nclient.on(\"error\", err => {\n  console.log(\"Redis client error\" + err);\n});\nconst setValue = (key, value, time) => {\n  if (typeof value === \"undefined\" || value == null || value === \"\") {\n    return;\n  }\n  if (typeof value === \"string\") {\n    if (typeof time !== \"undefine\") {\n      client.set(key, value, \"EX\", time);\n    } else {\n      client.set(key, value);\n    }\n  } else if (typeof value === \"object\") {\n    Object.keys(value).forEach(item => {\n      client.hset(key, item, value[item], _redis.default.print);\n    });\n  }\n};\n\n// const { promisify } = require(\"util\");\n// const getAsync = promisify(client.get).bind(client);\nexports.setValue = setValue;\nconst getValue = key => {\n  return client.getAsync(key);\n};\nexports.getValue = getValue;\nconst getHValue = key => {\n  //v8 promisify method use util, must node>8\n  // return promisify(client.hgetall).bind(client)(key);\n  //bluebird async\n  return client.hgetallAsync(key);\n};\nexports.getHValue = getHValue;\nconst delValue = key => {\n  return client.del(key, (err, res) => {\n    if (res == 1) {\n      console.log(\"delete success\");\n    } else {\n      console.log(\"delete redis key is fail\");\n    }\n  });\n};\nexports.delValue = delValue;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJvcHRpb25zIiwiaG9zdCIsImNvbmZpZyIsIlJFRElTIiwicG9ydCIsInBhc3N3b3JkIiwiZGV0ZWN0X2J1ZmZlcnMiLCJyZXRyeV9zdHJhdGVneSIsImVycm9yIiwiY29kZSIsIkVycm9yIiwidG90YWxfcmV0cnlfdGltZSIsInRpbWVzX2Nvbm5lY3RlZCIsInVuZGVmaW5lZCIsIk1hdGgiLCJtYXgiLCJhdHRlbXB0IiwiY2xpZW50IiwicHJvbWlzaWZ5QWxsIiwicmVkaXMiLCJjcmVhdGVDbGllbnQiLCJvbiIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJzZXRWYWx1ZSIsImtleSIsInZhbHVlIiwidGltZSIsInNldCIsIk9iamVjdCIsImtleXMiLCJmb3JFYWNoIiwiaXRlbSIsImhzZXQiLCJwcmludCIsImdldFZhbHVlIiwiZ2V0QXN5bmMiLCJnZXRIVmFsdWUiLCJoZ2V0YWxsQXN5bmMiLCJkZWxWYWx1ZSIsImRlbCIsInJlcyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2x1Y2t5L0Rlc2t0b3AvZnJvbnQvZGFxaWFuZHVhbi9hcGkvc3JjL2NvbmZpZy8iLCJzb3VyY2VzIjpbIlJlZGlzQ29uZmlnLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCByZWRpcyBmcm9tIFwicmVkaXNcIjtcbmltcG9ydCB7IHByb21pc2lmeUFsbCB9IGZyb20gXCJibHVlYmlyZFwiO1xuaW1wb3J0IGNvbmZpZyBmcm9tIFwiLi9pbmRleFwiO1xuY29uc3Qgb3B0aW9ucyA9IHtcbiAgaG9zdDogY29uZmlnLlJFRElTLmhvc3QsXG4gIHBvcnQ6IGNvbmZpZy5SRURJUy5wb3J0LFxuICBwYXNzd29yZDogY29uZmlnLlJFRElTLnBhc3N3b3JkLFxuICBkZXRlY3RfYnVmZmVyczogdHJ1ZSxcbiAgcmV0cnlfc3RyYXRlZ3k6IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgaWYgKG9wdGlvbnMuZXJyb3IuY29kZSA9PT0gXCJFQ09OTlJFRlVTRURcIikge1xuICAgICAgLy8gRW5kIHJlY29ubmVjdGluZyBvbiBhIHNwZWNpZmljIGVycm9yIGFuZCBmbHVzaCBhbGwgY29tbWFuZHMgd2l0aCBhIGluZGl2aWR1YWwgZXJyb3JcbiAgICAgIHJldHVybiBuZXcgRXJyb3IoXCJUaGUgc2VydmVyIHJlZnVzZWQgdGhlIGNvbm5lY3Rpb25cIik7XG4gICAgfVxuICAgIGlmIChvcHRpb25zLnRvdGFsX3JldHJ5X3RpbWUgPiAxMDAwICogNjAgKiA2MCkge1xuICAgICAgLy8gRW5kIHJlY29ubmVjdGluZyBhZnRlciBhIHNwZWNpZmljIHRpbWVvdXQgYW5kIGZsdXNoIGFsbCBjb21tYW5kcyB3aXRoIGEgaW5kaXZpZHVhbCBlcnJvclxuICAgICAgcmV0dXJuIG5ldyBFcnJvcihcIlJldHJ5IHRpbWUgZXhoYXVzdGVkXCIpO1xuICAgIH1cbiAgICBpZiAob3B0aW9ucy50aW1lc19jb25uZWN0ZWQgPiAxMCkge1xuICAgICAgLy8gRW5kIHJlY29ubmVjdGluZyB3aXRoIGJ1aWx0IGluIGVycm9yXG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICAvLyByZWNvbm5lY3QgYWZ0ZXJcbiAgICByZXR1cm4gTWF0aC5tYXgob3B0aW9ucy5hdHRlbXB0ICogMTAwLCAzMDAwKTtcbiAgfSxcbn07XG5cbi8vIGNvbnN0IGNsaWVudCA9IHJlZGlzLmNyZWF0ZUNsaWVudChvcHRpb25zKTtcbmNvbnN0IGNsaWVudCA9IHByb21pc2lmeUFsbChyZWRpcy5jcmVhdGVDbGllbnQob3B0aW9ucykpO1xuY2xpZW50Lm9uKFwiZXJyb3JcIiwgKGVycikgPT4ge1xuICBjb25zb2xlLmxvZyhcIlJlZGlzIGNsaWVudCBlcnJvclwiICsgZXJyKTtcbn0pO1xuY29uc3Qgc2V0VmFsdWUgPSAoa2V5LCB2YWx1ZSwgdGltZSkgPT4ge1xuICBpZiAodHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiIHx8IHZhbHVlID09IG51bGwgfHwgdmFsdWUgPT09IFwiXCIpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgIGlmICh0eXBlb2YgdGltZSAhPT0gXCJ1bmRlZmluZVwiKSB7XG4gICAgICBjbGllbnQuc2V0KGtleSwgdmFsdWUsIFwiRVhcIiwgdGltZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNsaWVudC5zZXQoa2V5LCB2YWx1ZSk7XG4gICAgfVxuICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIikge1xuICAgIE9iamVjdC5rZXlzKHZhbHVlKS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICBjbGllbnQuaHNldChrZXksIGl0ZW0sIHZhbHVlW2l0ZW1dLCByZWRpcy5wcmludCk7XG4gICAgfSk7XG4gIH1cbn07XG5cbi8vIGNvbnN0IHsgcHJvbWlzaWZ5IH0gPSByZXF1aXJlKFwidXRpbFwiKTtcbi8vIGNvbnN0IGdldEFzeW5jID0gcHJvbWlzaWZ5KGNsaWVudC5nZXQpLmJpbmQoY2xpZW50KTtcbmNvbnN0IGdldFZhbHVlID0gKGtleSkgPT4ge1xuICByZXR1cm4gY2xpZW50LmdldEFzeW5jKGtleSk7XG59O1xuXG5jb25zdCBnZXRIVmFsdWUgPSAoa2V5KSA9PiB7XG4gIC8vdjggcHJvbWlzaWZ5IG1ldGhvZCB1c2UgdXRpbCwgbXVzdCBub2RlPjhcbiAgLy8gcmV0dXJuIHByb21pc2lmeShjbGllbnQuaGdldGFsbCkuYmluZChjbGllbnQpKGtleSk7XG4gIC8vYmx1ZWJpcmQgYXN5bmNcbiAgcmV0dXJuIGNsaWVudC5oZ2V0YWxsQXN5bmMoa2V5KTtcbn07XG5cbmNvbnN0IGRlbFZhbHVlID0gKGtleSkgPT4ge1xuICByZXR1cm4gY2xpZW50LmRlbChrZXksIChlcnIsIHJlcykgPT4ge1xuICAgIGlmIChyZXMgPT0gMSkge1xuICAgICAgY29uc29sZS5sb2coXCJkZWxldGUgc3VjY2Vzc1wiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coXCJkZWxldGUgcmVkaXMga2V5IGlzIGZhaWxcIik7XG4gICAgfVxuICB9KTtcbn07XG5leHBvcnQgeyBjbGllbnQsIHNldFZhbHVlLCBnZXRWYWx1ZSwgZ2V0SFZhbHVlLCBkZWxWYWx1ZSB9O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFBNkI7QUFDN0IsTUFBTUEsT0FBTyxHQUFHO0VBQ2RDLElBQUksRUFBRUMsY0FBTSxDQUFDQyxLQUFLLENBQUNGLElBQUk7RUFDdkJHLElBQUksRUFBRUYsY0FBTSxDQUFDQyxLQUFLLENBQUNDLElBQUk7RUFDdkJDLFFBQVEsRUFBRUgsY0FBTSxDQUFDQyxLQUFLLENBQUNFLFFBQVE7RUFDL0JDLGNBQWMsRUFBRSxJQUFJO0VBQ3BCQyxjQUFjLEVBQUUsVUFBVVAsT0FBTyxFQUFFO0lBQ2pDLElBQUlBLE9BQU8sQ0FBQ1EsS0FBSyxDQUFDQyxJQUFJLEtBQUssY0FBYyxFQUFFO01BQ3pDO01BQ0EsT0FBTyxJQUFJQyxLQUFLLENBQUMsbUNBQW1DLENBQUM7SUFDdkQ7SUFDQSxJQUFJVixPQUFPLENBQUNXLGdCQUFnQixHQUFHLElBQUksR0FBRyxFQUFFLEdBQUcsRUFBRSxFQUFFO01BQzdDO01BQ0EsT0FBTyxJQUFJRCxLQUFLLENBQUMsc0JBQXNCLENBQUM7SUFDMUM7SUFDQSxJQUFJVixPQUFPLENBQUNZLGVBQWUsR0FBRyxFQUFFLEVBQUU7TUFDaEM7TUFDQSxPQUFPQyxTQUFTO0lBQ2xCO0lBQ0E7SUFDQSxPQUFPQyxJQUFJLENBQUNDLEdBQUcsQ0FBQ2YsT0FBTyxDQUFDZ0IsT0FBTyxHQUFHLEdBQUcsRUFBRSxJQUFJLENBQUM7RUFDOUM7QUFDRixDQUFDOztBQUVEO0FBQ0EsTUFBTUMsTUFBTSxHQUFHLElBQUFDLHNCQUFZLEVBQUNDLGNBQUssQ0FBQ0MsWUFBWSxDQUFDcEIsT0FBTyxDQUFDLENBQUM7QUFBQztBQUN6RGlCLE1BQU0sQ0FBQ0ksRUFBRSxDQUFDLE9BQU8sRUFBR0MsR0FBRyxJQUFLO0VBQzFCQyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxvQkFBb0IsR0FBR0YsR0FBRyxDQUFDO0FBQ3pDLENBQUMsQ0FBQztBQUNGLE1BQU1HLFFBQVEsR0FBRyxDQUFDQyxHQUFHLEVBQUVDLEtBQUssRUFBRUMsSUFBSSxLQUFLO0VBQ3JDLElBQUksT0FBT0QsS0FBSyxLQUFLLFdBQVcsSUFBSUEsS0FBSyxJQUFJLElBQUksSUFBSUEsS0FBSyxLQUFLLEVBQUUsRUFBRTtJQUNqRTtFQUNGO0VBQ0EsSUFBSSxPQUFPQSxLQUFLLEtBQUssUUFBUSxFQUFFO0lBQzdCLElBQUksT0FBT0MsSUFBSSxLQUFLLFVBQVUsRUFBRTtNQUM5QlgsTUFBTSxDQUFDWSxHQUFHLENBQUNILEdBQUcsRUFBRUMsS0FBSyxFQUFFLElBQUksRUFBRUMsSUFBSSxDQUFDO0lBQ3BDLENBQUMsTUFBTTtNQUNMWCxNQUFNLENBQUNZLEdBQUcsQ0FBQ0gsR0FBRyxFQUFFQyxLQUFLLENBQUM7SUFDeEI7RUFDRixDQUFDLE1BQU0sSUFBSSxPQUFPQSxLQUFLLEtBQUssUUFBUSxFQUFFO0lBQ3BDRyxNQUFNLENBQUNDLElBQUksQ0FBQ0osS0FBSyxDQUFDLENBQUNLLE9BQU8sQ0FBRUMsSUFBSSxJQUFLO01BQ25DaEIsTUFBTSxDQUFDaUIsSUFBSSxDQUFDUixHQUFHLEVBQUVPLElBQUksRUFBRU4sS0FBSyxDQUFDTSxJQUFJLENBQUMsRUFBRWQsY0FBSyxDQUFDZ0IsS0FBSyxDQUFDO0lBQ2xELENBQUMsQ0FBQztFQUNKO0FBQ0YsQ0FBQzs7QUFFRDtBQUNBO0FBQUE7QUFDQSxNQUFNQyxRQUFRLEdBQUlWLEdBQUcsSUFBSztFQUN4QixPQUFPVCxNQUFNLENBQUNvQixRQUFRLENBQUNYLEdBQUcsQ0FBQztBQUM3QixDQUFDO0FBQUM7QUFFRixNQUFNWSxTQUFTLEdBQUlaLEdBQUcsSUFBSztFQUN6QjtFQUNBO0VBQ0E7RUFDQSxPQUFPVCxNQUFNLENBQUNzQixZQUFZLENBQUNiLEdBQUcsQ0FBQztBQUNqQyxDQUFDO0FBQUM7QUFFRixNQUFNYyxRQUFRLEdBQUlkLEdBQUcsSUFBSztFQUN4QixPQUFPVCxNQUFNLENBQUN3QixHQUFHLENBQUNmLEdBQUcsRUFBRSxDQUFDSixHQUFHLEVBQUVvQixHQUFHLEtBQUs7SUFDbkMsSUFBSUEsR0FBRyxJQUFJLENBQUMsRUFBRTtNQUNabkIsT0FBTyxDQUFDQyxHQUFHLENBQUMsZ0JBQWdCLENBQUM7SUFDL0IsQ0FBQyxNQUFNO01BQ0xELE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLDBCQUEwQixDQUFDO0lBQ3pDO0VBQ0YsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUFDIn0=","map":{"version":3,"names":["options","host","config","REDIS","port","password","detect_buffers","retry_strategy","error","code","Error","total_retry_time","times_connected","undefined","Math","max","attempt","client","promisifyAll","redis","createClient","on","err","console","log","setValue","key","value","time","set","Object","keys","forEach","item","hset","print","getValue","getAsync","getHValue","hgetallAsync","delValue","del","res"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/config/","sources":["RedisConfig.js"],"sourcesContent":["import redis from \"redis\";\nimport { promisifyAll } from \"bluebird\";\nimport config from \"./index\";\nconst options = {\n  host: config.REDIS.host,\n  port: config.REDIS.port,\n  password: config.REDIS.password,\n  detect_buffers: true,\n  retry_strategy: function (options) {\n    if (options.error.code === \"ECONNREFUSED\") {\n      // End reconnecting on a specific error and flush all commands with a individual error\n      return new Error(\"The server refused the connection\");\n    }\n    if (options.total_retry_time > 1000 * 60 * 60) {\n      // End reconnecting after a specific timeout and flush all commands with a individual error\n      return new Error(\"Retry time exhausted\");\n    }\n    if (options.times_connected > 10) {\n      // End reconnecting with built in error\n      return undefined;\n    }\n    // reconnect after\n    return Math.max(options.attempt * 100, 3000);\n  },\n};\n\n// const client = redis.createClient(options);\nconst client = promisifyAll(redis.createClient(options));\nclient.on(\"error\", (err) => {\n  console.log(\"Redis client error\" + err);\n});\nconst setValue = (key, value, time) => {\n  if (typeof value === \"undefined\" || value == null || value === \"\") {\n    return;\n  }\n  if (typeof value === \"string\") {\n    if (typeof time !== \"undefine\") {\n      client.set(key, value, \"EX\", time);\n    } else {\n      client.set(key, value);\n    }\n  } else if (typeof value === \"object\") {\n    Object.keys(value).forEach((item) => {\n      client.hset(key, item, value[item], redis.print);\n    });\n  }\n};\n\n// const { promisify } = require(\"util\");\n// const getAsync = promisify(client.get).bind(client);\nconst getValue = (key) => {\n  return client.getAsync(key);\n};\n\nconst getHValue = (key) => {\n  //v8 promisify method use util, must node>8\n  // return promisify(client.hgetall).bind(client)(key);\n  //bluebird async\n  return client.hgetallAsync(key);\n};\n\nconst delValue = (key) => {\n  return client.del(key, (err, res) => {\n    if (res == 1) {\n      console.log(\"delete success\");\n    } else {\n      console.log(\"delete redis key is fail\");\n    }\n  });\n};\nexport { client, setValue, getValue, getHValue, delValue };\n"],"mappings":";;;;;;AAAA;AACA;AACA;AAA6B;AAC7B,MAAMA,OAAO,GAAG;EACdC,IAAI,EAAEC,cAAM,CAACC,KAAK,CAACF,IAAI;EACvBG,IAAI,EAAEF,cAAM,CAACC,KAAK,CAACC,IAAI;EACvBC,QAAQ,EAAEH,cAAM,CAACC,KAAK,CAACE,QAAQ;EAC/BC,cAAc,EAAE,IAAI;EACpBC,cAAc,EAAE,UAAUP,OAAO,EAAE;IACjC,IAAIA,OAAO,CAACQ,KAAK,CAACC,IAAI,KAAK,cAAc,EAAE;MACzC;MACA,OAAO,IAAIC,KAAK,CAAC,mCAAmC,CAAC;IACvD;IACA,IAAIV,OAAO,CAACW,gBAAgB,GAAG,IAAI,GAAG,EAAE,GAAG,EAAE,EAAE;MAC7C;MACA,OAAO,IAAID,KAAK,CAAC,sBAAsB,CAAC;IAC1C;IACA,IAAIV,OAAO,CAACY,eAAe,GAAG,EAAE,EAAE;MAChC;MACA,OAAOC,SAAS;IAClB;IACA;IACA,OAAOC,IAAI,CAACC,GAAG,CAACf,OAAO,CAACgB,OAAO,GAAG,GAAG,EAAE,IAAI,CAAC;EAC9C;AACF,CAAC;;AAED;AACA,MAAMC,MAAM,GAAG,IAAAC,sBAAY,EAACC,cAAK,CAACC,YAAY,CAACpB,OAAO,CAAC,CAAC;AAAC;AACzDiB,MAAM,CAACI,EAAE,CAAC,OAAO,EAAGC,GAAG,IAAK;EAC1BC,OAAO,CAACC,GAAG,CAAC,oBAAoB,GAAGF,GAAG,CAAC;AACzC,CAAC,CAAC;AACF,MAAMG,QAAQ,GAAG,CAACC,GAAG,EAAEC,KAAK,EAAEC,IAAI,KAAK;EACrC,IAAI,OAAOD,KAAK,KAAK,WAAW,IAAIA,KAAK,IAAI,IAAI,IAAIA,KAAK,KAAK,EAAE,EAAE;IACjE;EACF;EACA,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;IAC7B,IAAI,OAAOC,IAAI,KAAK,UAAU,EAAE;MAC9BX,MAAM,CAACY,GAAG,CAACH,GAAG,EAAEC,KAAK,EAAE,IAAI,EAAEC,IAAI,CAAC;IACpC,CAAC,MAAM;MACLX,MAAM,CAACY,GAAG,CAACH,GAAG,EAAEC,KAAK,CAAC;IACxB;EACF,CAAC,MAAM,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;IACpCG,MAAM,CAACC,IAAI,CAACJ,KAAK,CAAC,CAACK,OAAO,CAAEC,IAAI,IAAK;MACnChB,MAAM,CAACiB,IAAI,CAACR,GAAG,EAAEO,IAAI,EAAEN,KAAK,CAACM,IAAI,CAAC,EAAEd,cAAK,CAACgB,KAAK,CAAC;IAClD,CAAC,CAAC;EACJ;AACF,CAAC;;AAED;AACA;AAAA;AACA,MAAMC,QAAQ,GAAIV,GAAG,IAAK;EACxB,OAAOT,MAAM,CAACoB,QAAQ,CAACX,GAAG,CAAC;AAC7B,CAAC;AAAC;AAEF,MAAMY,SAAS,GAAIZ,GAAG,IAAK;EACzB;EACA;EACA;EACA,OAAOT,MAAM,CAACsB,YAAY,CAACb,GAAG,CAAC;AACjC,CAAC;AAAC;AAEF,MAAMc,QAAQ,GAAId,GAAG,IAAK;EACxB,OAAOT,MAAM,CAACwB,GAAG,CAACf,GAAG,EAAE,CAACJ,GAAG,EAAEoB,GAAG,KAAK;IACnC,IAAIA,GAAG,IAAI,CAAC,EAAE;MACZnB,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAC;IAC/B,CAAC,MAAM;MACLD,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC;IACzC;EACF,CAAC,CAAC;AACJ,CAAC;AAAC"}},"mtime":1669775046904},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/config/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/config/index.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nconst DB_URL = \"mongodb://test:123456@8.134.11.242:27017/testdb\";\nconst REDIS = {\n  host: \"8.134.11.242\",\n  port: 15001,\n  password: \"123456\"\n};\nconst JWT_SECRET = \"a&*38QthAKuiRwISGLotgq^3%^$zvA3A6Hfr8MF$jM*dWcwAW&9NGp7*b53!\";\nvar _default = {\n  DB_URL,\n  REDIS,\n  JWT_SECRET\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEQl9VUkwiLCJSRURJUyIsImhvc3QiLCJwb3J0IiwicGFzc3dvcmQiLCJKV1RfU0VDUkVUIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvbHVja3kvRGVza3RvcC9mcm9udC9kYXFpYW5kdWFuL2FwaS9zcmMvY29uZmlnLyIsInNvdXJjZXMiOlsiaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgREJfVVJMID0gXCJtb25nb2RiOi8vdGVzdDoxMjM0NTZAOC4xMzQuMTEuMjQyOjI3MDE3L3Rlc3RkYlwiO1xuY29uc3QgUkVESVMgPSB7XG4gIGhvc3Q6IFwiOC4xMzQuMTEuMjQyXCIsXG4gIHBvcnQ6IDE1MDAxLFxuICBwYXNzd29yZDogXCIxMjM0NTZcIixcbn07XG5jb25zdCBKV1RfU0VDUkVUID1cbiAgXCJhJiozOFF0aEFLdWlSd0lTR0xvdGdxXjMlXiR6dkEzQTZIZnI4TUYkak0qZFdjd0FXJjlOR3A3KmI1MyFcIjtcbmV4cG9ydCBkZWZhdWx0IHtcbiAgREJfVVJMLFxuICBSRURJUyxcbiAgSldUX1NFQ1JFVCxcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLE1BQU1BLE1BQU0sR0FBRyxpREFBaUQ7QUFDaEUsTUFBTUMsS0FBSyxHQUFHO0VBQ1pDLElBQUksRUFBRSxjQUFjO0VBQ3BCQyxJQUFJLEVBQUUsS0FBSztFQUNYQyxRQUFRLEVBQUU7QUFDWixDQUFDO0FBQ0QsTUFBTUMsVUFBVSxHQUNkLDhEQUE4RDtBQUFDLGVBQ2xEO0VBQ2JMLE1BQU07RUFDTkMsS0FBSztFQUNMSTtBQUNGLENBQUM7QUFBQSJ9","map":{"version":3,"names":["DB_URL","REDIS","host","port","password","JWT_SECRET"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/config/","sources":["index.js"],"sourcesContent":["const DB_URL = \"mongodb://test:123456@8.134.11.242:27017/testdb\";\nconst REDIS = {\n  host: \"8.134.11.242\",\n  port: 15001,\n  password: \"123456\",\n};\nconst JWT_SECRET =\n  \"a&*38QthAKuiRwISGLotgq^3%^$zvA3A6Hfr8MF$jM*dWcwAW&9NGp7*b53!\";\nexport default {\n  DB_URL,\n  REDIS,\n  JWT_SECRET,\n};\n"],"mappings":";;;;;;AAAA,MAAMA,MAAM,GAAG,iDAAiD;AAChE,MAAMC,KAAK,GAAG;EACZC,IAAI,EAAE,cAAc;EACpBC,IAAI,EAAE,KAAK;EACXC,QAAQ,EAAE;AACZ,CAAC;AACD,MAAMC,UAAU,GACd,8DAA8D;AAAC,eAClD;EACbL,MAAM;EACNC,KAAK;EACLI;AACF,CAAC;AAAA"}},"mtime":1669852069623},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/routes/LoginRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _koaRouter = _interopRequireDefault(require(\"koa-router\"));\nvar _LoginController = _interopRequireDefault(require(\"../api/LoginController\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst router = new _koaRouter.default();\nrouter.prefix(\"/login\");\nrouter.post(\"/forget\", _LoginController.default.forget);\nrouter.post(\"/login\", _LoginController.default.login);\nrouter.post(\"/regist\", _LoginController.default.regist);\nvar _default = router;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyb3V0ZXIiLCJSb3V0ZXIiLCJwcmVmaXgiLCJwb3N0IiwibG9naW5Db250cm9sbGVyIiwiZm9yZ2V0IiwiTG9naW5Db250cm9sbGVyIiwibG9naW4iLCJyZWdpc3QiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9sdWNreS9EZXNrdG9wL2Zyb250L2RhcWlhbmR1YW4vYXBpL3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJMb2dpblJvdXRlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUm91dGVyIGZyb20gXCJrb2Etcm91dGVyXCI7XG5pbXBvcnQgTG9naW5Db250cm9sbGVyIGZyb20gXCIuLi9hcGkvTG9naW5Db250cm9sbGVyXCI7XG5pbXBvcnQgbG9naW5Db250cm9sbGVyIGZyb20gXCIuLi9hcGkvTG9naW5Db250cm9sbGVyXCI7XG5jb25zdCByb3V0ZXIgPSBuZXcgUm91dGVyKCk7XG5yb3V0ZXIucHJlZml4KFwiL2xvZ2luXCIpO1xucm91dGVyLnBvc3QoXCIvZm9yZ2V0XCIsIGxvZ2luQ29udHJvbGxlci5mb3JnZXQpO1xucm91dGVyLnBvc3QoXCIvbG9naW5cIiwgTG9naW5Db250cm9sbGVyLmxvZ2luKTtcbnJvdXRlci5wb3N0KFwiL3JlZ2lzdFwiLCBsb2dpbkNvbnRyb2xsZXIucmVnaXN0KTtcbmV4cG9ydCBkZWZhdWx0IHJvdXRlcjtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUFxRDtBQUVyRCxNQUFNQSxNQUFNLEdBQUcsSUFBSUMsa0JBQU0sRUFBRTtBQUMzQkQsTUFBTSxDQUFDRSxNQUFNLENBQUMsUUFBUSxDQUFDO0FBQ3ZCRixNQUFNLENBQUNHLElBQUksQ0FBQyxTQUFTLEVBQUVDLHdCQUFlLENBQUNDLE1BQU0sQ0FBQztBQUM5Q0wsTUFBTSxDQUFDRyxJQUFJLENBQUMsUUFBUSxFQUFFRyx3QkFBZSxDQUFDQyxLQUFLLENBQUM7QUFDNUNQLE1BQU0sQ0FBQ0csSUFBSSxDQUFDLFNBQVMsRUFBRUMsd0JBQWUsQ0FBQ0ksTUFBTSxDQUFDO0FBQUMsZUFDaENSLE1BQU07QUFBQSJ9","map":{"version":3,"names":["router","Router","prefix","post","loginController","forget","LoginController","login","regist"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/routes/","sources":["LoginRouter.js"],"sourcesContent":["import Router from \"koa-router\";\nimport LoginController from \"../api/LoginController\";\nimport loginController from \"../api/LoginController\";\nconst router = new Router();\nrouter.prefix(\"/login\");\nrouter.post(\"/forget\", loginController.forget);\nrouter.post(\"/login\", LoginController.login);\nrouter.post(\"/regist\", loginController.regist);\nexport default router;\n"],"mappings":";;;;;;AAAA;AACA;AAAqD;AAErD,MAAMA,MAAM,GAAG,IAAIC,kBAAM,EAAE;AAC3BD,MAAM,CAACE,MAAM,CAAC,QAAQ,CAAC;AACvBF,MAAM,CAACG,IAAI,CAAC,SAAS,EAAEC,wBAAe,CAACC,MAAM,CAAC;AAC9CL,MAAM,CAACG,IAAI,CAAC,QAAQ,EAAEG,wBAAe,CAACC,KAAK,CAAC;AAC5CP,MAAM,CAACG,IAAI,CAAC,SAAS,EAAEC,wBAAe,CAACI,MAAM,CAAC;AAAC,eAChCR,MAAM;AAAA"}},"mtime":1669882456528},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/api/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/api/LoginController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _MailConfig = _interopRequireDefault(require(\"../config/MailConfig\"));\nvar _bcrypt = _interopRequireDefault(require(\"bcrypt\"));\nvar _moment = _interopRequireDefault(require(\"moment\"));\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\nvar _config = _interopRequireDefault(require(\"../config\"));\nvar _Utils = require(\"../common/Utils\");\nvar _User = _interopRequireDefault(require(\"../model/User\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nclass LoginController {\n  constructor() {}\n  async forget(ctx) {\n    const {\n      body\n    } = ctx.request;\n    try {\n      //body.username->database->email\n      let result = await (0, _MailConfig.default)({\n        code: \"1234\",\n        expire: (0, _moment.default)().add(30, \"minutes\").format(\"YYYY-MM-DD HH:mm:ss\"),\n        email: body.username,\n        user: \"ludaohua\"\n      });\n      ctx.body = {\n        code: 200,\n        data: result,\n        msg: \"邮件发送成功\"\n      };\n    } catch (e) {\n      console.log(e);\n    }\n  }\n  async login(ctx) {\n    //接受用户的数据\n    //返回token\n    const {\n      body\n    } = ctx.request;\n    let sid = body.sid;\n    let code = body.code;\n    //验证图片验证码的时效性，正确性\n    let result = await (0, _Utils.checkCode)(sid, code);\n    if (result) {\n      //验证用户账号的密码是否正确\n      let checkUserPasswd = false;\n      let user = await _User.default.findOne({\n        username: body.username\n      });\n      if (user.password === body.password) {\n        checkUserPasswd = true;\n      }\n      //mongoDB查库\n      if (checkUserPasswd) {\n        let token = _jsonwebtoken.default.sign({\n          _id: \"brian\"\n        }, _config.default.JWT_SECRET, {\n          expiresIn: \"1d\"\n        });\n        ctx.body = {\n          code: 200,\n          token: token\n        };\n      } else {\n        //用户名，密码验证失败，返回提示\n        ctx.body = {\n          code: 404,\n          msg: \"用户名或密码错误\"\n        };\n      }\n    } else {\n      //图片验证码校验失败\n      ctx.body = {\n        code: 401,\n        msg: \"图片验证码不正确，请检查\"\n      };\n    }\n  }\n  async reg(ctx) {\n    // 接收客户端的数据\n    const {\n      body\n    } = ctx.request;\n    // 校验验证码的内容（时效性，有效性\n    let sid = body.sid;\n    let code = body.code;\n    let msg = {};\n    //验证图片验证码的时效性，正确性\n    let result = await (0, _Utils.checkCode)(sid, code);\n    let check = true;\n    if (result) {\n      //查库，看username是否被注册\n      let user1 = await _User.default.findOne({\n        username: body.username\n      });\n      if (typeof user1.username !== \"undefine\") {\n        msg.username = [\"此邮箱已经注册，可以通过邮箱找回密码\"];\n        check = false;\n      }\n      // 查库，看name是否被注册\n      let user2 = await _User.default.findOne({\n        name: body.name\n      });\n      if (typeof user1.name !== \"undefine\") {\n        msg.name = [\"此昵称已被注册，请修改\"];\n        check = false;\n      }\n      // 写入数据到数据库\n      if (check) {\n        body.password = await _bcrypt.default.hash(body.password, 5);\n        let user = new _User.default({\n          username: body.username,\n          name: body.name,\n          password: body.password,\n          created: (0, _moment.default)().format(\"YYYY-MM-DD HH:mm:ss\")\n        });\n        let result = await user.save();\n        ctx.bod = {\n          code: 200,\n          data: result,\n          msg: \"注册成功\"\n        };\n      }\n    } else {\n      // veevalidate显示的错误\n      msg.code = [\"验证码已经失效，请重新获取\"];\n    }\n  }\n}\nvar _default = new LoginController();\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJMb2dpbkNvbnRyb2xsZXIiLCJjb25zdHJ1Y3RvciIsImZvcmdldCIsImN0eCIsImJvZHkiLCJyZXF1ZXN0IiwicmVzdWx0Iiwic2VuZCIsImNvZGUiLCJleHBpcmUiLCJtb21lbnQiLCJhZGQiLCJmb3JtYXQiLCJlbWFpbCIsInVzZXJuYW1lIiwidXNlciIsImRhdGEiLCJtc2ciLCJlIiwiY29uc29sZSIsImxvZyIsImxvZ2luIiwic2lkIiwiY2hlY2tDb2RlIiwiY2hlY2tVc2VyUGFzc3dkIiwiVXNlciIsImZpbmRPbmUiLCJwYXNzd29yZCIsInRva2VuIiwianNvbndlYnRva2VuIiwic2lnbiIsIl9pZCIsImNvbmZpZyIsIkpXVF9TRUNSRVQiLCJleHBpcmVzSW4iLCJyZWciLCJjaGVjayIsInVzZXIxIiwidXNlcjIiLCJuYW1lIiwiYmNyeXB0IiwiaGFzaCIsImNyZWF0ZWQiLCJzYXZlIiwiYm9kIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvbHVja3kvRGVza3RvcC9mcm9udC9kYXFpYW5kdWFuL2FwaS9zcmMvYXBpLyIsInNvdXJjZXMiOlsiTG9naW5Db250cm9sbGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBzZW5kIGZyb20gXCIuLi9jb25maWcvTWFpbENvbmZpZ1wiO1xuaW1wb3J0IGJjcnlwdCBmcm9tIFwiYmNyeXB0XCI7XG5pbXBvcnQgbW9tZW50IGZyb20gXCJtb21lbnRcIjtcbmltcG9ydCBqc29ud2VidG9rZW4gZnJvbSBcImpzb253ZWJ0b2tlblwiO1xuaW1wb3J0IGNvbmZpZyBmcm9tIFwiLi4vY29uZmlnXCI7XG5pbXBvcnQgeyBjaGVja0NvZGUgfSBmcm9tIFwiLi4vY29tbW9uL1V0aWxzXCI7XG5pbXBvcnQgVXNlciBmcm9tIFwiLi4vbW9kZWwvVXNlclwiO1xuY2xhc3MgTG9naW5Db250cm9sbGVyIHtcbiAgY29uc3RydWN0b3IoKSB7fVxuICBhc3luYyBmb3JnZXQoY3R4KSB7XG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdDtcbiAgICB0cnkge1xuICAgICAgLy9ib2R5LnVzZXJuYW1lLT5kYXRhYmFzZS0+ZW1haWxcbiAgICAgIGxldCByZXN1bHQgPSBhd2FpdCBzZW5kKHtcbiAgICAgICAgY29kZTogXCIxMjM0XCIsXG4gICAgICAgIGV4cGlyZTogbW9tZW50KCkuYWRkKDMwLCBcIm1pbnV0ZXNcIikuZm9ybWF0KFwiWVlZWS1NTS1ERCBISDptbTpzc1wiKSxcbiAgICAgICAgZW1haWw6IGJvZHkudXNlcm5hbWUsXG4gICAgICAgIHVzZXI6IFwibHVkYW9odWFcIixcbiAgICAgIH0pO1xuICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgZGF0YTogcmVzdWx0LFxuICAgICAgICBtc2c6IFwi6YKu5Lu25Y+R6YCB5oiQ5YqfXCIsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUubG9nKGUpO1xuICAgIH1cbiAgfVxuICBhc3luYyBsb2dpbihjdHgpIHtcbiAgICAvL+aOpeWPl+eUqOaIt+eahOaVsOaNrlxuICAgIC8v6L+U5ZuedG9rZW5cbiAgICBjb25zdCB7IGJvZHkgfSA9IGN0eC5yZXF1ZXN0O1xuICAgIGxldCBzaWQgPSBib2R5LnNpZDtcbiAgICBsZXQgY29kZSA9IGJvZHkuY29kZTtcbiAgICAvL+mqjOivgeWbvueJh+mqjOivgeeggeeahOaXtuaViOaAp++8jOato+ehruaAp1xuICAgIGxldCByZXN1bHQgPSBhd2FpdCBjaGVja0NvZGUoc2lkLCBjb2RlKTtcbiAgICBpZiAocmVzdWx0KSB7XG4gICAgICAvL+mqjOivgeeUqOaIt+i0puWPt+eahOWvhueggeaYr+WQpuato+ehrlxuICAgICAgbGV0IGNoZWNrVXNlclBhc3N3ZCA9IGZhbHNlO1xuICAgICAgbGV0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyB1c2VybmFtZTogYm9keS51c2VybmFtZSB9KTtcbiAgICAgIGlmICh1c2VyLnBhc3N3b3JkID09PSBib2R5LnBhc3N3b3JkKSB7XG4gICAgICAgIGNoZWNrVXNlclBhc3N3ZCA9IHRydWU7XG4gICAgICB9XG4gICAgICAvL21vbmdvRELmn6XlupNcbiAgICAgIGlmIChjaGVja1VzZXJQYXNzd2QpIHtcbiAgICAgICAgbGV0IHRva2VuID0ganNvbndlYnRva2VuLnNpZ24oeyBfaWQ6IFwiYnJpYW5cIiB9LCBjb25maWcuSldUX1NFQ1JFVCwge1xuICAgICAgICAgIGV4cGlyZXNJbjogXCIxZFwiLFxuICAgICAgICB9KTtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgY29kZTogMjAwLFxuICAgICAgICAgIHRva2VuOiB0b2tlbixcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8v55So5oi35ZCN77yM5a+G56CB6aqM6K+B5aSx6LSl77yM6L+U5Zue5o+Q56S6XG4gICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgIGNvZGU6IDQwNCxcbiAgICAgICAgICBtc2c6IFwi55So5oi35ZCN5oiW5a+G56CB6ZSZ6K+vXCIsXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8v5Zu+54mH6aqM6K+B56CB5qCh6aqM5aSx6LSlXG4gICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgY29kZTogNDAxLFxuICAgICAgICBtc2c6IFwi5Zu+54mH6aqM6K+B56CB5LiN5q2j56Gu77yM6K+35qOA5p+lXCIsXG4gICAgICB9O1xuICAgIH1cbiAgfVxuICBhc3luYyByZWcoY3R4KSB7XG4gICAgLy8g5o6l5pS25a6i5oi356uv55qE5pWw5o2uXG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdDtcbiAgICAvLyDmoKHpqozpqozor4HnoIHnmoTlhoXlrrnvvIjml7bmlYjmgKfvvIzmnInmlYjmgKdcbiAgICBsZXQgc2lkID0gYm9keS5zaWQ7XG4gICAgbGV0IGNvZGUgPSBib2R5LmNvZGU7XG4gICAgbGV0IG1zZyA9IHt9O1xuICAgIC8v6aqM6K+B5Zu+54mH6aqM6K+B56CB55qE5pe25pWI5oCn77yM5q2j56Gu5oCnXG4gICAgbGV0IHJlc3VsdCA9IGF3YWl0IGNoZWNrQ29kZShzaWQsIGNvZGUpO1xuICAgIGxldCBjaGVjayA9IHRydWU7XG4gICAgaWYgKHJlc3VsdCkge1xuICAgICAgLy/mn6XlupPvvIznnIt1c2VybmFtZeaYr+WQpuiiq+azqOWGjFxuICAgICAgbGV0IHVzZXIxID0gYXdhaXQgVXNlci5maW5kT25lKHsgdXNlcm5hbWU6IGJvZHkudXNlcm5hbWUgfSk7XG4gICAgICBpZiAodHlwZW9mIHVzZXIxLnVzZXJuYW1lICE9PSBcInVuZGVmaW5lXCIpIHtcbiAgICAgICAgbXNnLnVzZXJuYW1lID0gW1wi5q2k6YKu566x5bey57uP5rOo5YaM77yM5Y+v5Lul6YCa6L+H6YKu566x5om+5Zue5a+G56CBXCJdO1xuICAgICAgICBjaGVjayA9IGZhbHNlO1xuICAgICAgfVxuICAgICAgLy8g5p+l5bqT77yM55yLbmFtZeaYr+WQpuiiq+azqOWGjFxuICAgICAgbGV0IHVzZXIyID0gYXdhaXQgVXNlci5maW5kT25lKHsgbmFtZTogYm9keS5uYW1lIH0pO1xuICAgICAgaWYgKHR5cGVvZiB1c2VyMS5uYW1lICE9PSBcInVuZGVmaW5lXCIpIHtcbiAgICAgICAgbXNnLm5hbWUgPSBbXCLmraTmmLXnp7Dlt7Looqvms6jlhozvvIzor7fkv67mlLlcIl07XG4gICAgICAgIGNoZWNrID0gZmFsc2U7XG4gICAgICB9XG4gICAgICAvLyDlhpnlhaXmlbDmja7liLDmlbDmja7lupNcbiAgICAgIGlmIChjaGVjaykge1xuICAgICAgICBib2R5LnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2goYm9keS5wYXNzd29yZCwgNSk7XG4gICAgICAgIGxldCB1c2VyID0gbmV3IFVzZXIoe1xuICAgICAgICAgIHVzZXJuYW1lOiBib2R5LnVzZXJuYW1lLFxuICAgICAgICAgIG5hbWU6IGJvZHkubmFtZSxcbiAgICAgICAgICBwYXNzd29yZDogYm9keS5wYXNzd29yZCxcbiAgICAgICAgICBjcmVhdGVkOiBtb21lbnQoKS5mb3JtYXQoXCJZWVlZLU1NLUREIEhIOm1tOnNzXCIpLFxuICAgICAgICB9KTtcbiAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IHVzZXIuc2F2ZSgpO1xuICAgICAgICBjdHguYm9kID0ge1xuICAgICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgICBkYXRhOiByZXN1bHQsXG4gICAgICAgICAgbXNnOiBcIuazqOWGjOaIkOWKn1wiLFxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyB2ZWV2YWxpZGF0ZeaYvuekuueahOmUmeivr1xuICAgICAgbXNnLmNvZGUgPSBbXCLpqozor4HnoIHlt7Lnu4/lpLHmlYjvvIzor7fph43mlrDojrflj5ZcIl07XG4gICAgfVxuICB9XG59XG5leHBvcnQgZGVmYXVsdCBuZXcgTG9naW5Db250cm9sbGVyKCk7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQWlDO0FBQ2pDLE1BQU1BLGVBQWUsQ0FBQztFQUNwQkMsV0FBVyxHQUFHLENBQUM7RUFDZixNQUFNQyxNQUFNLENBQUNDLEdBQUcsRUFBRTtJQUNoQixNQUFNO01BQUVDO0lBQUssQ0FBQyxHQUFHRCxHQUFHLENBQUNFLE9BQU87SUFDNUIsSUFBSTtNQUNGO01BQ0EsSUFBSUMsTUFBTSxHQUFHLE1BQU0sSUFBQUMsbUJBQUksRUFBQztRQUN0QkMsSUFBSSxFQUFFLE1BQU07UUFDWkMsTUFBTSxFQUFFLElBQUFDLGVBQU0sR0FBRSxDQUFDQyxHQUFHLENBQUMsRUFBRSxFQUFFLFNBQVMsQ0FBQyxDQUFDQyxNQUFNLENBQUMscUJBQXFCLENBQUM7UUFDakVDLEtBQUssRUFBRVQsSUFBSSxDQUFDVSxRQUFRO1FBQ3BCQyxJQUFJLEVBQUU7TUFDUixDQUFDLENBQUM7TUFDRlosR0FBRyxDQUFDQyxJQUFJLEdBQUc7UUFDVEksSUFBSSxFQUFFLEdBQUc7UUFDVFEsSUFBSSxFQUFF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","map":{"version":3,"names":["LoginController","constructor","forget","ctx","body","request","result","send","code","expire","moment","add","format","email","username","user","data","msg","e","console","log","login","sid","checkCode","checkUserPasswd","User","findOne","password","token","jsonwebtoken","sign","_id","config","JWT_SECRET","expiresIn","reg","check","user1","user2","name","bcrypt","hash","created","save","bod"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/api/","sources":["LoginController.js"],"sourcesContent":["import send from \"../config/MailConfig\";\nimport bcrypt from \"bcrypt\";\nimport moment from \"moment\";\nimport jsonwebtoken from \"jsonwebtoken\";\nimport config from \"../config\";\nimport { checkCode } from \"../common/Utils\";\nimport User from \"../model/User\";\nclass LoginController {\n  constructor() {}\n  async forget(ctx) {\n    const { body } = ctx.request;\n    try {\n      //body.username->database->email\n      let result = await send({\n        code: \"1234\",\n        expire: moment().add(30, \"minutes\").format(\"YYYY-MM-DD HH:mm:ss\"),\n        email: body.username,\n        user: \"ludaohua\",\n      });\n      ctx.body = {\n        code: 200,\n        data: result,\n        msg: \"邮件发送成功\",\n      };\n    } catch (e) {\n      console.log(e);\n    }\n  }\n  async login(ctx) {\n    //接受用户的数据\n    //返回token\n    const { body } = ctx.request;\n    let sid = body.sid;\n    let code = body.code;\n    //验证图片验证码的时效性，正确性\n    let result = await checkCode(sid, code);\n    if (result) {\n      //验证用户账号的密码是否正确\n      let checkUserPasswd = false;\n      let user = await User.findOne({ username: body.username });\n      if (user.password === body.password) {\n        checkUserPasswd = true;\n      }\n      //mongoDB查库\n      if (checkUserPasswd) {\n        let token = jsonwebtoken.sign({ _id: \"brian\" }, config.JWT_SECRET, {\n          expiresIn: \"1d\",\n        });\n        ctx.body = {\n          code: 200,\n          token: token,\n        };\n      } else {\n        //用户名，密码验证失败，返回提示\n        ctx.body = {\n          code: 404,\n          msg: \"用户名或密码错误\",\n        };\n      }\n    } else {\n      //图片验证码校验失败\n      ctx.body = {\n        code: 401,\n        msg: \"图片验证码不正确，请检查\",\n      };\n    }\n  }\n  async reg(ctx) {\n    // 接收客户端的数据\n    const { body } = ctx.request;\n    // 校验验证码的内容（时效性，有效性\n    let sid = body.sid;\n    let code = body.code;\n    let msg = {};\n    //验证图片验证码的时效性，正确性\n    let result = await checkCode(sid, code);\n    let check = true;\n    if (result) {\n      //查库，看username是否被注册\n      let user1 = await User.findOne({ username: body.username });\n      if (typeof user1.username !== \"undefine\") {\n        msg.username = [\"此邮箱已经注册，可以通过邮箱找回密码\"];\n        check = false;\n      }\n      // 查库，看name是否被注册\n      let user2 = await User.findOne({ name: body.name });\n      if (typeof user1.name !== \"undefine\") {\n        msg.name = [\"此昵称已被注册，请修改\"];\n        check = false;\n      }\n      // 写入数据到数据库\n      if (check) {\n        body.password = await bcrypt.hash(body.password, 5);\n        let user = new User({\n          username: body.username,\n          name: body.name,\n          password: body.password,\n          created: moment().format(\"YYYY-MM-DD HH:mm:ss\"),\n        });\n        let result = await user.save();\n        ctx.bod = {\n          code: 200,\n          data: result,\n          msg: \"注册成功\",\n        };\n      }\n    } else {\n      // veevalidate显示的错误\n      msg.code = [\"验证码已经失效，请重新获取\"];\n    }\n  }\n}\nexport default new LoginController();\n"],"mappings":"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"}},"mtime":1670120519741},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/config/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/config/MailConfig.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _nodemailer = _interopRequireDefault(require(\"nodemailer\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n// async..await is not allowed in global scope, must use a wrapper\nasync function send(sendInfo) {\n  // Generate test SMTP service account from ethereal.email\n  // Only needed if you don't have a real mail account for testing\n  // let testAccount = await nodemailer.createTestAccount();\n\n  // create reusable transporter object using the default SMTP transport\n  let transporter = _nodemailer.default.createTransport({\n    host: \"smtp.qq.com\",\n    port: 587,\n    secure: false,\n    // true for 465, false for other ports\n    auth: {\n      user: \"624973033@qq.com\",\n      // generated ethereal user\n      pass: \"ejjpuhxzlbqpbfjg\" // generated ethereal password\n    }\n  });\n\n  // send mail with defined transport object\n  // let sendInfo = {\n  // code: \"1234\",\n  // expire: \"2022-11-15\",\n  // email: \"624973033@qq.com\",\n  // user: \"ludaohua\",\n  // };\n  let url = \"http://www.imooc.com\";\n  let info = await transporter.sendMail({\n    from: '\"认证邮件\" <624973033@qq.com>',\n    // sender address\n    to: sendInfo.email,\n    // list of receivers\n    subject: sendInfo.user !== \"\" ? `你好开发者,${sendInfo.user}!<慕课网前端全栈实战>注册码` : \"《慕课网前端全栈实战》注册码\",\n    // Subject line\n    text: `您在《慕课网前端全栈实战》课程中注册，您的邀请码是${sendInfo.code},邀请码的过期时间:${sendInfo.expire}`,\n    // plain text body\n    html: `  <div style=\"color:#676767;width:600px;margin:0 auto;padding-bottom: 50px;position:relative;\">\n    <div style=\"height: 60px;\nbackground: #393d49;\nline-height: 60px;\ncolor: #58a36f;\nfont-size: 18px;\npadding-left: 10px;\">\n      Imooc社区-欢迎来到官方社区\n    </div>\n    <div style=\"padding:25px;\">\n      <div>您好，${sendInfo.user}童靴，重置链接有效时间30分钟，请在${sendInfo.expire}之前重置您的密码:</div>\n      <a href=\"${url}\" style=\" padding: 10px 20px;color: #fff;background: #009e94;display:inline-block;margin:15px 0;\">重置密码</a>\n  <div style=\"padding:5px;background:#f2f2f2;\">如果该邮件不是由你本人操作，请勿进行激活！否则你的邮箱将会被他人绑定</div>\n    </div>\n    <div style=\"background: #fafafa;\ncolor: #b4b4b4;\ntext-align: center;\nline-height: 45px;\nheight: 45px;\nposition: absolute;\nleft: 0;\nbottom: 0;\nwidth: 100%;\n      \">系统邮件，请勿直接回复</div>` // html body\n  });\n\n  return `Message sent: %s, ${info.messageId}`;\n  // Message sent: <b658f8ca-6296-ccf4-8306-87d57a0b4321@example.com>\n\n  // Preview only available when sending through an Ethereal account\n  // console.log(\"Preview URL: %s\", nodemailer.getTestMessageUrl(info));\n  // Preview URL: https://ethereal.email/message/WaQKMgKddxQDoou...\n}\n\n// main().catch(console.error);\nvar _default = send;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzZW5kIiwic2VuZEluZm8iLCJ0cmFuc3BvcnRlciIsIm5vZGVtYWlsZXIiLCJjcmVhdGVUcmFuc3BvcnQiLCJob3N0IiwicG9ydCIsInNlY3VyZSIsImF1dGgiLCJ1c2VyIiwicGFzcyIsInVybCIsImluZm8iLCJzZW5kTWFpbCIsImZyb20iLCJ0byIsImVtYWlsIiwic3ViamVjdCIsInRleHQiLCJjb2RlIiwiZXhwaXJlIiwiaHRtbCIsIm1lc3NhZ2VJZCJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2x1Y2t5L0Rlc2t0b3AvZnJvbnQvZGFxaWFuZHVhbi9hcGkvc3JjL2NvbmZpZy8iLCJzb3VyY2VzIjpbIk1haWxDb25maWcuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG5vZGVtYWlsZXIgZnJvbSBcIm5vZGVtYWlsZXJcIjtcblxuLy8gYXN5bmMuLmF3YWl0IGlzIG5vdCBhbGxvd2VkIGluIGdsb2JhbCBzY29wZSwgbXVzdCB1c2UgYSB3cmFwcGVyXG5hc3luYyBmdW5jdGlvbiBzZW5kKHNlbmRJbmZvKSB7XG4gIC8vIEdlbmVyYXRlIHRlc3QgU01UUCBzZXJ2aWNlIGFjY291bnQgZnJvbSBldGhlcmVhbC5lbWFpbFxuICAvLyBPbmx5IG5lZWRlZCBpZiB5b3UgZG9uJ3QgaGF2ZSBhIHJlYWwgbWFpbCBhY2NvdW50IGZvciB0ZXN0aW5nXG4gIC8vIGxldCB0ZXN0QWNjb3VudCA9IGF3YWl0IG5vZGVtYWlsZXIuY3JlYXRlVGVzdEFjY291bnQoKTtcblxuICAvLyBjcmVhdGUgcmV1c2FibGUgdHJhbnNwb3J0ZXIgb2JqZWN0IHVzaW5nIHRoZSBkZWZhdWx0IFNNVFAgdHJhbnNwb3J0XG4gIGxldCB0cmFuc3BvcnRlciA9IG5vZGVtYWlsZXIuY3JlYXRlVHJhbnNwb3J0KHtcbiAgICBob3N0OiBcInNtdHAucXEuY29tXCIsXG4gICAgcG9ydDogNTg3LFxuICAgIHNlY3VyZTogZmFsc2UsIC8vIHRydWUgZm9yIDQ2NSwgZmFsc2UgZm9yIG90aGVyIHBvcnRzXG4gICAgYXV0aDoge1xuICAgICAgdXNlcjogXCI2MjQ5NzMwMzNAcXEuY29tXCIsIC8vIGdlbmVyYXRlZCBldGhlcmVhbCB1c2VyXG4gICAgICBwYXNzOiBcImVqanB1aHh6bGJxcGJmamdcIiwgLy8gZ2VuZXJhdGVkIGV0aGVyZWFsIHBhc3N3b3JkXG4gICAgfSxcbiAgfSk7XG5cbiAgLy8gc2VuZCBtYWlsIHdpdGggZGVmaW5lZCB0cmFuc3BvcnQgb2JqZWN0XG4gIC8vIGxldCBzZW5kSW5mbyA9IHtcbiAgLy8gY29kZTogXCIxMjM0XCIsXG4gIC8vIGV4cGlyZTogXCIyMDIyLTExLTE1XCIsXG4gIC8vIGVtYWlsOiBcIjYyNDk3MzAzM0BxcS5jb21cIixcbiAgLy8gdXNlcjogXCJsdWRhb2h1YVwiLFxuICAvLyB9O1xuICBsZXQgdXJsID0gXCJodHRwOi8vd3d3Lmltb29jLmNvbVwiO1xuICBsZXQgaW5mbyA9IGF3YWl0IHRyYW5zcG9ydGVyLnNlbmRNYWlsKHtcbiAgICBmcm9tOiAnXCLorqTor4Hpgq7ku7ZcIiA8NjI0OTczMDMzQHFxLmNvbT4nLCAvLyBzZW5kZXIgYWRkcmVzc1xuICAgIHRvOiBzZW5kSW5mby5lbWFpbCwgLy8gbGlzdCBvZiByZWNlaXZlcnNcbiAgICBzdWJqZWN0OlxuICAgICAgc2VuZEluZm8udXNlciAhPT0gXCJcIlxuICAgICAgICA/IGDkvaDlpb3lvIDlj5HogIUsJHtzZW5kSW5mby51c2VyfSE85oWV6K++572R5YmN56uv5YWo5qCI5a6e5oiYPuazqOWGjOeggWBcbiAgICAgICAgOiBcIuOAiuaFleivvue9keWJjeerr+WFqOagiOWunuaImOOAi+azqOWGjOeggVwiLCAvLyBTdWJqZWN0IGxpbmVcbiAgICB0ZXh0OiBg5oKo5Zyo44CK5oWV6K++572R5YmN56uv5YWo5qCI5a6e5oiY44CL6K++56iL5Lit5rOo5YaM77yM5oKo55qE6YKA6K+356CB5pivJHtzZW5kSW5mby5jb2RlfSzpgoDor7fnoIHnmoTov4fmnJ/ml7bpl7Q6JHtzZW5kSW5mby5leHBpcmV9YCwgLy8gcGxhaW4gdGV4dCBib2R5XG4gICAgaHRtbDogYCAgPGRpdiBzdHlsZT1cImNvbG9yOiM2NzY3Njc7d2lkdGg6NjAwcHg7bWFyZ2luOjAgYXV0bztwYWRkaW5nLWJvdHRvbTogNTBweDtwb3NpdGlvbjpyZWxhdGl2ZTtcIj5cbiAgICA8ZGl2IHN0eWxlPVwiaGVpZ2h0OiA2MHB4O1xuYmFja2dyb3VuZDogIzM5M2Q0OTtcbmxpbmUtaGVpZ2h0OiA2MHB4O1xuY29sb3I6ICM1OGEzNmY7XG5mb250LXNpemU6IDE4cHg7XG5wYWRkaW5nLWxlZnQ6IDEwcHg7XCI+XG4gICAgICBJbW9vY+ekvuWMui3mrKLov47mnaXliLDlrpjmlrnnpL7ljLpcbiAgICA8L2Rpdj5cbiAgICA8ZGl2IHN0eWxlPVwicGFkZGluZzoyNXB4O1wiPlxuICAgICAgPGRpdj7mgqjlpb3vvIwke3NlbmRJbmZvLnVzZXJ956ul6Z2077yM6YeN572u6ZO+5o6l5pyJ5pWI5pe26Ze0MzDliIbpkp/vvIzor7flnKgke3NlbmRJbmZvLmV4cGlyZX3kuYvliY3ph43nva7mgqjnmoTlr4bnoIE6PC9kaXY+XG4gICAgICA8YSBocmVmPVwiJHt1cmx9XCIgc3R5bGU9XCIgcGFkZGluZzogMTBweCAyMHB4O2NvbG9yOiAjZmZmO2JhY2tncm91bmQ6ICMwMDllOTQ7ZGlzcGxheTppbmxpbmUtYmxvY2s7bWFyZ2luOjE1cHggMDtcIj7ph43nva7lr4bnoIE8L2E+XG4gIDxkaXYgc3R5bGU9XCJwYWRkaW5nOjVweDtiYWNrZ3JvdW5kOiNmMmYyZjI7XCI+5aaC5p6c6K+l6YKu5Lu25LiN5piv55Sx5L2g5pys5Lq65pON5L2c77yM6K+35Yu/6L+b6KGM5r+A5rS777yB5ZCm5YiZ5L2g55qE6YKu566x5bCG5Lya6KKr5LuW5Lq657uR5a6aPC9kaXY+XG4gICAgPC9kaXY+XG4gICAgPGRpdiBzdHlsZT1cImJhY2tncm91bmQ6ICNmYWZhZmE7XG5jb2xvcjogI2I0YjRiNDtcbnRleHQtYWxpZ246IGNlbnRlcjtcbmxpbmUtaGVpZ2h0OiA0NXB4O1xuaGVpZ2h0OiA0NXB4O1xucG9zaXRpb246IGFic29sdXRlO1xubGVmdDogMDtcbmJvdHRvbTogMDtcbndpZHRoOiAxMDAlO1xuICAgICAgXCI+57O757uf6YKu5Lu277yM6K+35Yu/55u05o6l5Zue5aSNPC9kaXY+YCwgLy8gaHRtbCBib2R5XG4gIH0pO1xuXG4gIHJldHVybiBgTWVzc2FnZSBzZW50OiAlcywgJHtpbmZvLm1lc3NhZ2VJZH1gO1xuICAvLyBNZXNzYWdlIHNlbnQ6IDxiNjU4ZjhjYS02Mjk2LWNjZjQtODMwNi04N2Q1N2EwYjQzMjFAZXhhbXBsZS5jb20+XG5cbiAgLy8gUHJldmlldyBvbmx5IGF2YWlsYWJsZSB3aGVuIHNlbmRpbmcgdGhyb3VnaCBhbiBFdGhlcmVhbCBhY2NvdW50XG4gIC8vIGNvbnNvbGUubG9nKFwiUHJldmlldyBVUkw6ICVzXCIsIG5vZGVtYWlsZXIuZ2V0VGVzdE1lc3NhZ2VVcmwoaW5mbykpO1xuICAvLyBQcmV2aWV3IFVSTDogaHR0cHM6Ly9ldGhlcmVhbC5lbWFpbC9tZXNzYWdlL1dhUUtNZ0tkZHhRRG9vdS4uLlxufVxuXG4vLyBtYWluKCkuY2F0Y2goY29uc29sZS5lcnJvcik7XG5leHBvcnQgZGVmYXVsdCBzZW5kO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUFvQztBQUVwQztBQUNBLGVBQWVBLElBQUksQ0FBQ0MsUUFBUSxFQUFFO0VBQzVCO0VBQ0E7RUFDQTs7RUFFQTtFQUNBLElBQUlDLFdBQVcsR0FBR0MsbUJBQVUsQ0FBQ0MsZUFBZSxDQUFDO0lBQzNDQyxJQUFJLEVBQUUsYUFBYTtJQUNuQkMsSUFBSSxFQUFFLEdBQUc7SUFDVEMsTUFBTSxFQUFFLEtBQUs7SUFBRTtJQUNmQyxJQUFJLEVBQUU7TUFDSkMsSUFBSSxFQUFFLGtCQUFrQjtNQUFFO01BQzFCQyxJQUFJLEVBQUUsa0JBQWtCLENBQUU7SUFDNUI7RUFDRixDQUFDLENBQUM7O0VBRUY7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQSxJQUFJQyxHQUFHLEdBQUcsc0JBQXNCO0VBQ2hDLElBQUlDLElBQUksR0FBRyxNQUFNVixXQUFXLENBQUNXLFFBQVEsQ0FBQztJQUNwQ0MsSUFBSSxFQUFFLDJCQUEyQjtJQUFFO0lBQ25DQyxFQUFFLEVBQUVkLFFBQVEsQ0FBQ2UsS0FBSztJQUFFO0lBQ3BCQyxPQUFPLEVBQ0xoQixRQUFRLENBQUNRLElBQUksS0FBSyxFQUFFLEdBQ2YsU0FBUVIsUUFBUSxDQUFDUSxJQUFLLGlCQUFnQixHQUN2QyxnQkFBZ0I7SUFBRTtJQUN4QlMsSUFBSSxFQUFHLDRCQUEyQmpCLFFBQVEsQ0FBQ2tCLElBQUssYUFBWWxCLFFBQVEsQ0FBQ21CLE1BQU8sRUFBQztJQUFFO0lBQy9FQyxJQUFJLEVBQUc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0JwQixRQUFRLENBQUNRLElBQUsscUJBQW9CUixRQUFRLENBQUNtQixNQUFPO0FBQ2xFLGlCQUFpQlQsR0FBSTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLENBQUU7RUFDMUIsQ0FBQyxDQUFDOztFQUVGLE9BQVEscUJBQW9CQyxJQUFJLENBQUNVLFNBQVUsRUFBQztFQUM1Qzs7RUFFQTtFQUNBO0VBQ0E7QUFDRjs7QUFFQTtBQUFBLGVBQ2V0QixJQUFJO0FBQUEifQ==","map":{"version":3,"names":["send","sendInfo","transporter","nodemailer","createTransport","host","port","secure","auth","user","pass","url","info","sendMail","from","to","email","subject","text","code","expire","html","messageId"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/config/","sources":["MailConfig.js"],"sourcesContent":["import nodemailer from \"nodemailer\";\n\n// async..await is not allowed in global scope, must use a wrapper\nasync function send(sendInfo) {\n  // Generate test SMTP service account from ethereal.email\n  // Only needed if you don't have a real mail account for testing\n  // let testAccount = await nodemailer.createTestAccount();\n\n  // create reusable transporter object using the default SMTP transport\n  let transporter = nodemailer.createTransport({\n    host: \"smtp.qq.com\",\n    port: 587,\n    secure: false, // true for 465, false for other ports\n    auth: {\n      user: \"624973033@qq.com\", // generated ethereal user\n      pass: \"ejjpuhxzlbqpbfjg\", // generated ethereal password\n    },\n  });\n\n  // send mail with defined transport object\n  // let sendInfo = {\n  // code: \"1234\",\n  // expire: \"2022-11-15\",\n  // email: \"624973033@qq.com\",\n  // user: \"ludaohua\",\n  // };\n  let url = \"http://www.imooc.com\";\n  let info = await transporter.sendMail({\n    from: '\"认证邮件\" <624973033@qq.com>', // sender address\n    to: sendInfo.email, // list of receivers\n    subject:\n      sendInfo.user !== \"\"\n        ? `你好开发者,${sendInfo.user}!<慕课网前端全栈实战>注册码`\n        : \"《慕课网前端全栈实战》注册码\", // Subject line\n    text: `您在《慕课网前端全栈实战》课程中注册，您的邀请码是${sendInfo.code},邀请码的过期时间:${sendInfo.expire}`, // plain text body\n    html: `  <div style=\"color:#676767;width:600px;margin:0 auto;padding-bottom: 50px;position:relative;\">\n    <div style=\"height: 60px;\nbackground: #393d49;\nline-height: 60px;\ncolor: #58a36f;\nfont-size: 18px;\npadding-left: 10px;\">\n      Imooc社区-欢迎来到官方社区\n    </div>\n    <div style=\"padding:25px;\">\n      <div>您好，${sendInfo.user}童靴，重置链接有效时间30分钟，请在${sendInfo.expire}之前重置您的密码:</div>\n      <a href=\"${url}\" style=\" padding: 10px 20px;color: #fff;background: #009e94;display:inline-block;margin:15px 0;\">重置密码</a>\n  <div style=\"padding:5px;background:#f2f2f2;\">如果该邮件不是由你本人操作，请勿进行激活！否则你的邮箱将会被他人绑定</div>\n    </div>\n    <div style=\"background: #fafafa;\ncolor: #b4b4b4;\ntext-align: center;\nline-height: 45px;\nheight: 45px;\nposition: absolute;\nleft: 0;\nbottom: 0;\nwidth: 100%;\n      \">系统邮件，请勿直接回复</div>`, // html body\n  });\n\n  return `Message sent: %s, ${info.messageId}`;\n  // Message sent: <b658f8ca-6296-ccf4-8306-87d57a0b4321@example.com>\n\n  // Preview only available when sending through an Ethereal account\n  // console.log(\"Preview URL: %s\", nodemailer.getTestMessageUrl(info));\n  // Preview URL: https://ethereal.email/message/WaQKMgKddxQDoou...\n}\n\n// main().catch(console.error);\nexport default send;\n"],"mappings":";;;;;;AAAA;AAAoC;AAEpC;AACA,eAAeA,IAAI,CAACC,QAAQ,EAAE;EAC5B;EACA;EACA;;EAEA;EACA,IAAIC,WAAW,GAAGC,mBAAU,CAACC,eAAe,CAAC;IAC3CC,IAAI,EAAE,aAAa;IACnBC,IAAI,EAAE,GAAG;IACTC,MAAM,EAAE,KAAK;IAAE;IACfC,IAAI,EAAE;MACJC,IAAI,EAAE,kBAAkB;MAAE;MAC1BC,IAAI,EAAE,kBAAkB,CAAE;IAC5B;EACF,CAAC,CAAC;;EAEF;EACA;EACA;EACA;EACA;EACA;EACA;EACA,IAAIC,GAAG,GAAG,sBAAsB;EAChC,IAAIC,IAAI,GAAG,MAAMV,WAAW,CAACW,QAAQ,CAAC;IACpCC,IAAI,EAAE,2BAA2B;IAAE;IACnCC,EAAE,EAAEd,QAAQ,CAACe,KAAK;IAAE;IACpBC,OAAO,EACLhB,QAAQ,CAACQ,IAAI,KAAK,EAAE,GACf,SAAQR,QAAQ,CAACQ,IAAK,iBAAgB,GACvC,gBAAgB;IAAE;IACxBS,IAAI,EAAG,4BAA2BjB,QAAQ,CAACkB,IAAK,aAAYlB,QAAQ,CAACmB,MAAO,EAAC;IAAE;IAC/EC,IAAI,EAAG;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgBpB,QAAQ,CAACQ,IAAK,qBAAoBR,QAAQ,CAACmB,MAAO;AAClE,iBAAiBT,GAAI;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,CAAE;EAC1B,CAAC,CAAC;;EAEF,OAAQ,qBAAoBC,IAAI,CAACU,SAAU,EAAC;EAC5C;;EAEA;EACA;EACA;AACF;;AAEA;AAAA,eACetB,IAAI;AAAA"}},"mtime":1668425457049},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/common/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/common/Utils.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.checkCode = void 0;\nvar _RedisConfig = require(\"../config/RedisConfig\");\nconst checkCode = async (key, value) => {\n  const redisData = await (0, _RedisConfig.getValue)(key);\n  if (redisData !== null) {\n    if (redisData.toLowerCase() === value.toLowerCase()) {\n      return true;\n    } else {\n      return false;\n    }\n  } else {\n    return false;\n  }\n};\nexports.checkCode = checkCode;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjaGVja0NvZGUiLCJrZXkiLCJ2YWx1ZSIsInJlZGlzRGF0YSIsImdldFZhbHVlIiwidG9Mb3dlckNhc2UiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9sdWNreS9EZXNrdG9wL2Zyb250L2RhcWlhbmR1YW4vYXBpL3NyYy9jb21tb24vIiwic291cmNlcyI6WyJVdGlscy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRWYWx1ZSB9IGZyb20gXCIuLi9jb25maWcvUmVkaXNDb25maWdcIjtcbmNvbnN0IGNoZWNrQ29kZSA9IGFzeW5jIChrZXksIHZhbHVlKSA9PiB7XG4gIGNvbnN0IHJlZGlzRGF0YSA9IGF3YWl0IGdldFZhbHVlKGtleSk7XG4gIGlmIChyZWRpc0RhdGEgIT09IG51bGwpIHtcbiAgICBpZiAocmVkaXNEYXRhLnRvTG93ZXJDYXNlKCkgPT09IHZhbHVlLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufTtcbmV4cG9ydCB7IGNoZWNrQ29kZSB9O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBLE1BQU1BLFNBQVMsR0FBRyxPQUFPQyxHQUFHLEVBQUVDLEtBQUssS0FBSztFQUN0QyxNQUFNQyxTQUFTLEdBQUcsTUFBTSxJQUFBQyxxQkFBUSxFQUFDSCxHQUFHLENBQUM7RUFDckMsSUFBSUUsU0FBUyxLQUFLLElBQUksRUFBRTtJQUN0QixJQUFJQSxTQUFTLENBQUNFLFdBQVcsRUFBRSxLQUFLSCxLQUFLLENBQUNHLFdBQVcsRUFBRSxFQUFFO01BQ25ELE9BQU8sSUFBSTtJQUNiLENBQUMsTUFBTTtNQUNMLE9BQU8sS0FBSztJQUNkO0VBQ0YsQ0FBQyxNQUFNO0lBQ0wsT0FBTyxLQUFLO0VBQ2Q7QUFDRixDQUFDO0FBQUMifQ==","map":{"version":3,"names":["checkCode","key","value","redisData","getValue","toLowerCase"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/common/","sources":["Utils.js"],"sourcesContent":["import { getValue } from \"../config/RedisConfig\";\nconst checkCode = async (key, value) => {\n  const redisData = await getValue(key);\n  if (redisData !== null) {\n    if (redisData.toLowerCase() === value.toLowerCase()) {\n      return true;\n    } else {\n      return false;\n    }\n  } else {\n    return false;\n  }\n};\nexport { checkCode };\n"],"mappings":";;;;;;AAAA;AACA,MAAMA,SAAS,GAAG,OAAOC,GAAG,EAAEC,KAAK,KAAK;EACtC,MAAMC,SAAS,GAAG,MAAM,IAAAC,qBAAQ,EAACH,GAAG,CAAC;EACrC,IAAIE,SAAS,KAAK,IAAI,EAAE;IACtB,IAAIA,SAAS,CAACE,WAAW,EAAE,KAAKH,KAAK,CAACG,WAAW,EAAE,EAAE;MACnD,OAAO,IAAI;IACb,CAAC,MAAM;MACL,OAAO,KAAK;IACd;EACF,CAAC,MAAM;IACL,OAAO,KAAK;EACd;AACF,CAAC;AAAC"}},"mtime":1669975036575},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/model/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/model/User.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = require(\"mongoose\");\nvar _DBHelpler = _interopRequireDefault(require(\"../config/DBHelpler\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst Schema = _DBHelpler.default.Schema;\nconst UserSchema = new Schema({\n  username: {\n    type: String\n  },\n  name: {\n    type: String\n  },\n  password: {\n    type: String\n  }\n});\nconst UserModel = _DBHelpler.default.model(\"users\", UserSchema);\nvar _default = UserModel;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTY2hlbWEiLCJtb25nb29zZSIsIlVzZXJTY2hlbWEiLCJ1c2VybmFtZSIsInR5cGUiLCJTdHJpbmciLCJuYW1lIiwicGFzc3dvcmQiLCJVc2VyTW9kZWwiLCJtb2RlbCJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2x1Y2t5L0Rlc2t0b3AvZnJvbnQvZGFxaWFuZHVhbi9hcGkvc3JjL21vZGVsLyIsInNvdXJjZXMiOlsiVXNlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBtb25nbyB9IGZyb20gXCJtb25nb29zZVwiO1xuaW1wb3J0IG1vbmdvb3NlIGZyb20gXCIuLi9jb25maWcvREJIZWxwbGVyXCI7XG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XG5jb25zdCBVc2VyU2NoZW1hID0gbmV3IFNjaGVtYSh7XG4gIHVzZXJuYW1lOiB7IHR5cGU6IFN0cmluZyB9LFxuICBuYW1lOiB7IHR5cGU6IFN0cmluZyB9LFxuICBwYXNzd29yZDogeyB0eXBlOiBTdHJpbmcgfSxcbn0pO1xuY29uc3QgVXNlck1vZGVsID0gbW9uZ29vc2UubW9kZWwoXCJ1c2Vyc1wiLCBVc2VyU2NoZW1hKTtcbmV4cG9ydCBkZWZhdWx0IFVzZXJNb2RlbDtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUEyQztBQUMzQyxNQUFNQSxNQUFNLEdBQUdDLGtCQUFRLENBQUNELE1BQU07QUFDOUIsTUFBTUUsVUFBVSxHQUFHLElBQUlGLE1BQU0sQ0FBQztFQUM1QkcsUUFBUSxFQUFFO0lBQUVDLElBQUksRUFBRUM7RUFBTyxDQUFDO0VBQzFCQyxJQUFJLEVBQUU7SUFBRUYsSUFBSSxFQUFFQztFQUFPLENBQUM7RUFDdEJFLFFBQVEsRUFBRTtJQUFFSCxJQUFJLEVBQUVDO0VBQU87QUFDM0IsQ0FBQyxDQUFDO0FBQ0YsTUFBTUcsU0FBUyxHQUFHUCxrQkFBUSxDQUFDUSxLQUFLLENBQUMsT0FBTyxFQUFFUCxVQUFVLENBQUM7QUFBQyxlQUN2Q00sU0FBUztBQUFBIn0=","map":{"version":3,"names":["Schema","mongoose","UserSchema","username","type","String","name","password","UserModel","model"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/model/","sources":["User.js"],"sourcesContent":["import { mongo } from \"mongoose\";\nimport mongoose from \"../config/DBHelpler\";\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema({\n  username: { type: String },\n  name: { type: String },\n  password: { type: String },\n});\nconst UserModel = mongoose.model(\"users\", UserSchema);\nexport default UserModel;\n"],"mappings":";;;;;;AAAA;AACA;AAA2C;AAC3C,MAAMA,MAAM,GAAGC,kBAAQ,CAACD,MAAM;AAC9B,MAAME,UAAU,GAAG,IAAIF,MAAM,CAAC;EAC5BG,QAAQ,EAAE;IAAEC,IAAI,EAAEC;EAAO,CAAC;EAC1BC,IAAI,EAAE;IAAEF,IAAI,EAAEC;EAAO,CAAC;EACtBE,QAAQ,EAAE;IAAEH,IAAI,EAAEC;EAAO;AAC3B,CAAC,CAAC;AACF,MAAMG,SAAS,GAAGP,kBAAQ,CAACQ,KAAK,CAAC,OAAO,EAAEP,UAAU,CAAC;AAAC,eACvCM,SAAS;AAAA"}},"mtime":1670120543685},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/config/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/config/DBHelpler.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _index = _interopRequireDefault(require(\"./index\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n// 创建链接\n_mongoose.default.connect(_index.default.DB_URL, {\n  useNewUrlParser: true,\n  useUnifiedTopology: true\n});\n// 链接成功\n_mongoose.default.connection.on(\"connected\", () => {\n  console.log(\"mongoose connection open to \" + _index.default.DB_URL);\n});\n\n// 链接异常\n_mongoose.default.connection.on(\"error\", error => {\n  console.log(\"mongoose connection error \" + error);\n});\n\n// 断开链接\n_mongoose.default.connection.on(\"disconnected\", () => {\n  console.log(\"mongoose connection disconnected\");\n});\nvar _default = _mongoose.default;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsImNvbm5lY3QiLCJjb25maWciLCJEQl9VUkwiLCJ1c2VOZXdVcmxQYXJzZXIiLCJ1c2VVbmlmaWVkVG9wb2xvZ3kiLCJjb25uZWN0aW9uIiwib24iLCJjb25zb2xlIiwibG9nIiwiZXJyb3IiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9sdWNreS9EZXNrdG9wL2Zyb250L2RhcWlhbmR1YW4vYXBpL3NyYy9jb25maWcvIiwic291cmNlcyI6WyJEQkhlbHBsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xuaW1wb3J0IGNvbmZpZyBmcm9tIFwiLi9pbmRleFwiO1xuXG4vLyDliJvlu7rpk77mjqVcbm1vbmdvb3NlLmNvbm5lY3QoY29uZmlnLkRCX1VSTCwge1xuICB1c2VOZXdVcmxQYXJzZXI6IHRydWUsXG4gIHVzZVVuaWZpZWRUb3BvbG9neTogdHJ1ZSxcbn0pO1xuLy8g6ZO+5o6l5oiQ5YqfXG5tb25nb29zZS5jb25uZWN0aW9uLm9uKFwiY29ubmVjdGVkXCIsICgpID0+IHtcbiAgY29uc29sZS5sb2coXCJtb25nb29zZSBjb25uZWN0aW9uIG9wZW4gdG8gXCIgKyBjb25maWcuREJfVVJMKTtcbn0pO1xuXG4vLyDpk77mjqXlvILluLhcbm1vbmdvb3NlLmNvbm5lY3Rpb24ub24oXCJlcnJvclwiLCAoZXJyb3IpID0+IHtcbiAgY29uc29sZS5sb2coXCJtb25nb29zZSBjb25uZWN0aW9uIGVycm9yIFwiICsgZXJyb3IpO1xufSk7XG5cbi8vIOaWreW8gOmTvuaOpVxubW9uZ29vc2UuY29ubmVjdGlvbi5vbihcImRpc2Nvbm5lY3RlZFwiLCAoKSA9PiB7XG4gIGNvbnNvbGUubG9nKFwibW9uZ29vc2UgY29ubmVjdGlvbiBkaXNjb25uZWN0ZWRcIik7XG59KTtcblxuZXhwb3J0IGRlZmF1bHQgbW9uZ29vc2U7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFBNkI7QUFFN0I7QUFDQUEsaUJBQVEsQ0FBQ0MsT0FBTyxDQUFDQyxjQUFNLENBQUNDLE1BQU0sRUFBRTtFQUM5QkMsZUFBZSxFQUFFLElBQUk7RUFDckJDLGtCQUFrQixFQUFFO0FBQ3RCLENBQUMsQ0FBQztBQUNGO0FBQ0FMLGlCQUFRLENBQUNNLFVBQVUsQ0FBQ0MsRUFBRSxDQUFDLFdBQVcsRUFBRSxNQUFNO0VBQ3hDQyxPQUFPLENBQUNDLEdBQUcsQ0FBQyw4QkFBOEIsR0FBR1AsY0FBTSxDQUFDQyxNQUFNLENBQUM7QUFDN0QsQ0FBQyxDQUFDOztBQUVGO0FBQ0FILGlCQUFRLENBQUNNLFVBQVUsQ0FBQ0MsRUFBRSxDQUFDLE9BQU8sRUFBR0csS0FBSyxJQUFLO0VBQ3pDRixPQUFPLENBQUNDLEdBQUcsQ0FBQyw0QkFBNEIsR0FBR0MsS0FBSyxDQUFDO0FBQ25ELENBQUMsQ0FBQzs7QUFFRjtBQUNBVixpQkFBUSxDQUFDTSxVQUFVLENBQUNDLEVBQUUsQ0FBQyxjQUFjLEVBQUUsTUFBTTtFQUMzQ0MsT0FBTyxDQUFDQyxHQUFHLENBQUMsa0NBQWtDLENBQUM7QUFDakQsQ0FBQyxDQUFDO0FBQUMsZUFFWVQsaUJBQVE7QUFBQSJ9","map":{"version":3,"names":["mongoose","connect","config","DB_URL","useNewUrlParser","useUnifiedTopology","connection","on","console","log","error"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/config/","sources":["DBHelpler.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport config from \"./index\";\n\n// 创建链接\nmongoose.connect(config.DB_URL, {\n  useNewUrlParser: true,\n  useUnifiedTopology: true,\n});\n// 链接成功\nmongoose.connection.on(\"connected\", () => {\n  console.log(\"mongoose connection open to \" + config.DB_URL);\n});\n\n// 链接异常\nmongoose.connection.on(\"error\", (error) => {\n  console.log(\"mongoose connection error \" + error);\n});\n\n// 断开链接\nmongoose.connection.on(\"disconnected\", () => {\n  console.log(\"mongoose connection disconnected\");\n});\n\nexport default mongoose;\n"],"mappings":";;;;;;AAAA;AACA;AAA6B;AAE7B;AACAA,iBAAQ,CAACC,OAAO,CAACC,cAAM,CAACC,MAAM,EAAE;EAC9BC,eAAe,EAAE,IAAI;EACrBC,kBAAkB,EAAE;AACtB,CAAC,CAAC;AACF;AACAL,iBAAQ,CAACM,UAAU,CAACC,EAAE,CAAC,WAAW,EAAE,MAAM;EACxCC,OAAO,CAACC,GAAG,CAAC,8BAA8B,GAAGP,cAAM,CAACC,MAAM,CAAC;AAC7D,CAAC,CAAC;;AAEF;AACAH,iBAAQ,CAACM,UAAU,CAACC,EAAE,CAAC,OAAO,EAAGG,KAAK,IAAK;EACzCF,OAAO,CAACC,GAAG,CAAC,4BAA4B,GAAGC,KAAK,CAAC;AACnD,CAAC,CAAC;;AAEF;AACAV,iBAAQ,CAACM,UAAU,CAACC,EAAE,CAAC,cAAc,EAAE,MAAM;EAC3CC,OAAO,CAACC,GAAG,CAAC,kCAAkC,CAAC;AACjD,CAAC,CAAC;AAAC,eAEYT,iBAAQ;AAAA"}},"mtime":1669533968434},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/common/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/common/ErrorHandle.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _default = (ctx, next) => {\n  return next().catch(err => {\n    if (err.status === 401) {\n      ctx.status = 401;\n      ctx.body = {\n        code: 401,\n        msg: \"Protect resource, use Authorization header to get access\\n\"\n      };\n    } else {\n      ctx.status = err.status || 500;\n      ctx.body = {\n        code: 500,\n        msg: process.env.NODE_ENV === \"development\" || \"dev\" ? {\n          stack: err.stack\n        } : err.message\n      };\n    }\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjdHgiLCJuZXh0IiwiY2F0Y2giLCJlcnIiLCJzdGF0dXMiLCJib2R5IiwiY29kZSIsIm1zZyIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsInN0YWNrIiwibWVzc2FnZSJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2x1Y2t5L0Rlc2t0b3AvZnJvbnQvZGFxaWFuZHVhbi9hcGkvc3JjL2NvbW1vbi8iLCJzb3VyY2VzIjpbIkVycm9ySGFuZGxlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IChjdHgsIG5leHQpID0+IHtcbiAgcmV0dXJuIG5leHQoKS5jYXRjaCgoZXJyKSA9PiB7XG4gICAgaWYgKGVyci5zdGF0dXMgPT09IDQwMSkge1xuICAgICAgY3R4LnN0YXR1cyA9IDQwMTtcbiAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICBjb2RlOiA0MDEsXG4gICAgICAgIG1zZzogXCJQcm90ZWN0IHJlc291cmNlLCB1c2UgQXV0aG9yaXphdGlvbiBoZWFkZXIgdG8gZ2V0IGFjY2Vzc1xcblwiLFxuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgY3R4LnN0YXR1cyA9IGVyci5zdGF0dXMgfHwgNTAwO1xuICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgIGNvZGU6IDUwMCxcbiAgICAgICAgbXNnOlxuICAgICAgICAgIHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcImRldmVsb3BtZW50XCIgfHwgXCJkZXZcIlxuICAgICAgICAgICAgPyB7IHN0YWNrOiBlcnIuc3RhY2sgfVxuICAgICAgICAgICAgOiBlcnIubWVzc2FnZSxcbiAgICAgIH07XG4gICAgfVxuICB9KTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztlQUFlLENBQUNBLEdBQUcsRUFBRUMsSUFBSSxLQUFLO0VBQzVCLE9BQU9BLElBQUksRUFBRSxDQUFDQyxLQUFLLENBQUVDLEdBQUcsSUFBSztJQUMzQixJQUFJQSxHQUFHLENBQUNDLE1BQU0sS0FBSyxHQUFHLEVBQUU7TUFDdEJKLEdBQUcsQ0FBQ0ksTUFBTSxHQUFHLEdBQUc7TUFDaEJKLEdBQUcsQ0FBQ0ssSUFBSSxHQUFHO1FBQ1RDLElBQUksRUFBRSxHQUFHO1FBQ1RDLEdBQUcsRUFBRTtNQUNQLENBQUM7SUFDSCxDQUFDLE1BQU07TUFDTFAsR0FBRyxDQUFDSSxNQUFNLEdBQUdELEdBQUcsQ0FBQ0MsTUFBTSxJQUFJLEdBQUc7TUFDOUJKLEdBQUcsQ0FBQ0ssSUFBSSxHQUFHO1FBQ1RDLElBQUksRUFBRSxHQUFHO1FBQ1RDLEdBQUcsRUFDREMsT0FBTyxDQUFDQyxHQUFHLENBQUNDLFFBQVEsS0FBSyxhQUFhLElBQUksS0FBSyxHQUMzQztVQUFFQyxLQUFLLEVBQUVSLEdBQUcsQ0FBQ1E7UUFBTSxDQUFDLEdBQ3BCUixHQUFHLENBQUNTO01BQ1osQ0FBQztJQUNIO0VBQ0YsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUFBIn0=","map":{"version":3,"names":["ctx","next","catch","err","status","body","code","msg","process","env","NODE_ENV","stack","message"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/common/","sources":["ErrorHandle.js"],"sourcesContent":["export default (ctx, next) => {\n  return next().catch((err) => {\n    if (err.status === 401) {\n      ctx.status = 401;\n      ctx.body = {\n        code: 401,\n        msg: \"Protect resource, use Authorization header to get access\\n\",\n      };\n    } else {\n      ctx.status = err.status || 500;\n      ctx.body = {\n        code: 500,\n        msg:\n          process.env.NODE_ENV === \"development\" || \"dev\"\n            ? { stack: err.stack }\n            : err.message,\n      };\n    }\n  });\n};\n"],"mappings":";;;;;;eAAe,CAACA,GAAG,EAAEC,IAAI,KAAK;EAC5B,OAAOA,IAAI,EAAE,CAACC,KAAK,CAAEC,GAAG,IAAK;IAC3B,IAAIA,GAAG,CAACC,MAAM,KAAK,GAAG,EAAE;MACtBJ,GAAG,CAACI,MAAM,GAAG,GAAG;MAChBJ,GAAG,CAACK,IAAI,GAAG;QACTC,IAAI,EAAE,GAAG;QACTC,GAAG,EAAE;MACP,CAAC;IACH,CAAC,MAAM;MACLP,GAAG,CAACI,MAAM,GAAGD,GAAG,CAACC,MAAM,IAAI,GAAG;MAC9BJ,GAAG,CAACK,IAAI,GAAG;QACTC,IAAI,EAAE,GAAG;QACTC,GAAG,EACDC,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,aAAa,IAAI,KAAK,GAC3C;UAAEC,KAAK,EAAER,GAAG,CAACQ;QAAM,CAAC,GACpBR,GAAG,CAACS;MACZ,CAAC;IACH;EACF,CAAC,CAAC;AACJ,CAAC;AAAA"}},"mtime":1669955171043},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/routes/routes.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _koaCombineRouters = _interopRequireDefault(require(\"koa-combine-routers\"));\nvar _publicRouter = _interopRequireDefault(require(\"./publicRouter\"));\nvar _LoginRouter = _interopRequireDefault(require(\"./LoginRouter\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nvar _default = (0, _koaCombineRouters.default)(_publicRouter.default, _LoginRouter.default);\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb21iaW5lUm91dGVzIiwicHVibGljUm91dGVyIiwibG9naW5Sb3V0ZXIiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9sdWNreS9EZXNrdG9wL2Zyb250L2RhcWlhbmR1YW4vYXBpL3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJyb3V0ZXMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNvbWJpbmVSb3V0ZXMgZnJvbSBcImtvYS1jb21iaW5lLXJvdXRlcnNcIjtcbmltcG9ydCBwdWJsaWNSb3V0ZXIgZnJvbSBcIi4vcHVibGljUm91dGVyXCI7XG5pbXBvcnQgbG9naW5Sb3V0ZXIgZnJvbSBcIi4vTG9naW5Sb3V0ZXJcIjtcbmV4cG9ydCBkZWZhdWx0IGNvbWJpbmVSb3V0ZXMocHVibGljUm91dGVyLCBsb2dpblJvdXRlcik7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUF3QztBQUFBLGVBQ3pCLElBQUFBLDBCQUFhLEVBQUNDLHFCQUFZLEVBQUVDLG9CQUFXLENBQUM7QUFBQSJ9","map":{"version":3,"names":["combineRoutes","publicRouter","loginRouter"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/routes/","sources":["routes.js"],"sourcesContent":["import combineRoutes from \"koa-combine-routers\";\nimport publicRouter from \"./publicRouter\";\nimport loginRouter from \"./LoginRouter\";\nexport default combineRoutes(publicRouter, loginRouter);\n"],"mappings":";;;;;;AAAA;AACA;AACA;AAAwC;AAAA,eACzB,IAAAA,0BAAa,EAACC,qBAAY,EAAEC,oBAAW,CAAC;AAAA"}},"mtime":1668423460524},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/routes/publicRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _koaRouter = _interopRequireDefault(require(\"koa-router\"));\nvar _PublicController = _interopRequireDefault(require(\"../api/PublicController\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst router = new _koaRouter.default();\nrouter.prefix(\"/public\");\nrouter.get(\"/getCaptcha\", _PublicController.default.getCaptcha);\nvar _default = router;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyb3V0ZXIiLCJSb3V0ZXIiLCJwcmVmaXgiLCJnZXQiLCJwdWJsaWNDb250cm9sbGVyIiwiZ2V0Q2FwdGNoYSJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2x1Y2t5L0Rlc2t0b3AvZnJvbnQvZGFxaWFuZHVhbi9hcGkvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbInB1YmxpY1JvdXRlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUm91dGVyIGZyb20gXCJrb2Etcm91dGVyXCI7XG5pbXBvcnQgcHVibGljQ29udHJvbGxlciBmcm9tIFwiLi4vYXBpL1B1YmxpY0NvbnRyb2xsZXJcIjtcbmNvbnN0IHJvdXRlciA9IG5ldyBSb3V0ZXIoKTtcbnJvdXRlci5wcmVmaXgoXCIvcHVibGljXCIpO1xucm91dGVyLmdldChcIi9nZXRDYXB0Y2hhXCIsIHB1YmxpY0NvbnRyb2xsZXIuZ2V0Q2FwdGNoYSk7XG5leHBvcnQgZGVmYXVsdCByb3V0ZXI7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFBdUQ7QUFDdkQsTUFBTUEsTUFBTSxHQUFHLElBQUlDLGtCQUFNLEVBQUU7QUFDM0JELE1BQU0sQ0FBQ0UsTUFBTSxDQUFDLFNBQVMsQ0FBQztBQUN4QkYsTUFBTSxDQUFDRyxHQUFHLENBQUMsYUFBYSxFQUFFQyx5QkFBZ0IsQ0FBQ0MsVUFBVSxDQUFDO0FBQUMsZUFDeENMLE1BQU07QUFBQSJ9","map":{"version":3,"names":["router","Router","prefix","get","publicController","getCaptcha"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/routes/","sources":["publicRouter.js"],"sourcesContent":["import Router from \"koa-router\";\nimport publicController from \"../api/PublicController\";\nconst router = new Router();\nrouter.prefix(\"/public\");\nrouter.get(\"/getCaptcha\", publicController.getCaptcha);\nexport default router;\n"],"mappings":";;;;;;AAAA;AACA;AAAuD;AACvD,MAAMA,MAAM,GAAG,IAAIC,kBAAM,EAAE;AAC3BD,MAAM,CAACE,MAAM,CAAC,SAAS,CAAC;AACxBF,MAAM,CAACG,GAAG,CAAC,aAAa,EAAEC,yBAAgB,CAACC,UAAU,CAAC;AAAC,eACxCL,MAAM;AAAA"}},"mtime":1669787125390},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/api/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/api/PublicController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _svgCaptcha = _interopRequireDefault(require(\"svg-captcha\"));\nvar _RedisConfig = require(\"../config/RedisConfig\");\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nclass PublicController {\n  constructor() {}\n  async getCaptcha(ctx) {\n    const body = ctx.request.query;\n    const newCaptcha = _svgCaptcha.default.create({\n      size: 4,\n      ignoreChars: \"0o1i\",\n      color: true,\n      noise: Math.floor(Math.random() * 5),\n      height: 38,\n      width: 150\n    });\n    // 保存图片验证码数据，设置超时时间单位是秒\n    //设置图片验证码超时十分钟\n    (0, _RedisConfig.setValue)(body.sid, newCaptcha.text, 10 * 60);\n    ctx.body = {\n      code: 200,\n      data: newCaptcha.data\n    };\n  }\n}\nvar _default = new PublicController();\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQdWJsaWNDb250cm9sbGVyIiwiY29uc3RydWN0b3IiLCJnZXRDYXB0Y2hhIiwiY3R4IiwiYm9keSIsInJlcXVlc3QiLCJxdWVyeSIsIm5ld0NhcHRjaGEiLCJzdmdDYXB0Y2hhIiwiY3JlYXRlIiwic2l6ZSIsImlnbm9yZUNoYXJzIiwiY29sb3IiLCJub2lzZSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImhlaWdodCIsIndpZHRoIiwic2V0VmFsdWUiLCJzaWQiLCJ0ZXh0IiwiY29kZSIsImRhdGEiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9sdWNreS9EZXNrdG9wL2Zyb250L2RhcWlhbmR1YW4vYXBpL3NyYy9hcGkvIiwic291cmNlcyI6WyJQdWJsaWNDb250cm9sbGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBzdmdDYXB0Y2hhIGZyb20gXCJzdmctY2FwdGNoYVwiO1xuaW1wb3J0IHsgZ2V0VmFsdWUsIHNldFZhbHVlIH0gZnJvbSBcIi4uL2NvbmZpZy9SZWRpc0NvbmZpZ1wiO1xuY2xhc3MgUHVibGljQ29udHJvbGxlciB7XG4gIGNvbnN0cnVjdG9yKCkge31cbiAgYXN5bmMgZ2V0Q2FwdGNoYShjdHgpIHtcbiAgICBjb25zdCBib2R5ID0gY3R4LnJlcXVlc3QucXVlcnk7XG4gICAgY29uc3QgbmV3Q2FwdGNoYSA9IHN2Z0NhcHRjaGEuY3JlYXRlKHtcbiAgICAgIHNpemU6IDQsXG4gICAgICBpZ25vcmVDaGFyczogXCIwbzFpXCIsXG4gICAgICBjb2xvcjogdHJ1ZSxcbiAgICAgIG5vaXNlOiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA1KSxcbiAgICAgIGhlaWdodDogMzgsXG4gICAgICB3aWR0aDogMTUwLFxuICAgIH0pO1xuICAgIC8vIOS/neWtmOWbvueJh+mqjOivgeeggeaVsOaNru+8jOiuvue9rui2heaXtuaXtumXtOWNleS9jeaYr+enklxuICAgIC8v6K6+572u5Zu+54mH6aqM6K+B56CB6LaF5pe25Y2B5YiG6ZKfXG4gICAgc2V0VmFsdWUoYm9keS5zaWQsIG5ld0NhcHRjaGEudGV4dCwgMTAgKiA2MCk7XG5cbiAgICBjdHguYm9keSA9IHtcbiAgICAgIGNvZGU6IDIwMCxcbiAgICAgIGRhdGE6IG5ld0NhcHRjaGEuZGF0YSxcbiAgICB9O1xuICB9XG59XG5leHBvcnQgZGVmYXVsdCBuZXcgUHVibGljQ29udHJvbGxlcigpO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBO0FBQTJEO0FBQzNELE1BQU1BLGdCQUFnQixDQUFDO0VBQ3JCQyxXQUFXLEdBQUcsQ0FBQztFQUNmLE1BQU1DLFVBQVUsQ0FBQ0MsR0FBRyxFQUFFO0lBQ3BCLE1BQU1DLElBQUksR0FBR0QsR0FBRyxDQUFDRSxPQUFPLENBQUNDLEtBQUs7SUFDOUIsTUFBTUMsVUFBVSxHQUFHQyxtQkFBVSxDQUFDQyxNQUFNLENBQUM7TUFDbkNDLElBQUksRUFBRSxDQUFDO01BQ1BDLFdBQVcsRUFBRSxNQUFNO01BQ25CQyxLQUFLLEVBQUUsSUFBSTtNQUNYQyxLQUFLLEVBQUVDLElBQUksQ0FBQ0MsS0FBSyxDQUFDRCxJQUFJLENBQUNFLE1BQU0sRUFBRSxHQUFHLENBQUMsQ0FBQztNQUNwQ0MsTUFBTSxFQUFFLEVBQUU7TUFDVkMsS0FBSyxFQUFFO0lBQ1QsQ0FBQyxDQUFDO0lBQ0Y7SUFDQTtJQUNBLElBQUFDLHFCQUFRLEVBQUNmLElBQUksQ0FBQ2dCLEdBQUcsRUFBRWIsVUFBVSxDQUFDYyxJQUFJLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQztJQUU1Q2xCLEdBQUcsQ0FBQ0MsSUFBSSxHQUFHO01BQ1RrQixJQUFJLEVBQUUsR0FBRztNQUNUQyxJQUFJLEVBQUVoQixVQUFVLENBQUNnQjtJQUNuQixDQUFDO0VBQ0g7QUFDRjtBQUFDLGVBQ2MsSUFBSXZCLGdCQUFnQixFQUFFO0FBQUEifQ==","map":{"version":3,"names":["PublicController","constructor","getCaptcha","ctx","body","request","query","newCaptcha","svgCaptcha","create","size","ignoreChars","color","noise","Math","floor","random","height","width","setValue","sid","text","code","data"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/api/","sources":["PublicController.js"],"sourcesContent":["import svgCaptcha from \"svg-captcha\";\nimport { getValue, setValue } from \"../config/RedisConfig\";\nclass PublicController {\n  constructor() {}\n  async getCaptcha(ctx) {\n    const body = ctx.request.query;\n    const newCaptcha = svgCaptcha.create({\n      size: 4,\n      ignoreChars: \"0o1i\",\n      color: true,\n      noise: Math.floor(Math.random() * 5),\n      height: 38,\n      width: 150,\n    });\n    // 保存图片验证码数据，设置超时时间单位是秒\n    //设置图片验证码超时十分钟\n    setValue(body.sid, newCaptcha.text, 10 * 60);\n\n    ctx.body = {\n      code: 200,\n      data: newCaptcha.data,\n    };\n  }\n}\nexport default new PublicController();\n"],"mappings":";;;;;;AAAA;AACA;AAA2D;AAC3D,MAAMA,gBAAgB,CAAC;EACrBC,WAAW,GAAG,CAAC;EACf,MAAMC,UAAU,CAACC,GAAG,EAAE;IACpB,MAAMC,IAAI,GAAGD,GAAG,CAACE,OAAO,CAACC,KAAK;IAC9B,MAAMC,UAAU,GAAGC,mBAAU,CAACC,MAAM,CAAC;MACnCC,IAAI,EAAE,CAAC;MACPC,WAAW,EAAE,MAAM;MACnBC,KAAK,EAAE,IAAI;MACXC,KAAK,EAAEC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,EAAE,GAAG,CAAC,CAAC;MACpCC,MAAM,EAAE,EAAE;MACVC,KAAK,EAAE;IACT,CAAC,CAAC;IACF;IACA;IACA,IAAAC,qBAAQ,EAACf,IAAI,CAACgB,GAAG,EAAEb,UAAU,CAACc,IAAI,EAAE,EAAE,GAAG,EAAE,CAAC;IAE5ClB,GAAG,CAACC,IAAI,GAAG;MACTkB,IAAI,EAAE,GAAG;MACTC,IAAI,EAAEhB,UAAU,CAACgB;IACnB,CAAC;EACH;AACF;AAAC,eACc,IAAIvB,gBAAgB,EAAE;AAAA"}},"mtime":1669954879568},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/config/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/config/RedisConfig.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.setValue = exports.getValue = exports.getHValue = exports.delValue = exports.client = void 0;\nvar _redis = _interopRequireDefault(require(\"redis\"));\nvar _bluebird = require(\"bluebird\");\nvar _index = _interopRequireDefault(require(\"./index\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst options = {\n  host: _index.default.REDIS.host,\n  port: _index.default.REDIS.port,\n  password: _index.default.REDIS.password,\n  detect_buffers: true,\n  retry_strategy: function (options) {\n    if (options.error.code === \"ECONNREFUSED\") {\n      // End reconnecting on a specific error and flush all commands with a individual error\n      return new Error(\"The server refused the connection\");\n    }\n    if (options.total_retry_time > 1000 * 60 * 60) {\n      // End reconnecting after a specific timeout and flush all commands with a individual error\n      return new Error(\"Retry time exhausted\");\n    }\n    if (options.times_connected > 10) {\n      // End reconnecting with built in error\n      return undefined;\n    }\n    // reconnect after\n    return Math.max(options.attempt * 100, 3000);\n  }\n};\n\n// const client = redis.createClient(options);\nconst client = (0, _bluebird.promisifyAll)(_redis.default.createClient(options));\nexports.client = client;\nclient.on(\"error\", err => {\n  console.log(\"Redis client error\" + err);\n});\nconst setValue = (key, value, time) => {\n  if (typeof value === \"undefined\" || value == null || value === \"\") {\n    return;\n  }\n  if (typeof value === \"string\") {\n    if (typeof time !== \"undefine\") {\n      client.set(key, value, \"EX\", time);\n    } else {\n      client.set(key, value);\n    }\n  } else if (typeof value === \"object\") {\n    Object.keys(value).forEach(item => {\n      client.hset(key, item, value[item], _redis.default.print);\n    });\n  }\n};\n\n// const { promisify } = require(\"util\");\n// const getAsync = promisify(client.get).bind(client);\nexports.setValue = setValue;\nconst getValue = key => {\n  return client.getAsync(key);\n};\nexports.getValue = getValue;\nconst getHValue = key => {\n  //v8 promisify method use util, must node>8\n  // return promisify(client.hgetall).bind(client)(key);\n  //bluebird async\n  return client.hgetallAsync(key);\n};\nexports.getHValue = getHValue;\nconst delValue = key => {\n  return client.del(key, (err, res) => {\n    if (res == 1) {\n      console.log(\"delete success\");\n    } else {\n      console.log(\"delete redis key is fail\");\n    }\n  });\n};\nexports.delValue = delValue;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJvcHRpb25zIiwiaG9zdCIsImNvbmZpZyIsIlJFRElTIiwicG9ydCIsInBhc3N3b3JkIiwiZGV0ZWN0X2J1ZmZlcnMiLCJyZXRyeV9zdHJhdGVneSIsImVycm9yIiwiY29kZSIsIkVycm9yIiwidG90YWxfcmV0cnlfdGltZSIsInRpbWVzX2Nvbm5lY3RlZCIsInVuZGVmaW5lZCIsIk1hdGgiLCJtYXgiLCJhdHRlbXB0IiwiY2xpZW50IiwicHJvbWlzaWZ5QWxsIiwicmVkaXMiLCJjcmVhdGVDbGllbnQiLCJvbiIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJzZXRWYWx1ZSIsImtleSIsInZhbHVlIiwidGltZSIsInNldCIsIk9iamVjdCIsImtleXMiLCJmb3JFYWNoIiwiaXRlbSIsImhzZXQiLCJwcmludCIsImdldFZhbHVlIiwiZ2V0QXN5bmMiLCJnZXRIVmFsdWUiLCJoZ2V0YWxsQXN5bmMiLCJkZWxWYWx1ZSIsImRlbCIsInJlcyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2x1Y2t5L0Rlc2t0b3AvZnJvbnQvZGFxaWFuZHVhbi9hcGkvc3JjL2NvbmZpZy8iLCJzb3VyY2VzIjpbIlJlZGlzQ29uZmlnLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCByZWRpcyBmcm9tIFwicmVkaXNcIjtcbmltcG9ydCB7IHByb21pc2lmeUFsbCB9IGZyb20gXCJibHVlYmlyZFwiO1xuaW1wb3J0IGNvbmZpZyBmcm9tIFwiLi9pbmRleFwiO1xuY29uc3Qgb3B0aW9ucyA9IHtcbiAgaG9zdDogY29uZmlnLlJFRElTLmhvc3QsXG4gIHBvcnQ6IGNvbmZpZy5SRURJUy5wb3J0LFxuICBwYXNzd29yZDogY29uZmlnLlJFRElTLnBhc3N3b3JkLFxuICBkZXRlY3RfYnVmZmVyczogdHJ1ZSxcbiAgcmV0cnlfc3RyYXRlZ3k6IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgaWYgKG9wdGlvbnMuZXJyb3IuY29kZSA9PT0gXCJFQ09OTlJFRlVTRURcIikge1xuICAgICAgLy8gRW5kIHJlY29ubmVjdGluZyBvbiBhIHNwZWNpZmljIGVycm9yIGFuZCBmbHVzaCBhbGwgY29tbWFuZHMgd2l0aCBhIGluZGl2aWR1YWwgZXJyb3JcbiAgICAgIHJldHVybiBuZXcgRXJyb3IoXCJUaGUgc2VydmVyIHJlZnVzZWQgdGhlIGNvbm5lY3Rpb25cIik7XG4gICAgfVxuICAgIGlmIChvcHRpb25zLnRvdGFsX3JldHJ5X3RpbWUgPiAxMDAwICogNjAgKiA2MCkge1xuICAgICAgLy8gRW5kIHJlY29ubmVjdGluZyBhZnRlciBhIHNwZWNpZmljIHRpbWVvdXQgYW5kIGZsdXNoIGFsbCBjb21tYW5kcyB3aXRoIGEgaW5kaXZpZHVhbCBlcnJvclxuICAgICAgcmV0dXJuIG5ldyBFcnJvcihcIlJldHJ5IHRpbWUgZXhoYXVzdGVkXCIpO1xuICAgIH1cbiAgICBpZiAob3B0aW9ucy50aW1lc19jb25uZWN0ZWQgPiAxMCkge1xuICAgICAgLy8gRW5kIHJlY29ubmVjdGluZyB3aXRoIGJ1aWx0IGluIGVycm9yXG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICAvLyByZWNvbm5lY3QgYWZ0ZXJcbiAgICByZXR1cm4gTWF0aC5tYXgob3B0aW9ucy5hdHRlbXB0ICogMTAwLCAzMDAwKTtcbiAgfSxcbn07XG5cbi8vIGNvbnN0IGNsaWVudCA9IHJlZGlzLmNyZWF0ZUNsaWVudChvcHRpb25zKTtcbmNvbnN0IGNsaWVudCA9IHByb21pc2lmeUFsbChyZWRpcy5jcmVhdGVDbGllbnQob3B0aW9ucykpO1xuY2xpZW50Lm9uKFwiZXJyb3JcIiwgKGVycikgPT4ge1xuICBjb25zb2xlLmxvZyhcIlJlZGlzIGNsaWVudCBlcnJvclwiICsgZXJyKTtcbn0pO1xuY29uc3Qgc2V0VmFsdWUgPSAoa2V5LCB2YWx1ZSwgdGltZSkgPT4ge1xuICBpZiAodHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiIHx8IHZhbHVlID09IG51bGwgfHwgdmFsdWUgPT09IFwiXCIpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgIGlmICh0eXBlb2YgdGltZSAhPT0gXCJ1bmRlZmluZVwiKSB7XG4gICAgICBjbGllbnQuc2V0KGtleSwgdmFsdWUsIFwiRVhcIiwgdGltZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNsaWVudC5zZXQoa2V5LCB2YWx1ZSk7XG4gICAgfVxuICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIikge1xuICAgIE9iamVjdC5rZXlzKHZhbHVlKS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICBjbGllbnQuaHNldChrZXksIGl0ZW0sIHZhbHVlW2l0ZW1dLCByZWRpcy5wcmludCk7XG4gICAgfSk7XG4gIH1cbn07XG5cbi8vIGNvbnN0IHsgcHJvbWlzaWZ5IH0gPSByZXF1aXJlKFwidXRpbFwiKTtcbi8vIGNvbnN0IGdldEFzeW5jID0gcHJvbWlzaWZ5KGNsaWVudC5nZXQpLmJpbmQoY2xpZW50KTtcbmNvbnN0IGdldFZhbHVlID0gKGtleSkgPT4ge1xuICByZXR1cm4gY2xpZW50LmdldEFzeW5jKGtleSk7XG59O1xuXG5jb25zdCBnZXRIVmFsdWUgPSAoa2V5KSA9PiB7XG4gIC8vdjggcHJvbWlzaWZ5IG1ldGhvZCB1c2UgdXRpbCwgbXVzdCBub2RlPjhcbiAgLy8gcmV0dXJuIHByb21pc2lmeShjbGllbnQuaGdldGFsbCkuYmluZChjbGllbnQpKGtleSk7XG4gIC8vYmx1ZWJpcmQgYXN5bmNcbiAgcmV0dXJuIGNsaWVudC5oZ2V0YWxsQXN5bmMoa2V5KTtcbn07XG5cbmNvbnN0IGRlbFZhbHVlID0gKGtleSkgPT4ge1xuICByZXR1cm4gY2xpZW50LmRlbChrZXksIChlcnIsIHJlcykgPT4ge1xuICAgIGlmIChyZXMgPT0gMSkge1xuICAgICAgY29uc29sZS5sb2coXCJkZWxldGUgc3VjY2Vzc1wiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coXCJkZWxldGUgcmVkaXMga2V5IGlzIGZhaWxcIik7XG4gICAgfVxuICB9KTtcbn07XG5leHBvcnQgeyBjbGllbnQsIHNldFZhbHVlLCBnZXRWYWx1ZSwgZ2V0SFZhbHVlLCBkZWxWYWx1ZSB9O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFBNkI7QUFDN0IsTUFBTUEsT0FBTyxHQUFHO0VBQ2RDLElBQUksRUFBRUMsY0FBTSxDQUFDQyxLQUFLLENBQUNGLElBQUk7RUFDdkJHLElBQUksRUFBRUYsY0FBTSxDQUFDQyxLQUFLLENBQUNDLElBQUk7RUFDdkJDLFFBQVEsRUFBRUgsY0FBTSxDQUFDQyxLQUFLLENBQUNFLFFBQVE7RUFDL0JDLGNBQWMsRUFBRSxJQUFJO0VBQ3BCQyxjQUFjLEVBQUUsVUFBVVAsT0FBTyxFQUFFO0lBQ2pDLElBQUlBLE9BQU8sQ0FBQ1EsS0FBSyxDQUFDQyxJQUFJLEtBQUssY0FBYyxFQUFFO01BQ3pDO01BQ0EsT0FBTyxJQUFJQyxLQUFLLENBQUMsbUNBQW1DLENBQUM7SUFDdkQ7SUFDQSxJQUFJVixPQUFPLENBQUNXLGdCQUFnQixHQUFHLElBQUksR0FBRyxFQUFFLEdBQUcsRUFBRSxFQUFFO01BQzdDO01BQ0EsT0FBTyxJQUFJRCxLQUFLLENBQUMsc0JBQXNCLENBQUM7SUFDMUM7SUFDQSxJQUFJVixPQUFPLENBQUNZLGVBQWUsR0FBRyxFQUFFLEVBQUU7TUFDaEM7TUFDQSxPQUFPQyxTQUFTO0lBQ2xCO0lBQ0E7SUFDQSxPQUFPQyxJQUFJLENBQUNDLEdBQUcsQ0FBQ2YsT0FBTyxDQUFDZ0IsT0FBTyxHQUFHLEdBQUcsRUFBRSxJQUFJLENBQUM7RUFDOUM7QUFDRixDQUFDOztBQUVEO0FBQ0EsTUFBTUMsTUFBTSxHQUFHLElBQUFDLHNCQUFZLEVBQUNDLGNBQUssQ0FBQ0MsWUFBWSxDQUFDcEIsT0FBTyxDQUFDLENBQUM7QUFBQztBQUN6RGlCLE1BQU0sQ0FBQ0ksRUFBRSxDQUFDLE9BQU8sRUFBR0MsR0FBRyxJQUFLO0VBQzFCQyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxvQkFBb0IsR0FBR0YsR0FBRyxDQUFDO0FBQ3pDLENBQUMsQ0FBQztBQUNGLE1BQU1HLFFBQVEsR0FBRyxDQUFDQyxHQUFHLEVBQUVDLEtBQUssRUFBRUMsSUFBSSxLQUFLO0VBQ3JDLElBQUksT0FBT0QsS0FBSyxLQUFLLFdBQVcsSUFBSUEsS0FBSyxJQUFJLElBQUksSUFBSUEsS0FBSyxLQUFLLEVBQUUsRUFBRTtJQUNqRTtFQUNGO0VBQ0EsSUFBSSxPQUFPQSxLQUFLLEtBQUssUUFBUSxFQUFFO0lBQzdCLElBQUksT0FBT0MsSUFBSSxLQUFLLFVBQVUsRUFBRTtNQUM5QlgsTUFBTSxDQUFDWSxHQUFHLENBQUNILEdBQUcsRUFBRUMsS0FBSyxFQUFFLElBQUksRUFBRUMsSUFBSSxDQUFDO0lBQ3BDLENBQUMsTUFBTTtNQUNMWCxNQUFNLENBQUNZLEdBQUcsQ0FBQ0gsR0FBRyxFQUFFQyxLQUFLLENBQUM7SUFDeEI7RUFDRixDQUFDLE1BQU0sSUFBSSxPQUFPQSxLQUFLLEtBQUssUUFBUSxFQUFFO0lBQ3BDRyxNQUFNLENBQUNDLElBQUksQ0FBQ0osS0FBSyxDQUFDLENBQUNLLE9BQU8sQ0FBRUMsSUFBSSxJQUFLO01BQ25DaEIsTUFBTSxDQUFDaUIsSUFBSSxDQUFDUixHQUFHLEVBQUVPLElBQUksRUFBRU4sS0FBSyxDQUFDTSxJQUFJLENBQUMsRUFBRWQsY0FBSyxDQUFDZ0IsS0FBSyxDQUFDO0lBQ2xELENBQUMsQ0FBQztFQUNKO0FBQ0YsQ0FBQzs7QUFFRDtBQUNBO0FBQUE7QUFDQSxNQUFNQyxRQUFRLEdBQUlWLEdBQUcsSUFBSztFQUN4QixPQUFPVCxNQUFNLENBQUNvQixRQUFRLENBQUNYLEdBQUcsQ0FBQztBQUM3QixDQUFDO0FBQUM7QUFFRixNQUFNWSxTQUFTLEdBQUlaLEdBQUcsSUFBSztFQUN6QjtFQUNBO0VBQ0E7RUFDQSxPQUFPVCxNQUFNLENBQUNzQixZQUFZLENBQUNiLEdBQUcsQ0FBQztBQUNqQyxDQUFDO0FBQUM7QUFFRixNQUFNYyxRQUFRLEdBQUlkLEdBQUcsSUFBSztFQUN4QixPQUFPVCxNQUFNLENBQUN3QixHQUFHLENBQUNmLEdBQUcsRUFBRSxDQUFDSixHQUFHLEVBQUVvQixHQUFHLEtBQUs7SUFDbkMsSUFBSUEsR0FBRyxJQUFJLENBQUMsRUFBRTtNQUNabkIsT0FBTyxDQUFDQyxHQUFHLENBQUMsZ0JBQWdCLENBQUM7SUFDL0IsQ0FBQyxNQUFNO01BQ0xELE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLDBCQUEwQixDQUFDO0lBQ3pDO0VBQ0YsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUFDIn0=","map":{"version":3,"names":["options","host","config","REDIS","port","password","detect_buffers","retry_strategy","error","code","Error","total_retry_time","times_connected","undefined","Math","max","attempt","client","promisifyAll","redis","createClient","on","err","console","log","setValue","key","value","time","set","Object","keys","forEach","item","hset","print","getValue","getAsync","getHValue","hgetallAsync","delValue","del","res"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/config/","sources":["RedisConfig.js"],"sourcesContent":["import redis from \"redis\";\nimport { promisifyAll } from \"bluebird\";\nimport config from \"./index\";\nconst options = {\n  host: config.REDIS.host,\n  port: config.REDIS.port,\n  password: config.REDIS.password,\n  detect_buffers: true,\n  retry_strategy: function (options) {\n    if (options.error.code === \"ECONNREFUSED\") {\n      // End reconnecting on a specific error and flush all commands with a individual error\n      return new Error(\"The server refused the connection\");\n    }\n    if (options.total_retry_time > 1000 * 60 * 60) {\n      // End reconnecting after a specific timeout and flush all commands with a individual error\n      return new Error(\"Retry time exhausted\");\n    }\n    if (options.times_connected > 10) {\n      // End reconnecting with built in error\n      return undefined;\n    }\n    // reconnect after\n    return Math.max(options.attempt * 100, 3000);\n  },\n};\n\n// const client = redis.createClient(options);\nconst client = promisifyAll(redis.createClient(options));\nclient.on(\"error\", (err) => {\n  console.log(\"Redis client error\" + err);\n});\nconst setValue = (key, value, time) => {\n  if (typeof value === \"undefined\" || value == null || value === \"\") {\n    return;\n  }\n  if (typeof value === \"string\") {\n    if (typeof time !== \"undefine\") {\n      client.set(key, value, \"EX\", time);\n    } else {\n      client.set(key, value);\n    }\n  } else if (typeof value === \"object\") {\n    Object.keys(value).forEach((item) => {\n      client.hset(key, item, value[item], redis.print);\n    });\n  }\n};\n\n// const { promisify } = require(\"util\");\n// const getAsync = promisify(client.get).bind(client);\nconst getValue = (key) => {\n  return client.getAsync(key);\n};\n\nconst getHValue = (key) => {\n  //v8 promisify method use util, must node>8\n  // return promisify(client.hgetall).bind(client)(key);\n  //bluebird async\n  return client.hgetallAsync(key);\n};\n\nconst delValue = (key) => {\n  return client.del(key, (err, res) => {\n    if (res == 1) {\n      console.log(\"delete success\");\n    } else {\n      console.log(\"delete redis key is fail\");\n    }\n  });\n};\nexport { client, setValue, getValue, getHValue, delValue };\n"],"mappings":";;;;;;AAAA;AACA;AACA;AAA6B;AAC7B,MAAMA,OAAO,GAAG;EACdC,IAAI,EAAEC,cAAM,CAACC,KAAK,CAACF,IAAI;EACvBG,IAAI,EAAEF,cAAM,CAACC,KAAK,CAACC,IAAI;EACvBC,QAAQ,EAAEH,cAAM,CAACC,KAAK,CAACE,QAAQ;EAC/BC,cAAc,EAAE,IAAI;EACpBC,cAAc,EAAE,UAAUP,OAAO,EAAE;IACjC,IAAIA,OAAO,CAACQ,KAAK,CAACC,IAAI,KAAK,cAAc,EAAE;MACzC;MACA,OAAO,IAAIC,KAAK,CAAC,mCAAmC,CAAC;IACvD;IACA,IAAIV,OAAO,CAACW,gBAAgB,GAAG,IAAI,GAAG,EAAE,GAAG,EAAE,EAAE;MAC7C;MACA,OAAO,IAAID,KAAK,CAAC,sBAAsB,CAAC;IAC1C;IACA,IAAIV,OAAO,CAACY,eAAe,GAAG,EAAE,EAAE;MAChC;MACA,OAAOC,SAAS;IAClB;IACA;IACA,OAAOC,IAAI,CAACC,GAAG,CAACf,OAAO,CAACgB,OAAO,GAAG,GAAG,EAAE,IAAI,CAAC;EAC9C;AACF,CAAC;;AAED;AACA,MAAMC,MAAM,GAAG,IAAAC,sBAAY,EAACC,cAAK,CAACC,YAAY,CAACpB,OAAO,CAAC,CAAC;AAAC;AACzDiB,MAAM,CAACI,EAAE,CAAC,OAAO,EAAGC,GAAG,IAAK;EAC1BC,OAAO,CAACC,GAAG,CAAC,oBAAoB,GAAGF,GAAG,CAAC;AACzC,CAAC,CAAC;AACF,MAAMG,QAAQ,GAAG,CAACC,GAAG,EAAEC,KAAK,EAAEC,IAAI,KAAK;EACrC,IAAI,OAAOD,KAAK,KAAK,WAAW,IAAIA,KAAK,IAAI,IAAI,IAAIA,KAAK,KAAK,EAAE,EAAE;IACjE;EACF;EACA,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;IAC7B,IAAI,OAAOC,IAAI,KAAK,UAAU,EAAE;MAC9BX,MAAM,CAACY,GAAG,CAACH,GAAG,EAAEC,KAAK,EAAE,IAAI,EAAEC,IAAI,CAAC;IACpC,CAAC,MAAM;MACLX,MAAM,CAACY,GAAG,CAACH,GAAG,EAAEC,KAAK,CAAC;IACxB;EACF,CAAC,MAAM,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;IACpCG,MAAM,CAACC,IAAI,CAACJ,KAAK,CAAC,CAACK,OAAO,CAAEC,IAAI,IAAK;MACnChB,MAAM,CAACiB,IAAI,CAACR,GAAG,EAAEO,IAAI,EAAEN,KAAK,CAACM,IAAI,CAAC,EAAEd,cAAK,CAACgB,KAAK,CAAC;IAClD,CAAC,CAAC;EACJ;AACF,CAAC;;AAED;AACA;AAAA;AACA,MAAMC,QAAQ,GAAIV,GAAG,IAAK;EACxB,OAAOT,MAAM,CAACoB,QAAQ,CAACX,GAAG,CAAC;AAC7B,CAAC;AAAC;AAEF,MAAMY,SAAS,GAAIZ,GAAG,IAAK;EACzB;EACA;EACA;EACA,OAAOT,MAAM,CAACsB,YAAY,CAACb,GAAG,CAAC;AACjC,CAAC;AAAC;AAEF,MAAMc,QAAQ,GAAId,GAAG,IAAK;EACxB,OAAOT,MAAM,CAACwB,GAAG,CAACf,GAAG,EAAE,CAACJ,GAAG,EAAEoB,GAAG,KAAK;IACnC,IAAIA,GAAG,IAAI,CAAC,EAAE;MACZnB,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAC;IAC/B,CAAC,MAAM;MACLD,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC;IACzC;EACF,CAAC,CAAC;AACJ,CAAC;AAAC"}},"mtime":1669775046904},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/config/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/config/index.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nconst DB_URL = \"mongodb://test:123456@8.134.11.242:27017/testdb\";\nconst REDIS = {\n  host: \"8.134.11.242\",\n  port: 15001,\n  password: \"123456\"\n};\nconst JWT_SECRET = \"a&*38QthAKuiRwISGLotgq^3%^$zvA3A6Hfr8MF$jM*dWcwAW&9NGp7*b53!\";\nvar _default = {\n  DB_URL,\n  REDIS,\n  JWT_SECRET\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEQl9VUkwiLCJSRURJUyIsImhvc3QiLCJwb3J0IiwicGFzc3dvcmQiLCJKV1RfU0VDUkVUIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvbHVja3kvRGVza3RvcC9mcm9udC9kYXFpYW5kdWFuL2FwaS9zcmMvY29uZmlnLyIsInNvdXJjZXMiOlsiaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgREJfVVJMID0gXCJtb25nb2RiOi8vdGVzdDoxMjM0NTZAOC4xMzQuMTEuMjQyOjI3MDE3L3Rlc3RkYlwiO1xuY29uc3QgUkVESVMgPSB7XG4gIGhvc3Q6IFwiOC4xMzQuMTEuMjQyXCIsXG4gIHBvcnQ6IDE1MDAxLFxuICBwYXNzd29yZDogXCIxMjM0NTZcIixcbn07XG5jb25zdCBKV1RfU0VDUkVUID1cbiAgXCJhJiozOFF0aEFLdWlSd0lTR0xvdGdxXjMlXiR6dkEzQTZIZnI4TUYkak0qZFdjd0FXJjlOR3A3KmI1MyFcIjtcbmV4cG9ydCBkZWZhdWx0IHtcbiAgREJfVVJMLFxuICBSRURJUyxcbiAgSldUX1NFQ1JFVCxcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLE1BQU1BLE1BQU0sR0FBRyxpREFBaUQ7QUFDaEUsTUFBTUMsS0FBSyxHQUFHO0VBQ1pDLElBQUksRUFBRSxjQUFjO0VBQ3BCQyxJQUFJLEVBQUUsS0FBSztFQUNYQyxRQUFRLEVBQUU7QUFDWixDQUFDO0FBQ0QsTUFBTUMsVUFBVSxHQUNkLDhEQUE4RDtBQUFDLGVBQ2xEO0VBQ2JMLE1BQU07RUFDTkMsS0FBSztFQUNMSTtBQUNGLENBQUM7QUFBQSJ9","map":{"version":3,"names":["DB_URL","REDIS","host","port","password","JWT_SECRET"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/config/","sources":["index.js"],"sourcesContent":["const DB_URL = \"mongodb://test:123456@8.134.11.242:27017/testdb\";\nconst REDIS = {\n  host: \"8.134.11.242\",\n  port: 15001,\n  password: \"123456\",\n};\nconst JWT_SECRET =\n  \"a&*38QthAKuiRwISGLotgq^3%^$zvA3A6Hfr8MF$jM*dWcwAW&9NGp7*b53!\";\nexport default {\n  DB_URL,\n  REDIS,\n  JWT_SECRET,\n};\n"],"mappings":";;;;;;AAAA,MAAMA,MAAM,GAAG,iDAAiD;AAChE,MAAMC,KAAK,GAAG;EACZC,IAAI,EAAE,cAAc;EACpBC,IAAI,EAAE,KAAK;EACXC,QAAQ,EAAE;AACZ,CAAC;AACD,MAAMC,UAAU,GACd,8DAA8D;AAAC,eAClD;EACbL,MAAM;EACNC,KAAK;EACLI;AACF,CAAC;AAAA"}},"mtime":1669852069623},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/routes/LoginRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _koaRouter = _interopRequireDefault(require(\"koa-router\"));\nvar _LoginController = _interopRequireDefault(require(\"../api/LoginController\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst router = new _koaRouter.default();\nrouter.prefix(\"/login\");\nrouter.post(\"/forget\", _LoginController.default.forget);\nrouter.post(\"/login\", _LoginController.default.login);\nrouter.post(\"/reg\", _LoginController.default.reg);\nvar _default = router;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyb3V0ZXIiLCJSb3V0ZXIiLCJwcmVmaXgiLCJwb3N0IiwibG9naW5Db250cm9sbGVyIiwiZm9yZ2V0IiwibG9naW4iLCJyZWciXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9sdWNreS9EZXNrdG9wL2Zyb250L2RhcWlhbmR1YW4vYXBpL3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJMb2dpblJvdXRlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUm91dGVyIGZyb20gXCJrb2Etcm91dGVyXCI7XG5pbXBvcnQgbG9naW5Db250cm9sbGVyIGZyb20gXCIuLi9hcGkvTG9naW5Db250cm9sbGVyXCI7XG5jb25zdCByb3V0ZXIgPSBuZXcgUm91dGVyKCk7XG5yb3V0ZXIucHJlZml4KFwiL2xvZ2luXCIpO1xucm91dGVyLnBvc3QoXCIvZm9yZ2V0XCIsIGxvZ2luQ29udHJvbGxlci5mb3JnZXQpO1xucm91dGVyLnBvc3QoXCIvbG9naW5cIiwgbG9naW5Db250cm9sbGVyLmxvZ2luKTtcbnJvdXRlci5wb3N0KFwiL3JlZ1wiLCBsb2dpbkNvbnRyb2xsZXIucmVnKTtcbmV4cG9ydCBkZWZhdWx0IHJvdXRlcjtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUFxRDtBQUNyRCxNQUFNQSxNQUFNLEdBQUcsSUFBSUMsa0JBQU0sRUFBRTtBQUMzQkQsTUFBTSxDQUFDRSxNQUFNLENBQUMsUUFBUSxDQUFDO0FBQ3ZCRixNQUFNLENBQUNHLElBQUksQ0FBQyxTQUFTLEVBQUVDLHdCQUFlLENBQUNDLE1BQU0sQ0FBQztBQUM5Q0wsTUFBTSxDQUFDRyxJQUFJLENBQUMsUUFBUSxFQUFFQyx3QkFBZSxDQUFDRSxLQUFLLENBQUM7QUFDNUNOLE1BQU0sQ0FBQ0csSUFBSSxDQUFDLE1BQU0sRUFBRUMsd0JBQWUsQ0FBQ0csR0FBRyxDQUFDO0FBQUMsZUFDMUJQLE1BQU07QUFBQSJ9","map":{"version":3,"names":["router","Router","prefix","post","loginController","forget","login","reg"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/routes/","sources":["LoginRouter.js"],"sourcesContent":["import Router from \"koa-router\";\nimport loginController from \"../api/LoginController\";\nconst router = new Router();\nrouter.prefix(\"/login\");\nrouter.post(\"/forget\", loginController.forget);\nrouter.post(\"/login\", loginController.login);\nrouter.post(\"/reg\", loginController.reg);\nexport default router;\n"],"mappings":";;;;;;AAAA;AACA;AAAqD;AACrD,MAAMA,MAAM,GAAG,IAAIC,kBAAM,EAAE;AAC3BD,MAAM,CAACE,MAAM,CAAC,QAAQ,CAAC;AACvBF,MAAM,CAACG,IAAI,CAAC,SAAS,EAAEC,wBAAe,CAACC,MAAM,CAAC;AAC9CL,MAAM,CAACG,IAAI,CAAC,QAAQ,EAAEC,wBAAe,CAACE,KAAK,CAAC;AAC5CN,MAAM,CAACG,IAAI,CAAC,MAAM,EAAEC,wBAAe,CAACG,GAAG,CAAC;AAAC,eAC1BP,MAAM;AAAA"}},"mtime":1670121225648},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/api/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/api/LoginController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _MailConfig = _interopRequireDefault(require(\"../config/MailConfig\"));\nvar _bcrypt = _interopRequireDefault(require(\"bcrypt\"));\nvar _moment = _interopRequireDefault(require(\"moment\"));\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\nvar _config = _interopRequireDefault(require(\"../config\"));\nvar _Utils = require(\"../common/Utils\");\nvar _User = _interopRequireDefault(require(\"../model/User\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nclass LoginController {\n  constructor() {}\n  async forget(ctx) {\n    const {\n      body\n    } = ctx.request;\n    try {\n      //body.username->database->email\n      let result = await (0, _MailConfig.default)({\n        code: \"1234\",\n        expire: (0, _moment.default)().add(30, \"minutes\").format(\"YYYY-MM-DD HH:mm:ss\"),\n        email: body.username,\n        user: \"ludaohua\"\n      });\n      ctx.body = {\n        code: 200,\n        data: result,\n        msg: \"邮件发送成功\"\n      };\n    } catch (e) {\n      console.log(e);\n    }\n  }\n  async login(ctx) {\n    //接受用户的数据\n    //返回token\n    const {\n      body\n    } = ctx.request;\n    let sid = body.sid;\n    let code = body.code;\n    //验证图片验证码的时效性，正确性\n    let result = await (0, _Utils.checkCode)(sid, code);\n    if (result) {\n      //验证用户账号的密码是否正确\n      let checkUserPasswd = false;\n      let user = await _User.default.findOne({\n        username: body.username\n      });\n      if (await _bcrypt.default.compare(body.password, user.password)) {\n        checkUserPasswd = true;\n      }\n      //mongoDB查库\n      if (checkUserPasswd) {\n        let token = _jsonwebtoken.default.sign({\n          _id: \"brian\"\n        }, _config.default.JWT_SECRET, {\n          expiresIn: \"1d\"\n        });\n        ctx.body = {\n          code: 200,\n          token: token\n        };\n      } else {\n        //用户名，密码验证失败，返回提示\n        ctx.body = {\n          code: 404,\n          msg: \"用户名或密码错误\"\n        };\n      }\n    } else {\n      //图片验证码校验失败\n      ctx.body = {\n        code: 401,\n        msg: \"图片验证码不正确，请检查\"\n      };\n    }\n  }\n  async reg(ctx) {\n    // 接收客户端的数据\n    const {\n      body\n    } = ctx.request;\n    // 校验验证码的内容（时效性，有效性\n    let sid = body.sid;\n    let code = body.code;\n    let msg = {};\n    //验证图片验证码的时效性，正确性\n    let result = await (0, _Utils.checkCode)(sid, code);\n    let check = true;\n    if (result) {\n      //查库，看username是否被注册\n      let user1 = await _User.default.findOne({\n        username: body.username\n      });\n      if (user1 !== null && typeof user1.username !== \"undefine\") {\n        msg.username = [\"此邮箱已经注册，可以通过邮箱找回密码\"];\n        check = false;\n      }\n      // 查库，看name是否被注册\n      let user2 = await _User.default.findOne({\n        name: body.name\n      });\n      if (user2 !== null && typeof user2.name !== \"undefine\") {\n        msg.name = [\"此昵称已被注册，请修改\"];\n        check = false;\n      }\n      // 写入数据到数据库\n      if (check) {\n        body.password = await _bcrypt.default.hash(body.password, 5);\n        let user = new _User.default({\n          username: body.username,\n          name: body.name,\n          password: body.password,\n          created: (0, _moment.default)().format(\"YYYY-MM-DD HH:mm:ss\")\n        });\n        let result = await user.save();\n        ctx.body = {\n          code: 200,\n          data: result,\n          msg: \"注册成功\"\n        };\n        return;\n      }\n    } else {\n      // veevalidate显示的错误\n      msg.code = [\"验证码已经失效，请重新获取\"];\n    }\n    ctx.body = {\n      code: 500,\n      msg: msg\n    };\n  }\n}\nvar _default = new LoginController();\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJMb2dpbkNvbnRyb2xsZXIiLCJjb25zdHJ1Y3RvciIsImZvcmdldCIsImN0eCIsImJvZHkiLCJyZXF1ZXN0IiwicmVzdWx0Iiwic2VuZCIsImNvZGUiLCJleHBpcmUiLCJtb21lbnQiLCJhZGQiLCJmb3JtYXQiLCJlbWFpbCIsInVzZXJuYW1lIiwidXNlciIsImRhdGEiLCJtc2ciLCJlIiwiY29uc29sZSIsImxvZyIsImxvZ2luIiwic2lkIiwiY2hlY2tDb2RlIiwiY2hlY2tVc2VyUGFzc3dkIiwiVXNlciIsImZpbmRPbmUiLCJiY3J5cHQiLCJjb21wYXJlIiwicGFzc3dvcmQiLCJ0b2tlbiIsImpzb253ZWJ0b2tlbiIsInNpZ24iLCJfaWQiLCJjb25maWciLCJKV1RfU0VDUkVUIiwiZXhwaXJlc0luIiwicmVnIiwiY2hlY2siLCJ1c2VyMSIsInVzZXIyIiwibmFtZSIsImhhc2giLCJjcmVhdGVkIiwic2F2ZSJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2x1Y2t5L0Rlc2t0b3AvZnJvbnQvZGFxaWFuZHVhbi9hcGkvc3JjL2FwaS8iLCJzb3VyY2VzIjpbIkxvZ2luQ29udHJvbGxlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgc2VuZCBmcm9tIFwiLi4vY29uZmlnL01haWxDb25maWdcIjtcbmltcG9ydCBiY3J5cHQgZnJvbSBcImJjcnlwdFwiO1xuaW1wb3J0IG1vbWVudCBmcm9tIFwibW9tZW50XCI7XG5pbXBvcnQganNvbndlYnRva2VuIGZyb20gXCJqc29ud2VidG9rZW5cIjtcbmltcG9ydCBjb25maWcgZnJvbSBcIi4uL2NvbmZpZ1wiO1xuaW1wb3J0IHsgY2hlY2tDb2RlIH0gZnJvbSBcIi4uL2NvbW1vbi9VdGlsc1wiO1xuaW1wb3J0IFVzZXIgZnJvbSBcIi4uL21vZGVsL1VzZXJcIjtcbmNsYXNzIExvZ2luQ29udHJvbGxlciB7XG4gIGNvbnN0cnVjdG9yKCkge31cbiAgYXN5bmMgZm9yZ2V0KGN0eCkge1xuICAgIGNvbnN0IHsgYm9keSB9ID0gY3R4LnJlcXVlc3Q7XG4gICAgdHJ5IHtcbiAgICAgIC8vYm9keS51c2VybmFtZS0+ZGF0YWJhc2UtPmVtYWlsXG4gICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgc2VuZCh7XG4gICAgICAgIGNvZGU6IFwiMTIzNFwiLFxuICAgICAgICBleHBpcmU6IG1vbWVudCgpLmFkZCgzMCwgXCJtaW51dGVzXCIpLmZvcm1hdChcIllZWVktTU0tREQgSEg6bW06c3NcIiksXG4gICAgICAgIGVtYWlsOiBib2R5LnVzZXJuYW1lLFxuICAgICAgICB1c2VyOiBcImx1ZGFvaHVhXCIsXG4gICAgICB9KTtcbiAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICBjb2RlOiAyMDAsXG4gICAgICAgIGRhdGE6IHJlc3VsdCxcbiAgICAgICAgbXNnOiBcIumCruS7tuWPkemAgeaIkOWKn1wiLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICB9XG4gIH1cbiAgYXN5bmMgbG9naW4oY3R4KSB7XG4gICAgLy/mjqXlj5fnlKjmiLfnmoTmlbDmja5cbiAgICAvL+i/lOWbnnRva2VuXG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdDtcbiAgICBsZXQgc2lkID0gYm9keS5zaWQ7XG4gICAgbGV0IGNvZGUgPSBib2R5LmNvZGU7XG4gICAgLy/pqozor4Hlm77niYfpqozor4HnoIHnmoTml7bmlYjmgKfvvIzmraPnoa7mgKdcbiAgICBsZXQgcmVzdWx0ID0gYXdhaXQgY2hlY2tDb2RlKHNpZCwgY29kZSk7XG4gICAgaWYgKHJlc3VsdCkge1xuICAgICAgLy/pqozor4HnlKjmiLfotKblj7fnmoTlr4bnoIHmmK/lkKbmraPnoa5cbiAgICAgIGxldCBjaGVja1VzZXJQYXNzd2QgPSBmYWxzZTtcbiAgICAgIGxldCB1c2VyID0gYXdhaXQgVXNlci5maW5kT25lKHsgdXNlcm5hbWU6IGJvZHkudXNlcm5hbWUgfSk7XG4gICAgICBpZiAoYXdhaXQgYmNyeXB0LmNvbXBhcmUoYm9keS5wYXNzd29yZCwgdXNlci5wYXNzd29yZCkpIHtcbiAgICAgICAgY2hlY2tVc2VyUGFzc3dkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIC8vbW9uZ29EQuafpeW6k1xuICAgICAgaWYgKGNoZWNrVXNlclBhc3N3ZCkge1xuICAgICAgICBsZXQgdG9rZW4gPSBqc29ud2VidG9rZW4uc2lnbih7IF9pZDogXCJicmlhblwiIH0sIGNvbmZpZy5KV1RfU0VDUkVULCB7XG4gICAgICAgICAgZXhwaXJlc0luOiBcIjFkXCIsXG4gICAgICAgIH0pO1xuICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICBjb2RlOiAyMDAsXG4gICAgICAgICAgdG9rZW46IHRva2VuLFxuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy/nlKjmiLflkI3vvIzlr4bnoIHpqozor4HlpLHotKXvvIzov5Tlm57mj5DnpLpcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgY29kZTogNDA0LFxuICAgICAgICAgIG1zZzogXCLnlKjmiLflkI3miJblr4bnoIHplJnor69cIixcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy/lm77niYfpqozor4HnoIHmoKHpqozlpLHotKVcbiAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICBjb2RlOiA0MDEsXG4gICAgICAgIG1zZzogXCLlm77niYfpqozor4HnoIHkuI3mraPnoa7vvIzor7fmo4Dmn6VcIixcbiAgICAgIH07XG4gICAgfVxuICB9XG4gIGFzeW5jIHJlZyhjdHgpIHtcbiAgICAvLyDmjqXmlLblrqLmiLfnq6/nmoTmlbDmja5cbiAgICBjb25zdCB7IGJvZHkgfSA9IGN0eC5yZXF1ZXN0O1xuICAgIC8vIOagoemqjOmqjOivgeeggeeahOWGheWuue+8iOaXtuaViOaAp++8jOacieaViOaAp1xuICAgIGxldCBzaWQgPSBib2R5LnNpZDtcbiAgICBsZXQgY29kZSA9IGJvZHkuY29kZTtcbiAgICBsZXQgbXNnID0ge307XG4gICAgLy/pqozor4Hlm77niYfpqozor4HnoIHnmoTml7bmlYjmgKfvvIzmraPnoa7mgKdcbiAgICBsZXQgcmVzdWx0ID0gYXdhaXQgY2hlY2tDb2RlKHNpZCwgY29kZSk7XG4gICAgbGV0IGNoZWNrID0gdHJ1ZTtcbiAgICBpZiAocmVzdWx0KSB7XG4gICAgICAvL+afpeW6k++8jOeci3VzZXJuYW1l5piv5ZCm6KKr5rOo5YaMXG4gICAgICBsZXQgdXNlcjEgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyB1c2VybmFtZTogYm9keS51c2VybmFtZSB9KTtcbiAgICAgIGlmICh1c2VyMSAhPT0gbnVsbCAmJiB0eXBlb2YgdXNlcjEudXNlcm5hbWUgIT09IFwidW5kZWZpbmVcIikge1xuICAgICAgICBtc2cudXNlcm5hbWUgPSBbXCLmraTpgq7nrrHlt7Lnu4/ms6jlhozvvIzlj6/ku6XpgJrov4fpgq7nrrHmib7lm57lr4bnoIFcIl07XG4gICAgICAgIGNoZWNrID0gZmFsc2U7XG4gICAgICB9XG4gICAgICAvLyDmn6XlupPvvIznnItuYW1l5piv5ZCm6KKr5rOo5YaMXG4gICAgICBsZXQgdXNlcjIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyBuYW1lOiBib2R5Lm5hbWUgfSk7XG4gICAgICBpZiAodXNlcjIgIT09IG51bGwgJiYgdHlwZW9mIHVzZXIyLm5hbWUgIT09IFwidW5kZWZpbmVcIikge1xuICAgICAgICBtc2cubmFtZSA9IFtcIuatpOaYteensOW3suiiq+azqOWGjO+8jOivt+S/ruaUuVwiXTtcbiAgICAgICAgY2hlY2sgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIC8vIOWGmeWFpeaVsOaNruWIsOaVsOaNruW6k1xuICAgICAgaWYgKGNoZWNrKSB7XG4gICAgICAgIGJvZHkucGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuaGFzaChib2R5LnBhc3N3b3JkLCA1KTtcbiAgICAgICAgbGV0IHVzZXIgPSBuZXcgVXNlcih7XG4gICAgICAgICAgdXNlcm5hbWU6IGJvZHkudXNlcm5hbWUsXG4gICAgICAgICAgbmFtZTogYm9keS5uYW1lLFxuICAgICAgICAgIHBhc3N3b3JkOiBib2R5LnBhc3N3b3JkLFxuICAgICAgICAgIGNyZWF0ZWQ6IG1vbWVudCgpLmZvcm1hdChcIllZWVktTU0tREQgSEg6bW06c3NcIiksXG4gICAgICAgIH0pO1xuICAgICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgdXNlci5zYXZlKCk7XG4gICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgICBkYXRhOiByZXN1bHQsXG4gICAgICAgICAgbXNnOiBcIuazqOWGjOaIkOWKn1wiLFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIHZlZXZhbGlkYXRl5pi+56S655qE6ZSZ6K+vXG4gICAgICBtc2cuY29kZSA9IFtcIumqjOivgeeggeW3sue7j+WkseaViO+8jOivt+mHjeaWsOiOt+WPllwiXTtcbiAgICB9XG4gICAgY3R4LmJvZHkgPSB7XG4gICAgICBjb2RlOiA1MDAsXG4gICAgICBtc2c6IG1zZyxcbiAgICB9O1xuICB9XG59XG5leHBvcnQgZGVmYXVsdCBuZXcgTG9naW5Db250cm9sbGVyKCk7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQWlDO0FBQ2pDLE1BQU1BLGVBQWUsQ0FBQztFQUNwQkMsV0FBVyxHQUFHLENBQUM7RUFDZixNQUFNQyxNQUFNLENBQUNDLEdBQUcsRUFBRTtJQUNoQixNQUFNO01BQUVDO0lBQUssQ0FBQyxHQUFHRCxHQUFHLENBQUNFLE9BQU87SUFDNUIsSUFBSTtNQUNGO01BQ0EsSUFBSUMsTUFBTSxHQUFHLE1BQU0sSUFBQUMsbUJBQUksRUFBQztRQUN0QkMsSUFBSSxFQUFFLE1BQU07UUFDWkMsTUFBTSxFQUFFLElBQUFDLGVBQU0sR0FBRSxDQUFDQyxHQUFHLENBQUMsRUFBRSxFQUFFLFNBQVMsQ0FBQyxDQUFDQyxNQUFNLENBQUMscUJB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","map":{"version":3,"names":["LoginController","constructor","forget","ctx","body","request","result","send","code","expire","moment","add","format","email","username","user","data","msg","e","console","log","login","sid","checkCode","checkUserPasswd","User","findOne","bcrypt","compare","password","token","jsonwebtoken","sign","_id","config","JWT_SECRET","expiresIn","reg","check","user1","user2","name","hash","created","save"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/api/","sources":["LoginController.js"],"sourcesContent":["import send from \"../config/MailConfig\";\nimport bcrypt from \"bcrypt\";\nimport moment from \"moment\";\nimport jsonwebtoken from \"jsonwebtoken\";\nimport config from \"../config\";\nimport { checkCode } from \"../common/Utils\";\nimport User from \"../model/User\";\nclass LoginController {\n  constructor() {}\n  async forget(ctx) {\n    const { body } = ctx.request;\n    try {\n      //body.username->database->email\n      let result = await send({\n        code: \"1234\",\n        expire: moment().add(30, \"minutes\").format(\"YYYY-MM-DD HH:mm:ss\"),\n        email: body.username,\n        user: \"ludaohua\",\n      });\n      ctx.body = {\n        code: 200,\n        data: result,\n        msg: \"邮件发送成功\",\n      };\n    } catch (e) {\n      console.log(e);\n    }\n  }\n  async login(ctx) {\n    //接受用户的数据\n    //返回token\n    const { body } = ctx.request;\n    let sid = body.sid;\n    let code = body.code;\n    //验证图片验证码的时效性，正确性\n    let result = await checkCode(sid, code);\n    if (result) {\n      //验证用户账号的密码是否正确\n      let checkUserPasswd = false;\n      let user = await User.findOne({ username: body.username });\n      if (await bcrypt.compare(body.password, user.password)) {\n        checkUserPasswd = true;\n      }\n      //mongoDB查库\n      if (checkUserPasswd) {\n        let token = jsonwebtoken.sign({ _id: \"brian\" }, config.JWT_SECRET, {\n          expiresIn: \"1d\",\n        });\n        ctx.body = {\n          code: 200,\n          token: token,\n        };\n      } else {\n        //用户名，密码验证失败，返回提示\n        ctx.body = {\n          code: 404,\n          msg: \"用户名或密码错误\",\n        };\n      }\n    } else {\n      //图片验证码校验失败\n      ctx.body = {\n        code: 401,\n        msg: \"图片验证码不正确，请检查\",\n      };\n    }\n  }\n  async reg(ctx) {\n    // 接收客户端的数据\n    const { body } = ctx.request;\n    // 校验验证码的内容（时效性，有效性\n    let sid = body.sid;\n    let code = body.code;\n    let msg = {};\n    //验证图片验证码的时效性，正确性\n    let result = await checkCode(sid, code);\n    let check = true;\n    if (result) {\n      //查库，看username是否被注册\n      let user1 = await User.findOne({ username: body.username });\n      if (user1 !== null && typeof user1.username !== \"undefine\") {\n        msg.username = [\"此邮箱已经注册，可以通过邮箱找回密码\"];\n        check = false;\n      }\n      // 查库，看name是否被注册\n      let user2 = await User.findOne({ name: body.name });\n      if (user2 !== null && typeof user2.name !== \"undefine\") {\n        msg.name = [\"此昵称已被注册，请修改\"];\n        check = false;\n      }\n      // 写入数据到数据库\n      if (check) {\n        body.password = await bcrypt.hash(body.password, 5);\n        let user = new User({\n          username: body.username,\n          name: body.name,\n          password: body.password,\n          created: moment().format(\"YYYY-MM-DD HH:mm:ss\"),\n        });\n        let result = await user.save();\n        ctx.body = {\n          code: 200,\n          data: result,\n          msg: \"注册成功\",\n        };\n        return;\n      }\n    } else {\n      // veevalidate显示的错误\n      msg.code = [\"验证码已经失效，请重新获取\"];\n    }\n    ctx.body = {\n      code: 500,\n      msg: msg,\n    };\n  }\n}\nexport default new LoginController();\n"],"mappings":"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"}},"mtime":1670127592205},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/config/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/config/MailConfig.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _nodemailer = _interopRequireDefault(require(\"nodemailer\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n// async..await is not allowed in global scope, must use a wrapper\nasync function send(sendInfo) {\n  // Generate test SMTP service account from ethereal.email\n  // Only needed if you don't have a real mail account for testing\n  // let testAccount = await nodemailer.createTestAccount();\n\n  // create reusable transporter object using the default SMTP transport\n  let transporter = _nodemailer.default.createTransport({\n    host: \"smtp.qq.com\",\n    port: 587,\n    secure: false,\n    // true for 465, false for other ports\n    auth: {\n      user: \"624973033@qq.com\",\n      // generated ethereal user\n      pass: \"ejjpuhxzlbqpbfjg\" // generated ethereal password\n    }\n  });\n\n  // send mail with defined transport object\n  // let sendInfo = {\n  // code: \"1234\",\n  // expire: \"2022-11-15\",\n  // email: \"624973033@qq.com\",\n  // user: \"ludaohua\",\n  // };\n  let url = \"http://www.imooc.com\";\n  let info = await transporter.sendMail({\n    from: '\"认证邮件\" <624973033@qq.com>',\n    // sender address\n    to: sendInfo.email,\n    // list of receivers\n    subject: sendInfo.user !== \"\" ? `你好开发者,${sendInfo.user}!<慕课网前端全栈实战>注册码` : \"《慕课网前端全栈实战》注册码\",\n    // Subject line\n    text: `您在《慕课网前端全栈实战》课程中注册，您的邀请码是${sendInfo.code},邀请码的过期时间:${sendInfo.expire}`,\n    // plain text body\n    html: `  <div style=\"color:#676767;width:600px;margin:0 auto;padding-bottom: 50px;position:relative;\">\n    <div style=\"height: 60px;\nbackground: #393d49;\nline-height: 60px;\ncolor: #58a36f;\nfont-size: 18px;\npadding-left: 10px;\">\n      Imooc社区-欢迎来到官方社区\n    </div>\n    <div style=\"padding:25px;\">\n      <div>您好，${sendInfo.user}童靴，重置链接有效时间30分钟，请在${sendInfo.expire}之前重置您的密码:</div>\n      <a href=\"${url}\" style=\" padding: 10px 20px;color: #fff;background: #009e94;display:inline-block;margin:15px 0;\">重置密码</a>\n  <div style=\"padding:5px;background:#f2f2f2;\">如果该邮件不是由你本人操作，请勿进行激活！否则你的邮箱将会被他人绑定</div>\n    </div>\n    <div style=\"background: #fafafa;\ncolor: #b4b4b4;\ntext-align: center;\nline-height: 45px;\nheight: 45px;\nposition: absolute;\nleft: 0;\nbottom: 0;\nwidth: 100%;\n      \">系统邮件，请勿直接回复</div>` // html body\n  });\n\n  return `Message sent: %s, ${info.messageId}`;\n  // Message sent: <b658f8ca-6296-ccf4-8306-87d57a0b4321@example.com>\n\n  // Preview only available when sending through an Ethereal account\n  // console.log(\"Preview URL: %s\", nodemailer.getTestMessageUrl(info));\n  // Preview URL: https://ethereal.email/message/WaQKMgKddxQDoou...\n}\n\n// main().catch(console.error);\nvar _default = send;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzZW5kIiwic2VuZEluZm8iLCJ0cmFuc3BvcnRlciIsIm5vZGVtYWlsZXIiLCJjcmVhdGVUcmFuc3BvcnQiLCJob3N0IiwicG9ydCIsInNlY3VyZSIsImF1dGgiLCJ1c2VyIiwicGFzcyIsInVybCIsImluZm8iLCJzZW5kTWFpbCIsImZyb20iLCJ0byIsImVtYWlsIiwic3ViamVjdCIsInRleHQiLCJjb2RlIiwiZXhwaXJlIiwiaHRtbCIsIm1lc3NhZ2VJZCJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2x1Y2t5L0Rlc2t0b3AvZnJvbnQvZGFxaWFuZHVhbi9hcGkvc3JjL2NvbmZpZy8iLCJzb3VyY2VzIjpbIk1haWxDb25maWcuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG5vZGVtYWlsZXIgZnJvbSBcIm5vZGVtYWlsZXJcIjtcblxuLy8gYXN5bmMuLmF3YWl0IGlzIG5vdCBhbGxvd2VkIGluIGdsb2JhbCBzY29wZSwgbXVzdCB1c2UgYSB3cmFwcGVyXG5hc3luYyBmdW5jdGlvbiBzZW5kKHNlbmRJbmZvKSB7XG4gIC8vIEdlbmVyYXRlIHRlc3QgU01UUCBzZXJ2aWNlIGFjY291bnQgZnJvbSBldGhlcmVhbC5lbWFpbFxuICAvLyBPbmx5IG5lZWRlZCBpZiB5b3UgZG9uJ3QgaGF2ZSBhIHJlYWwgbWFpbCBhY2NvdW50IGZvciB0ZXN0aW5nXG4gIC8vIGxldCB0ZXN0QWNjb3VudCA9IGF3YWl0IG5vZGVtYWlsZXIuY3JlYXRlVGVzdEFjY291bnQoKTtcblxuICAvLyBjcmVhdGUgcmV1c2FibGUgdHJhbnNwb3J0ZXIgb2JqZWN0IHVzaW5nIHRoZSBkZWZhdWx0IFNNVFAgdHJhbnNwb3J0XG4gIGxldCB0cmFuc3BvcnRlciA9IG5vZGVtYWlsZXIuY3JlYXRlVHJhbnNwb3J0KHtcbiAgICBob3N0OiBcInNtdHAucXEuY29tXCIsXG4gICAgcG9ydDogNTg3LFxuICAgIHNlY3VyZTogZmFsc2UsIC8vIHRydWUgZm9yIDQ2NSwgZmFsc2UgZm9yIG90aGVyIHBvcnRzXG4gICAgYXV0aDoge1xuICAgICAgdXNlcjogXCI2MjQ5NzMwMzNAcXEuY29tXCIsIC8vIGdlbmVyYXRlZCBldGhlcmVhbCB1c2VyXG4gICAgICBwYXNzOiBcImVqanB1aHh6bGJxcGJmamdcIiwgLy8gZ2VuZXJhdGVkIGV0aGVyZWFsIHBhc3N3b3JkXG4gICAgfSxcbiAgfSk7XG5cbiAgLy8gc2VuZCBtYWlsIHdpdGggZGVmaW5lZCB0cmFuc3BvcnQgb2JqZWN0XG4gIC8vIGxldCBzZW5kSW5mbyA9IHtcbiAgLy8gY29kZTogXCIxMjM0XCIsXG4gIC8vIGV4cGlyZTogXCIyMDIyLTExLTE1XCIsXG4gIC8vIGVtYWlsOiBcIjYyNDk3MzAzM0BxcS5jb21cIixcbiAgLy8gdXNlcjogXCJsdWRhb2h1YVwiLFxuICAvLyB9O1xuICBsZXQgdXJsID0gXCJodHRwOi8vd3d3Lmltb29jLmNvbVwiO1xuICBsZXQgaW5mbyA9IGF3YWl0IHRyYW5zcG9ydGVyLnNlbmRNYWlsKHtcbiAgICBmcm9tOiAnXCLorqTor4Hpgq7ku7ZcIiA8NjI0OTczMDMzQHFxLmNvbT4nLCAvLyBzZW5kZXIgYWRkcmVzc1xuICAgIHRvOiBzZW5kSW5mby5lbWFpbCwgLy8gbGlzdCBvZiByZWNlaXZlcnNcbiAgICBzdWJqZWN0OlxuICAgICAgc2VuZEluZm8udXNlciAhPT0gXCJcIlxuICAgICAgICA/IGDkvaDlpb3lvIDlj5HogIUsJHtzZW5kSW5mby51c2VyfSE85oWV6K++572R5YmN56uv5YWo5qCI5a6e5oiYPuazqOWGjOeggWBcbiAgICAgICAgOiBcIuOAiuaFleivvue9keWJjeerr+WFqOagiOWunuaImOOAi+azqOWGjOeggVwiLCAvLyBTdWJqZWN0IGxpbmVcbiAgICB0ZXh0OiBg5oKo5Zyo44CK5oWV6K++572R5YmN56uv5YWo5qCI5a6e5oiY44CL6K++56iL5Lit5rOo5YaM77yM5oKo55qE6YKA6K+356CB5pivJHtzZW5kSW5mby5jb2RlfSzpgoDor7fnoIHnmoTov4fmnJ/ml7bpl7Q6JHtzZW5kSW5mby5leHBpcmV9YCwgLy8gcGxhaW4gdGV4dCBib2R5XG4gICAgaHRtbDogYCAgPGRpdiBzdHlsZT1cImNvbG9yOiM2NzY3Njc7d2lkdGg6NjAwcHg7bWFyZ2luOjAgYXV0bztwYWRkaW5nLWJvdHRvbTogNTBweDtwb3NpdGlvbjpyZWxhdGl2ZTtcIj5cbiAgICA8ZGl2IHN0eWxlPVwiaGVpZ2h0OiA2MHB4O1xuYmFja2dyb3VuZDogIzM5M2Q0OTtcbmxpbmUtaGVpZ2h0OiA2MHB4O1xuY29sb3I6ICM1OGEzNmY7XG5mb250LXNpemU6IDE4cHg7XG5wYWRkaW5nLWxlZnQ6IDEwcHg7XCI+XG4gICAgICBJbW9vY+ekvuWMui3mrKLov47mnaXliLDlrpjmlrnnpL7ljLpcbiAgICA8L2Rpdj5cbiAgICA8ZGl2IHN0eWxlPVwicGFkZGluZzoyNXB4O1wiPlxuICAgICAgPGRpdj7mgqjlpb3vvIwke3NlbmRJbmZvLnVzZXJ956ul6Z2077yM6YeN572u6ZO+5o6l5pyJ5pWI5pe26Ze0MzDliIbpkp/vvIzor7flnKgke3NlbmRJbmZvLmV4cGlyZX3kuYvliY3ph43nva7mgqjnmoTlr4bnoIE6PC9kaXY+XG4gICAgICA8YSBocmVmPVwiJHt1cmx9XCIgc3R5bGU9XCIgcGFkZGluZzogMTBweCAyMHB4O2NvbG9yOiAjZmZmO2JhY2tncm91bmQ6ICMwMDllOTQ7ZGlzcGxheTppbmxpbmUtYmxvY2s7bWFyZ2luOjE1cHggMDtcIj7ph43nva7lr4bnoIE8L2E+XG4gIDxkaXYgc3R5bGU9XCJwYWRkaW5nOjVweDtiYWNrZ3JvdW5kOiNmMmYyZjI7XCI+5aaC5p6c6K+l6YKu5Lu25LiN5piv55Sx5L2g5pys5Lq65pON5L2c77yM6K+35Yu/6L+b6KGM5r+A5rS777yB5ZCm5YiZ5L2g55qE6YKu566x5bCG5Lya6KKr5LuW5Lq657uR5a6aPC9kaXY+XG4gICAgPC9kaXY+XG4gICAgPGRpdiBzdHlsZT1cImJhY2tncm91bmQ6ICNmYWZhZmE7XG5jb2xvcjogI2I0YjRiNDtcbnRleHQtYWxpZ246IGNlbnRlcjtcbmxpbmUtaGVpZ2h0OiA0NXB4O1xuaGVpZ2h0OiA0NXB4O1xucG9zaXRpb246IGFic29sdXRlO1xubGVmdDogMDtcbmJvdHRvbTogMDtcbndpZHRoOiAxMDAlO1xuICAgICAgXCI+57O757uf6YKu5Lu277yM6K+35Yu/55u05o6l5Zue5aSNPC9kaXY+YCwgLy8gaHRtbCBib2R5XG4gIH0pO1xuXG4gIHJldHVybiBgTWVzc2FnZSBzZW50OiAlcywgJHtpbmZvLm1lc3NhZ2VJZH1gO1xuICAvLyBNZXNzYWdlIHNlbnQ6IDxiNjU4ZjhjYS02Mjk2LWNjZjQtODMwNi04N2Q1N2EwYjQzMjFAZXhhbXBsZS5jb20+XG5cbiAgLy8gUHJldmlldyBvbmx5IGF2YWlsYWJsZSB3aGVuIHNlbmRpbmcgdGhyb3VnaCBhbiBFdGhlcmVhbCBhY2NvdW50XG4gIC8vIGNvbnNvbGUubG9nKFwiUHJldmlldyBVUkw6ICVzXCIsIG5vZGVtYWlsZXIuZ2V0VGVzdE1lc3NhZ2VVcmwoaW5mbykpO1xuICAvLyBQcmV2aWV3IFVSTDogaHR0cHM6Ly9ldGhlcmVhbC5lbWFpbC9tZXNzYWdlL1dhUUtNZ0tkZHhRRG9vdS4uLlxufVxuXG4vLyBtYWluKCkuY2F0Y2goY29uc29sZS5lcnJvcik7XG5leHBvcnQgZGVmYXVsdCBzZW5kO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUFvQztBQUVwQztBQUNBLGVBQWVBLElBQUksQ0FBQ0MsUUFBUSxFQUFFO0VBQzVCO0VBQ0E7RUFDQTs7RUFFQTtFQUNBLElBQUlDLFdBQVcsR0FBR0MsbUJBQVUsQ0FBQ0MsZUFBZSxDQUFDO0lBQzNDQyxJQUFJLEVBQUUsYUFBYTtJQUNuQkMsSUFBSSxFQUFFLEdBQUc7SUFDVEMsTUFBTSxFQUFFLEtBQUs7SUFBRTtJQUNmQyxJQUFJLEVBQUU7TUFDSkMsSUFBSSxFQUFFLGtCQUFrQjtNQUFFO01BQzFCQyxJQUFJLEVBQUUsa0JBQWtCLENBQUU7SUFDNUI7RUFDRixDQUFDLENBQUM7O0VBRUY7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQSxJQUFJQyxHQUFHLEdBQUcsc0JBQXNCO0VBQ2hDLElBQUlDLElBQUksR0FBRyxNQUFNVixXQUFXLENBQUNXLFFBQVEsQ0FBQztJQUNwQ0MsSUFBSSxFQUFFLDJCQUEyQjtJQUFFO0lBQ25DQyxFQUFFLEVBQUVkLFFBQVEsQ0FBQ2UsS0FBSztJQUFFO0lBQ3BCQyxPQUFPLEVBQ0xoQixRQUFRLENBQUNRLElBQUksS0FBSyxFQUFFLEdBQ2YsU0FBUVIsUUFBUSxDQUFDUSxJQUFLLGlCQUFnQixHQUN2QyxnQkFBZ0I7SUFBRTtJQUN4QlMsSUFBSSxFQUFHLDRCQUEyQmpCLFFBQVEsQ0FBQ2tCLElBQUssYUFBWWxCLFFBQVEsQ0FBQ21CLE1BQU8sRUFBQztJQUFFO0lBQy9FQyxJQUFJLEVBQUc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0JwQixRQUFRLENBQUNRLElBQUsscUJBQW9CUixRQUFRLENBQUNtQixNQUFPO0FBQ2xFLGlCQUFpQlQsR0FBSTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLENBQUU7RUFDMUIsQ0FBQyxDQUFDOztFQUVGLE9BQVEscUJBQW9CQyxJQUFJLENBQUNVLFNBQVUsRUFBQztFQUM1Qzs7RUFFQTtFQUNBO0VBQ0E7QUFDRjs7QUFFQTtBQUFBLGVBQ2V0QixJQUFJO0FBQUEifQ==","map":{"version":3,"names":["send","sendInfo","transporter","nodemailer","createTransport","host","port","secure","auth","user","pass","url","info","sendMail","from","to","email","subject","text","code","expire","html","messageId"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/config/","sources":["MailConfig.js"],"sourcesContent":["import nodemailer from \"nodemailer\";\n\n// async..await is not allowed in global scope, must use a wrapper\nasync function send(sendInfo) {\n  // Generate test SMTP service account from ethereal.email\n  // Only needed if you don't have a real mail account for testing\n  // let testAccount = await nodemailer.createTestAccount();\n\n  // create reusable transporter object using the default SMTP transport\n  let transporter = nodemailer.createTransport({\n    host: \"smtp.qq.com\",\n    port: 587,\n    secure: false, // true for 465, false for other ports\n    auth: {\n      user: \"624973033@qq.com\", // generated ethereal user\n      pass: \"ejjpuhxzlbqpbfjg\", // generated ethereal password\n    },\n  });\n\n  // send mail with defined transport object\n  // let sendInfo = {\n  // code: \"1234\",\n  // expire: \"2022-11-15\",\n  // email: \"624973033@qq.com\",\n  // user: \"ludaohua\",\n  // };\n  let url = \"http://www.imooc.com\";\n  let info = await transporter.sendMail({\n    from: '\"认证邮件\" <624973033@qq.com>', // sender address\n    to: sendInfo.email, // list of receivers\n    subject:\n      sendInfo.user !== \"\"\n        ? `你好开发者,${sendInfo.user}!<慕课网前端全栈实战>注册码`\n        : \"《慕课网前端全栈实战》注册码\", // Subject line\n    text: `您在《慕课网前端全栈实战》课程中注册，您的邀请码是${sendInfo.code},邀请码的过期时间:${sendInfo.expire}`, // plain text body\n    html: `  <div style=\"color:#676767;width:600px;margin:0 auto;padding-bottom: 50px;position:relative;\">\n    <div style=\"height: 60px;\nbackground: #393d49;\nline-height: 60px;\ncolor: #58a36f;\nfont-size: 18px;\npadding-left: 10px;\">\n      Imooc社区-欢迎来到官方社区\n    </div>\n    <div style=\"padding:25px;\">\n      <div>您好，${sendInfo.user}童靴，重置链接有效时间30分钟，请在${sendInfo.expire}之前重置您的密码:</div>\n      <a href=\"${url}\" style=\" padding: 10px 20px;color: #fff;background: #009e94;display:inline-block;margin:15px 0;\">重置密码</a>\n  <div style=\"padding:5px;background:#f2f2f2;\">如果该邮件不是由你本人操作，请勿进行激活！否则你的邮箱将会被他人绑定</div>\n    </div>\n    <div style=\"background: #fafafa;\ncolor: #b4b4b4;\ntext-align: center;\nline-height: 45px;\nheight: 45px;\nposition: absolute;\nleft: 0;\nbottom: 0;\nwidth: 100%;\n      \">系统邮件，请勿直接回复</div>`, // html body\n  });\n\n  return `Message sent: %s, ${info.messageId}`;\n  // Message sent: <b658f8ca-6296-ccf4-8306-87d57a0b4321@example.com>\n\n  // Preview only available when sending through an Ethereal account\n  // console.log(\"Preview URL: %s\", nodemailer.getTestMessageUrl(info));\n  // Preview URL: https://ethereal.email/message/WaQKMgKddxQDoou...\n}\n\n// main().catch(console.error);\nexport default send;\n"],"mappings":";;;;;;AAAA;AAAoC;AAEpC;AACA,eAAeA,IAAI,CAACC,QAAQ,EAAE;EAC5B;EACA;EACA;;EAEA;EACA,IAAIC,WAAW,GAAGC,mBAAU,CAACC,eAAe,CAAC;IAC3CC,IAAI,EAAE,aAAa;IACnBC,IAAI,EAAE,GAAG;IACTC,MAAM,EAAE,KAAK;IAAE;IACfC,IAAI,EAAE;MACJC,IAAI,EAAE,kBAAkB;MAAE;MAC1BC,IAAI,EAAE,kBAAkB,CAAE;IAC5B;EACF,CAAC,CAAC;;EAEF;EACA;EACA;EACA;EACA;EACA;EACA;EACA,IAAIC,GAAG,GAAG,sBAAsB;EAChC,IAAIC,IAAI,GAAG,MAAMV,WAAW,CAACW,QAAQ,CAAC;IACpCC,IAAI,EAAE,2BAA2B;IAAE;IACnCC,EAAE,EAAEd,QAAQ,CAACe,KAAK;IAAE;IACpBC,OAAO,EACLhB,QAAQ,CAACQ,IAAI,KAAK,EAAE,GACf,SAAQR,QAAQ,CAACQ,IAAK,iBAAgB,GACvC,gBAAgB;IAAE;IACxBS,IAAI,EAAG,4BAA2BjB,QAAQ,CAACkB,IAAK,aAAYlB,QAAQ,CAACmB,MAAO,EAAC;IAAE;IAC/EC,IAAI,EAAG;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgBpB,QAAQ,CAACQ,IAAK,qBAAoBR,QAAQ,CAACmB,MAAO;AAClE,iBAAiBT,GAAI;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,CAAE;EAC1B,CAAC,CAAC;;EAEF,OAAQ,qBAAoBC,IAAI,CAACU,SAAU,EAAC;EAC5C;;EAEA;EACA;EACA;AACF;;AAEA;AAAA,eACetB,IAAI;AAAA"}},"mtime":1668425457049},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/common/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/common/Utils.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.checkCode = void 0;\nvar _RedisConfig = require(\"../config/RedisConfig\");\nconst checkCode = async (key, value) => {\n  const redisData = await (0, _RedisConfig.getValue)(key);\n  if (redisData !== null) {\n    if (redisData.toLowerCase() === value.toLowerCase()) {\n      return true;\n    } else {\n      return false;\n    }\n  } else {\n    return false;\n  }\n};\nexports.checkCode = checkCode;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjaGVja0NvZGUiLCJrZXkiLCJ2YWx1ZSIsInJlZGlzRGF0YSIsImdldFZhbHVlIiwidG9Mb3dlckNhc2UiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9sdWNreS9EZXNrdG9wL2Zyb250L2RhcWlhbmR1YW4vYXBpL3NyYy9jb21tb24vIiwic291cmNlcyI6WyJVdGlscy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRWYWx1ZSB9IGZyb20gXCIuLi9jb25maWcvUmVkaXNDb25maWdcIjtcbmNvbnN0IGNoZWNrQ29kZSA9IGFzeW5jIChrZXksIHZhbHVlKSA9PiB7XG4gIGNvbnN0IHJlZGlzRGF0YSA9IGF3YWl0IGdldFZhbHVlKGtleSk7XG4gIGlmIChyZWRpc0RhdGEgIT09IG51bGwpIHtcbiAgICBpZiAocmVkaXNEYXRhLnRvTG93ZXJDYXNlKCkgPT09IHZhbHVlLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufTtcbmV4cG9ydCB7IGNoZWNrQ29kZSB9O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBLE1BQU1BLFNBQVMsR0FBRyxPQUFPQyxHQUFHLEVBQUVDLEtBQUssS0FBSztFQUN0QyxNQUFNQyxTQUFTLEdBQUcsTUFBTSxJQUFBQyxxQkFBUSxFQUFDSCxHQUFHLENBQUM7RUFDckMsSUFBSUUsU0FBUyxLQUFLLElBQUksRUFBRTtJQUN0QixJQUFJQSxTQUFTLENBQUNFLFdBQVcsRUFBRSxLQUFLSCxLQUFLLENBQUNHLFdBQVcsRUFBRSxFQUFFO01BQ25ELE9BQU8sSUFBSTtJQUNiLENBQUMsTUFBTTtNQUNMLE9BQU8sS0FBSztJQUNkO0VBQ0YsQ0FBQyxNQUFNO0lBQ0wsT0FBTyxLQUFLO0VBQ2Q7QUFDRixDQUFDO0FBQUMifQ==","map":{"version":3,"names":["checkCode","key","value","redisData","getValue","toLowerCase"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/common/","sources":["Utils.js"],"sourcesContent":["import { getValue } from \"../config/RedisConfig\";\nconst checkCode = async (key, value) => {\n  const redisData = await getValue(key);\n  if (redisData !== null) {\n    if (redisData.toLowerCase() === value.toLowerCase()) {\n      return true;\n    } else {\n      return false;\n    }\n  } else {\n    return false;\n  }\n};\nexport { checkCode };\n"],"mappings":";;;;;;AAAA;AACA,MAAMA,SAAS,GAAG,OAAOC,GAAG,EAAEC,KAAK,KAAK;EACtC,MAAMC,SAAS,GAAG,MAAM,IAAAC,qBAAQ,EAACH,GAAG,CAAC;EACrC,IAAIE,SAAS,KAAK,IAAI,EAAE;IACtB,IAAIA,SAAS,CAACE,WAAW,EAAE,KAAKH,KAAK,CAACG,WAAW,EAAE,EAAE;MACnD,OAAO,IAAI;IACb,CAAC,MAAM;MACL,OAAO,KAAK;IACd;EACF,CAAC,MAAM;IACL,OAAO,KAAK;EACd;AACF,CAAC;AAAC"}},"mtime":1669975036575},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/model/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/model/User.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = require(\"mongoose\");\nvar _DBHelpler = _interopRequireDefault(require(\"../config/DBHelpler\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nconst Schema = _DBHelpler.default.Schema;\nconst UserSchema = new Schema({\n  username: {\n    type: String\n  },\n  name: {\n    type: String\n  },\n  password: {\n    type: String\n  }\n});\nconst UserModel = _DBHelpler.default.model(\"users\", UserSchema);\nvar _default = UserModel;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTY2hlbWEiLCJtb25nb29zZSIsIlVzZXJTY2hlbWEiLCJ1c2VybmFtZSIsInR5cGUiLCJTdHJpbmciLCJuYW1lIiwicGFzc3dvcmQiLCJVc2VyTW9kZWwiLCJtb2RlbCJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2x1Y2t5L0Rlc2t0b3AvZnJvbnQvZGFxaWFuZHVhbi9hcGkvc3JjL21vZGVsLyIsInNvdXJjZXMiOlsiVXNlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBtb25nbyB9IGZyb20gXCJtb25nb29zZVwiO1xuaW1wb3J0IG1vbmdvb3NlIGZyb20gXCIuLi9jb25maWcvREJIZWxwbGVyXCI7XG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XG5jb25zdCBVc2VyU2NoZW1hID0gbmV3IFNjaGVtYSh7XG4gIHVzZXJuYW1lOiB7IHR5cGU6IFN0cmluZyB9LFxuICBuYW1lOiB7IHR5cGU6IFN0cmluZyB9LFxuICBwYXNzd29yZDogeyB0eXBlOiBTdHJpbmcgfSxcbn0pO1xuY29uc3QgVXNlck1vZGVsID0gbW9uZ29vc2UubW9kZWwoXCJ1c2Vyc1wiLCBVc2VyU2NoZW1hKTtcbmV4cG9ydCBkZWZhdWx0IFVzZXJNb2RlbDtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUEyQztBQUMzQyxNQUFNQSxNQUFNLEdBQUdDLGtCQUFRLENBQUNELE1BQU07QUFDOUIsTUFBTUUsVUFBVSxHQUFHLElBQUlGLE1BQU0sQ0FBQztFQUM1QkcsUUFBUSxFQUFFO0lBQUVDLElBQUksRUFBRUM7RUFBTyxDQUFDO0VBQzFCQyxJQUFJLEVBQUU7SUFBRUYsSUFBSSxFQUFFQztFQUFPLENBQUM7RUFDdEJFLFFBQVEsRUFBRTtJQUFFSCxJQUFJLEVBQUVDO0VBQU87QUFDM0IsQ0FBQyxDQUFDO0FBQ0YsTUFBTUcsU0FBUyxHQUFHUCxrQkFBUSxDQUFDUSxLQUFLLENBQUMsT0FBTyxFQUFFUCxVQUFVLENBQUM7QUFBQyxlQUN2Q00sU0FBUztBQUFBIn0=","map":{"version":3,"names":["Schema","mongoose","UserSchema","username","type","String","name","password","UserModel","model"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/model/","sources":["User.js"],"sourcesContent":["import { mongo } from \"mongoose\";\nimport mongoose from \"../config/DBHelpler\";\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema({\n  username: { type: String },\n  name: { type: String },\n  password: { type: String },\n});\nconst UserModel = mongoose.model(\"users\", UserSchema);\nexport default UserModel;\n"],"mappings":";;;;;;AAAA;AACA;AAA2C;AAC3C,MAAMA,MAAM,GAAGC,kBAAQ,CAACD,MAAM;AAC9B,MAAME,UAAU,GAAG,IAAIF,MAAM,CAAC;EAC5BG,QAAQ,EAAE;IAAEC,IAAI,EAAEC;EAAO,CAAC;EAC1BC,IAAI,EAAE;IAAEF,IAAI,EAAEC;EAAO,CAAC;EACtBE,QAAQ,EAAE;IAAEH,IAAI,EAAEC;EAAO;AAC3B,CAAC,CAAC;AACF,MAAMG,SAAS,GAAGP,kBAAQ,CAACQ,KAAK,CAAC,OAAO,EAAEP,UAAU,CAAC;AAAC,eACvCM,SAAS;AAAA"}},"mtime":1670120543685},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/config/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/config/DBHelpler.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _index = _interopRequireDefault(require(\"./index\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n// 创建链接\n_mongoose.default.connect(_index.default.DB_URL, {\n  useNewUrlParser: true,\n  useUnifiedTopology: true\n});\n// 链接成功\n_mongoose.default.connection.on(\"connected\", () => {\n  console.log(\"mongoose connection open to \" + _index.default.DB_URL);\n});\n\n// 链接异常\n_mongoose.default.connection.on(\"error\", error => {\n  console.log(\"mongoose connection error \" + error);\n});\n\n// 断开链接\n_mongoose.default.connection.on(\"disconnected\", () => {\n  console.log(\"mongoose connection disconnected\");\n});\nvar _default = _mongoose.default;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsImNvbm5lY3QiLCJjb25maWciLCJEQl9VUkwiLCJ1c2VOZXdVcmxQYXJzZXIiLCJ1c2VVbmlmaWVkVG9wb2xvZ3kiLCJjb25uZWN0aW9uIiwib24iLCJjb25zb2xlIiwibG9nIiwiZXJyb3IiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9sdWNreS9EZXNrdG9wL2Zyb250L2RhcWlhbmR1YW4vYXBpL3NyYy9jb25maWcvIiwic291cmNlcyI6WyJEQkhlbHBsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xuaW1wb3J0IGNvbmZpZyBmcm9tIFwiLi9pbmRleFwiO1xuXG4vLyDliJvlu7rpk77mjqVcbm1vbmdvb3NlLmNvbm5lY3QoY29uZmlnLkRCX1VSTCwge1xuICB1c2VOZXdVcmxQYXJzZXI6IHRydWUsXG4gIHVzZVVuaWZpZWRUb3BvbG9neTogdHJ1ZSxcbn0pO1xuLy8g6ZO+5o6l5oiQ5YqfXG5tb25nb29zZS5jb25uZWN0aW9uLm9uKFwiY29ubmVjdGVkXCIsICgpID0+IHtcbiAgY29uc29sZS5sb2coXCJtb25nb29zZSBjb25uZWN0aW9uIG9wZW4gdG8gXCIgKyBjb25maWcuREJfVVJMKTtcbn0pO1xuXG4vLyDpk77mjqXlvILluLhcbm1vbmdvb3NlLmNvbm5lY3Rpb24ub24oXCJlcnJvclwiLCAoZXJyb3IpID0+IHtcbiAgY29uc29sZS5sb2coXCJtb25nb29zZSBjb25uZWN0aW9uIGVycm9yIFwiICsgZXJyb3IpO1xufSk7XG5cbi8vIOaWreW8gOmTvuaOpVxubW9uZ29vc2UuY29ubmVjdGlvbi5vbihcImRpc2Nvbm5lY3RlZFwiLCAoKSA9PiB7XG4gIGNvbnNvbGUubG9nKFwibW9uZ29vc2UgY29ubmVjdGlvbiBkaXNjb25uZWN0ZWRcIik7XG59KTtcblxuZXhwb3J0IGRlZmF1bHQgbW9uZ29vc2U7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFBNkI7QUFFN0I7QUFDQUEsaUJBQVEsQ0FBQ0MsT0FBTyxDQUFDQyxjQUFNLENBQUNDLE1BQU0sRUFBRTtFQUM5QkMsZUFBZSxFQUFFLElBQUk7RUFDckJDLGtCQUFrQixFQUFFO0FBQ3RCLENBQUMsQ0FBQztBQUNGO0FBQ0FMLGlCQUFRLENBQUNNLFVBQVUsQ0FBQ0MsRUFBRSxDQUFDLFdBQVcsRUFBRSxNQUFNO0VBQ3hDQyxPQUFPLENBQUNDLEdBQUcsQ0FBQyw4QkFBOEIsR0FBR1AsY0FBTSxDQUFDQyxNQUFNLENBQUM7QUFDN0QsQ0FBQyxDQUFDOztBQUVGO0FBQ0FILGlCQUFRLENBQUNNLFVBQVUsQ0FBQ0MsRUFBRSxDQUFDLE9BQU8sRUFBR0csS0FBSyxJQUFLO0VBQ3pDRixPQUFPLENBQUNDLEdBQUcsQ0FBQyw0QkFBNEIsR0FBR0MsS0FBSyxDQUFDO0FBQ25ELENBQUMsQ0FBQzs7QUFFRjtBQUNBVixpQkFBUSxDQUFDTSxVQUFVLENBQUNDLEVBQUUsQ0FBQyxjQUFjLEVBQUUsTUFBTTtFQUMzQ0MsT0FBTyxDQUFDQyxHQUFHLENBQUMsa0NBQWtDLENBQUM7QUFDakQsQ0FBQyxDQUFDO0FBQUMsZUFFWVQsaUJBQVE7QUFBQSJ9","map":{"version":3,"names":["mongoose","connect","config","DB_URL","useNewUrlParser","useUnifiedTopology","connection","on","console","log","error"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/config/","sources":["DBHelpler.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport config from \"./index\";\n\n// 创建链接\nmongoose.connect(config.DB_URL, {\n  useNewUrlParser: true,\n  useUnifiedTopology: true,\n});\n// 链接成功\nmongoose.connection.on(\"connected\", () => {\n  console.log(\"mongoose connection open to \" + config.DB_URL);\n});\n\n// 链接异常\nmongoose.connection.on(\"error\", (error) => {\n  console.log(\"mongoose connection error \" + error);\n});\n\n// 断开链接\nmongoose.connection.on(\"disconnected\", () => {\n  console.log(\"mongoose connection disconnected\");\n});\n\nexport default mongoose;\n"],"mappings":";;;;;;AAAA;AACA;AAA6B;AAE7B;AACAA,iBAAQ,CAACC,OAAO,CAACC,cAAM,CAACC,MAAM,EAAE;EAC9BC,eAAe,EAAE,IAAI;EACrBC,kBAAkB,EAAE;AACtB,CAAC,CAAC;AACF;AACAL,iBAAQ,CAACM,UAAU,CAACC,EAAE,CAAC,WAAW,EAAE,MAAM;EACxCC,OAAO,CAACC,GAAG,CAAC,8BAA8B,GAAGP,cAAM,CAACC,MAAM,CAAC;AAC7D,CAAC,CAAC;;AAEF;AACAH,iBAAQ,CAACM,UAAU,CAACC,EAAE,CAAC,OAAO,EAAGG,KAAK,IAAK;EACzCF,OAAO,CAACC,GAAG,CAAC,4BAA4B,GAAGC,KAAK,CAAC;AACnD,CAAC,CAAC;;AAEF;AACAV,iBAAQ,CAACM,UAAU,CAACC,EAAE,CAAC,cAAc,EAAE,MAAM;EAC3CC,OAAO,CAACC,GAAG,CAAC,kCAAkC,CAAC;AACjD,CAAC,CAAC;AAAC,eAEYT,iBAAQ;AAAA"}},"mtime":1669533968434},"{\"sourceRoot\":\"/Users/lucky/Desktop/front/daqianduan/api/src/common/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"filename\":\"/Users/lucky/Desktop/front/daqianduan/api/src/common/ErrorHandle.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"dev\",\"root\":\"/Users/lucky/Desktop/front/daqianduan/api\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"loose\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.5.5:dev":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _default = (ctx, next) => {\n  return next().catch(err => {\n    if (err.status === 401) {\n      ctx.status = 401;\n      ctx.body = {\n        code: 401,\n        msg: \"Protect resource, use Authorization header to get access\\n\"\n      };\n    } else {\n      ctx.status = err.status || 500;\n      ctx.body = {\n        code: 500,\n        msg: process.env.NODE_ENV === \"development\" || \"dev\" ? {\n          stack: err.stack\n        } : err.message\n      };\n    }\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjdHgiLCJuZXh0IiwiY2F0Y2giLCJlcnIiLCJzdGF0dXMiLCJib2R5IiwiY29kZSIsIm1zZyIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsInN0YWNrIiwibWVzc2FnZSJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2x1Y2t5L0Rlc2t0b3AvZnJvbnQvZGFxaWFuZHVhbi9hcGkvc3JjL2NvbW1vbi8iLCJzb3VyY2VzIjpbIkVycm9ySGFuZGxlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IChjdHgsIG5leHQpID0+IHtcbiAgcmV0dXJuIG5leHQoKS5jYXRjaCgoZXJyKSA9PiB7XG4gICAgaWYgKGVyci5zdGF0dXMgPT09IDQwMSkge1xuICAgICAgY3R4LnN0YXR1cyA9IDQwMTtcbiAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICBjb2RlOiA0MDEsXG4gICAgICAgIG1zZzogXCJQcm90ZWN0IHJlc291cmNlLCB1c2UgQXV0aG9yaXphdGlvbiBoZWFkZXIgdG8gZ2V0IGFjY2Vzc1xcblwiLFxuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgY3R4LnN0YXR1cyA9IGVyci5zdGF0dXMgfHwgNTAwO1xuICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgIGNvZGU6IDUwMCxcbiAgICAgICAgbXNnOlxuICAgICAgICAgIHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcImRldmVsb3BtZW50XCIgfHwgXCJkZXZcIlxuICAgICAgICAgICAgPyB7IHN0YWNrOiBlcnIuc3RhY2sgfVxuICAgICAgICAgICAgOiBlcnIubWVzc2FnZSxcbiAgICAgIH07XG4gICAgfVxuICB9KTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztlQUFlLENBQUNBLEdBQUcsRUFBRUMsSUFBSSxLQUFLO0VBQzVCLE9BQU9BLElBQUksRUFBRSxDQUFDQyxLQUFLLENBQUVDLEdBQUcsSUFBSztJQUMzQixJQUFJQSxHQUFHLENBQUNDLE1BQU0sS0FBSyxHQUFHLEVBQUU7TUFDdEJKLEdBQUcsQ0FBQ0ksTUFBTSxHQUFHLEdBQUc7TUFDaEJKLEdBQUcsQ0FBQ0ssSUFBSSxHQUFHO1FBQ1RDLElBQUksRUFBRSxHQUFHO1FBQ1RDLEdBQUcsRUFBRTtNQUNQLENBQUM7SUFDSCxDQUFDLE1BQU07TUFDTFAsR0FBRyxDQUFDSSxNQUFNLEdBQUdELEdBQUcsQ0FBQ0MsTUFBTSxJQUFJLEdBQUc7TUFDOUJKLEdBQUcsQ0FBQ0ssSUFBSSxHQUFHO1FBQ1RDLElBQUksRUFBRSxHQUFHO1FBQ1RDLEdBQUcsRUFDREMsT0FBTyxDQUFDQyxHQUFHLENBQUNDLFFBQVEsS0FBSyxhQUFhLElBQUksS0FBSyxHQUMzQztVQUFFQyxLQUFLLEVBQUVSLEdBQUcsQ0FBQ1E7UUFBTSxDQUFDLEdBQ3BCUixHQUFHLENBQUNTO01BQ1osQ0FBQztJQUNIO0VBQ0YsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUFBIn0=","map":{"version":3,"names":["ctx","next","catch","err","status","body","code","msg","process","env","NODE_ENV","stack","message"],"sourceRoot":"/Users/lucky/Desktop/front/daqianduan/api/src/common/","sources":["ErrorHandle.js"],"sourcesContent":["export default (ctx, next) => {\n  return next().catch((err) => {\n    if (err.status === 401) {\n      ctx.status = 401;\n      ctx.body = {\n        code: 401,\n        msg: \"Protect resource, use Authorization header to get access\\n\",\n      };\n    } else {\n      ctx.status = err.status || 500;\n      ctx.body = {\n        code: 500,\n        msg:\n          process.env.NODE_ENV === \"development\" || \"dev\"\n            ? { stack: err.stack }\n            : err.message,\n      };\n    }\n  });\n};\n"],"mappings":";;;;;;eAAe,CAACA,GAAG,EAAEC,IAAI,KAAK;EAC5B,OAAOA,IAAI,EAAE,CAACC,KAAK,CAAEC,GAAG,IAAK;IAC3B,IAAIA,GAAG,CAACC,MAAM,KAAK,GAAG,EAAE;MACtBJ,GAAG,CAACI,MAAM,GAAG,GAAG;MAChBJ,GAAG,CAACK,IAAI,GAAG;QACTC,IAAI,EAAE,GAAG;QACTC,GAAG,EAAE;MACP,CAAC;IACH,CAAC,MAAM;MACLP,GAAG,CAACI,MAAM,GAAGD,GAAG,CAACC,MAAM,IAAI,GAAG;MAC9BJ,GAAG,CAACK,IAAI,GAAG;QACTC,IAAI,EAAE,GAAG;QACTC,GAAG,EACDC,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,aAAa,IAAI,KAAK,GAC3C;UAAEC,KAAK,EAAER,GAAG,CAACQ;QAAM,CAAC,GACpBR,GAAG,CAACS;MACZ,CAAC;IACH;EACF,CAAC,CAAC;AACJ,CAAC;AAAA"}},"mtime":1669955171043}}